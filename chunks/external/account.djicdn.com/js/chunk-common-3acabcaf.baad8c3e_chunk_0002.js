{
  "metadata": {
    "source_file": "external\\account.djicdn.com\\js\\chunk-common-3acabcaf.baad8c3e.js",
    "chunk_index": 2,
    "total_chunks": 2,
    "chunk_size": 44972,
    "word_count": 480,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.777Z"
  },
  "content": "E={name:\"OAuth-unbind-email\",mixins:[],data:function(){return{moduleName:v.Sn.WECHAT_UNBIND_EMAIL,emailType:b.O.WECHAT_UNBIND,errorCode:\"\",errorMsg:\"\",isLoading:!1,isSendLoading:!1,maskEmail:\"\",maskRegisterPhone:\"\",captchaResult:null,code:\"\",unbindWechatSmsSendText:\"\",USAGE_TAG_VALUE:C.tU,showCaptchaCodeError:!1,showError:!1,codeHasBeenSent:!1,loaded:!0,isLogin:!1,inited:!1,hideWaring:!1,count:0,interval:null,confirmBtnText:this.$t(\"v2_weapp_unbind_submit\")}},computed:k(k({},(0,h.L8)({initData:m.A.common.getter.initData,getConfigCaptcha:m.A.captcha.getter.getConfig,lang:m.A.common.getter.lang,nextData:m.A.common.getter.nextData})),{},{queryEmail:function(){return this.$route.query.email||\"\"},OAuthType:function(){return\"wechat\"},maskInfo:function(){return this.maskEmail||(0,g.l_)(this.queryEmail)||\"\"}}),mounted:function(){},methods:k(k(k({},(0,h.PY)({updateNextData:m.A.common.mutation.updateNextData,setShowCaptcha:m.A.captcha.mutation.setShow})),(0,h.i0)({getParamWithTicket:m.A.captcha.action.getParamWithTicket})),{},{fetchBindingInfo:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=null,r=k({},e.nextData),\"VerifyAccount\"===(null===r||void 0===r?void 0:r.unbindWechat)&&(e.hideWaring=!0,e.updateNextData({nextData:k(k({},r),{},{unbindWechat:null})})),null===r||void 0===r||!r.bindingInfo){t.next=1;break}n=null===r||void 0===r?void 0:r.bindingInfo,t.next=3;break;case 1:return t.next=2,p[\"default\"].common.getBindingInfo({},null,{ignoreUnLogin:!0});case 2:n=t.sent,(n.data.maskRegisterPhone||n.data.maskEmail)&&e.updateNextData({nextData:{bindingInfo:n}});case 3:return t.abrupt(\"return\",n);case 4:case\"end\":return t.stop()}},t)}))()},fetchUserInfo:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(\"zh_CN\"===e.lang){t.next=1;break}return e.failNavigateHandle(e.$t(\"v2_error_code_520\")),t.abrupt(\"return\");case 1:return t.prev=1,t.next=2,e.fetchBindingInfo();case 2:n=t.sent,\"\"===e.queryEmail&&(e.maskEmail=n.data.maskEmail,e.maskRegisterPhone=n.data.maskRegisterPhone),e.isLogin=!0,t.next=4;break;case 3:t.prev=3,r=t[\"catch\"](1),e.isLogin=!1,\"\"===e.queryEmail&&e.failNavigateHandle(r.code?e.$t(\"v2_error_code_\".concat(r.code)):\"\");case 4:return t.prev=4,e.inited=!0,t.finish(4);case 5:case\"end\":return t.stop()}},t,null,[[1,3,4,5]])}))()},handleSend:function(e){var t=this;return(0,i.A)(s().mark(function n(){var r,a,i,o,c;return s().wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.isSendLoading=!0,t.resetErrorCode(),null===(r=t.$ga)||void 0===r||r.event(\"OAuthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" send code to email\")),n.next=1,t.fetchCodeSend();case 1:i=n.sent,0===i.code&&t.startTiming(),t.codeHasBeenSent=!0,null===(a=t.$ga)||void 0===a||a.event(\"OAuthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" send code to email success\")),(0,w.HF)(C.tU.ACCOUNT_UNBIND_THIRD_PARTY_SEND_EMAIL,t.unbindWechatSmsSendText||t.$t(\"v2_btn_sendBtn\")),null!==e&&void 0!==e&&e.success&&e.success(),n.next=3;break;case 2:n.prev=2,c=n[\"catch\"](0),\"\"!==t.code&&(t.loaded=!1),null===(o=t.$ga)||void 0===o||o.event(\"OAuthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" send code to email error \").concat(c.code)),t.errorCodeHandle(c),(0,w.HF)(C.tU.ACCOUNT_UNBIND_THIRD_PARTY_SEND_EMAIL,t.unbindWechatSmsSendText||t.$t(\"v2_btn_sendBtn\"),(null===c||void 0===c?void 0:c.code)||f.Sc),null!==e&&void 0!==e&&e.error&&e.error(c);case 3:return n.prev=3,t.isSendLoading=!1,null!==e&&void 0!==e&&e[\"finally\"]&&e[\"finally\"](),n.finish(3);case 4:case\"end\":return n.stop()}},n,null,[[0,2,3,4]])}))()},handleSubmit:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r,a,i,o;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,e.resetErrorCode(),e.confirmBtnText=e.$t(\"v2_weapp_unbind_submit_ing\"),a={type:\"Wechat\",email:e.queryEmail,code:e.code},null===(n=e.$ga)||void 0===n||n.event(\"oauthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" unbind to email\")),t.next=1,p[\"default\"].wechat.unbindEmail(a);case 1:e.confirmBtnText=e.$t(\"v2_weapp_unbind_submit_ok\"),null===(r=e.$ga)||void 0===r||r.event(\"oauthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" unbind to email success\")),(0,w.HF)(C.tU.ACCOUNT_UNBIND_THIRD_PARTY_SUBMIT_EMAIL,e.confirmBtnText),e.successNavigateHandle(),t.next=3;break;case 2:t.prev=2,o=t[\"catch\"](0),e.isLoading=!1,e.confirmBtnText=e.$t(\"v2_weapp_unbind_submit\"),null===(i=e.$ga)||void 0===i||i.event(\"oauthUnbound btn\",\"Click\",\"\".concat((0,_.R7)(),\" unbind to email error \").concat(o.code)),(0,w.HF)(C.tU.ACCOUNT_UNBIND_THIRD_PARTY_SUBMIT_EMAIL,e.confirmBtnText,(null===o||void 0===o?void 0:o.code)||f.Sc),e.errorCodeHandle(o);case 3:case\"end\":return t.stop()}},t,null,[[0,2]])}))()},successNavigateHandle:function(){var e={title:this.$t(\"v2_tips_unbinding_facebook_success\").replace(\"%@\",this.$t(\"v2_tips_wechat\")),redirectBtnText:this.$t(\"v2_btn_done\"),callbackUrl:(0,_.TP)()};this.updateNextData({nextData:e}),this.$router.push({path:\"/account/success\",query:this.$route.query})},fetchCodeSend:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r,a;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=1,e.getParamWithTicket({moduleName:e.moduleName,param:{email:e.queryEmail,emailType:e.emailType},result:e.captchaResult});case 1:return n=t.sent,r=\"\"!==e.queryEmail?p[\"default\"].common.sendEmail(n):p[\"default\"].webBinding.sendValidateEmail(n),t.next=2,r;case 2:return a=t.sent,t.abrupt(\"return\",a);case 3:case\"end\":return t.stop()}},t)}))()},startTiming:function(){var e=this;this.count=60,this.interval&&window.clearInterval(this.interval),this.interval=window.setInterval(function(){e.count--,e.count<=0&&(window.clearInterval(e.interval),e.interval=null)},1e3)},resetErrorCode:function(){this.errorCode=\"\",this.errorMsg=\"\"},resetCaptcha:function(){var e;null===(e=this.$refs.VerifyAccount)||void 0===e||e.resetCaptcha()},handleGoToPhoneBinding:function(){var e,t,n={unbindWechat:\"VerifyAccount\"};null!==(e=this.nextData)&&void 0!==e&&e.bindingInfo&&(n.bindingInfo=null===(t=this.nextData)||void 0===t?void 0:t.bindingInfo),this.updateNextData({nextData:n}),this.$router.replace({path:\"/account/\".concat(this.wechatType,\"/unbind/phone\"),query:this.$route.query})},goToAutoCreate:function(){var e=this;return(0,i.A)(s().mark(function t(){return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.$router.push({path:\"/\".concat(e.OAuthType,\"/binding/autocreate\"),query:k(k({},e.$route.query),{},{type:\"email\",email:e.email,emailCode:e.code})});case 1:case\"end\":return t.stop()}},t)}))()},failNavigateHandle:function(e){var t={title:e,callbackUrl:(0,_.hL)()};this.updateNextData({nextData:t}),this.$router.push({path:\"/fail\",query:this.$route.query})},errorCodeHandle:function(e){if(e.code){var t=e.code;f.f9.includes(t)?(this.setShowCaptcha({moduleName:this.moduleName,show:!0}),this.resetCaptcha(),this.showCaptchaCodeError=!1):t===f.Zm?this.failNavigateHandle(this.$t(\"v2_error_code_609\")):t===f.Ik&&this.goToAutoCreate(),this.errorCode=t,this.errorMsg=this.$t(\"v2_error_code_\".concat(t))}else this.errorMsg=this.$t(\"v2_tips_off_line\")},handleSendBtnTextChange:function(e){this.unbindWechatSmsSendText=e}}),watch:{initData:{handler:\"fetchUserInfo\",immediate:!0}},components:{acUnboundWaring:d.A,VerifyAccount:u.A,acLink:l.A},beforeRouteEnter:function(e,t,n){n(function(n){document.title=\"\".concat(n.$t(\"v2_common_system_title\"),\" | \").concat(n.$t(\"v2_title_weapp_unbind\")),t.path.includes(\"autocreate\")&&e.meta.error&&n.errorCodeHandle(e.meta.error)})}},A=E,T=n(7358),O=(0,T.A)(A,r,a,!1,null,null,null),$=O.exports},96705:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"card-container\",{staticClass:\"page-oauth-login\",attrs:{showLogo:!1,mainTitle:e.$t(\"v2_title_login\"),theme:\"black\",confirmText:e.isLoginSuccess?e.$t(\"v2_tips_login_success_redirecting\"):e.$t(\"v2_btn_login\"),isConfirming:e.isLogining},on:{confirm:e.handleLogin}},[n(\"div\",{staticClass:\"text-left\",on:{keydown:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:(t.stopPropagation(),e.handleLogin.apply(null,arguments))}}},[n(\"ac-input\",{attrs:{type:\"text\",name:\"username\",errorMsg:e.usernameError,valid:e.isUsernameValid,showError:e.showLoginError,label:e.isSupportPhone?e.$t(\"v2_placeholder_username\"):e.$t(\"v2_placeholder_email\"),inputType:e.isSupportPhone?e.$t(\"v2_placeholder_username\"):e.$t(\"v2_placeholder_email\")},on:{blurValidate:e.handleUsernameValidType},model:{value:e.username,callback:function(t){e.username=t},expression:\"username\"}}),n(\"ac-input\",{attrs:{type:\"password\",errorMsg:e.passwordError,valid:e.isPasswordValid,showError:e.showLoginError,label:e.$t(\"v2_placeholder_password\"),inputType:e.$t(\"v2_placeholder_password\")},on:{blurValidate:e.handlePasswordValidType},model:{value:e.password,callback:function(t){e.password=t},expression:\"password\"}}),n(\"ac-link\",{staticClass:\"oauth-forget text-break\",on:{click:e.handleGoToReset}},[e._v(\" \"+e._s(e.$t(\"v2_tips_forgot_password\"))+\" \")]),e.showCaptcha?n(\"div\",{class:\"captcha \"+(\"googleCaptchaV3\"===e.captchaType?\"\":\"pt-6\")},[n(\"ac-captcha\",{ref:\"captcha\",attrs:{config:e.captchaConfig,valid:e.isCaptchaValid,showError:e.showCaptchaError,errorCode:e.errorCode},on:{validate:e.handleCaptchaValidate,enter:e.handleLogin}})],1):e._e(),n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.errorMsg?n(\"div\",{staticClass:\"ac-error-container\"},[n(\"ac-alert\",[e._v(e._s(e.errorMsg))])],1):e._e()])],1),n(\"div\",{staticClass:\"link-to-register\",attrs:{slot:\"bottom\"},slot:\"bottom\"},[n(\"ac-link\",{on:{click:e.handleGoToRegister}},[e._v(\" \"+e._s(e.$t(\"v2_tips_to_register\"))+\" \")])],1),n(\"browser-guide\",{attrs:{visible:e.showDialog,title:\"打开系统浏览器登录\",description:\"当前登录环境异常，请点击右上角 [...] 按钮<br>选择在浏览器中打开，以登录大疆账号\"},on:{\"update:visible\":function(t){e.showDialog=t}}})],1)},a=[],i=n(23219),o=n(13667),c=n(52072),s=n.n(c),u=n(74949),l=n(37151),d=n(32368),h=n(82068),p=n(85085),m=n(11663),f=n(95441),g=n(78012),_=n(51501),v=n(22680),b=n(39567),C=n(31272),w=n(70780),y=n(88333),k=n(46918),E=n(56090),A=n(42483);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){(0,o.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var $=g.Sn.LOGIN,N={name:\"PageOAuthLogin\",mixins:[E.A],data:function(){return{isLogining:!1,errorMsg:\"\",errorCode:\"\",webAccessType:k.Fr?\"H5\":\"PC\",captchaResult:null,username:\"\",password:\"\",isLoginSuccess:!1,showLoginError:!1,showCaptchaError:!1,usernameValidType:\"click\",passwordValidType:\"click\",showDialog:!1}},computed:O(O({},(0,u.L8)({initData:l.A.common.getter.initData,getConfigCaptcha:l.A.captcha.getter.getConfig,lang:l.A.common.getter.lang})),{},{isSupportPhone:function(){var e;return(null===(e=this.initData)||void 0===e?void 0:e.appConfig)&&\"on\"===this.initData.appConfig[\"\".concat((0,C.R7)(),\".phone.\").concat(this.lang,\".switch\")]},accountType:function(){return(0,v.xf)(this.username)?\"1\":this.isSupportPhone&&(0,v.tp)(this.username)?\"2\":\"0\"},captchaConfig:function(){return this.getConfigCaptcha($)},showCaptcha:function(){return this.captchaConfig.show},captchaType:function(){var e,t,n=null===(e=this.$store.state.captcha[$])||void 0===e?void 0:e.currentCaptchaIndex;return null===(t=this.$store.state.captcha[$])||void 0===t||null===(t=t.captchaList)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.captchaType},isCaptchaValid:function(){return!(this.showCaptcha&&!this.captchaResult)&&!_.vF.includes(this.errorCode)},usernameError:function(){return this.username?\"0\"===this.accountType?this.isSupportPhone?this.$t(\"v2_error_format_username\"):this.$t(\"v2_error_format_email\"):\"\":this.isSupportPhone?this.$t(\"v2_error_required_username\"):this.$t(\"v2_error_required_email\")},isUsernameValid:function(){return!(!this.username&&\"click\"===this.usernameValidType)&&(!this.username||!this.usernameError)},passwordError:function(){return this.password?\"\":this.$t(\"v2_error_required_password\")},isPasswordValid:function(){return!(!this.password&&\"click\"===this.passwordValidType)&&(!this.password||!this.passwordError)},areaCode:function(){return\"2\"===this.accountType?\"86\":\"\"},phone:function(){return\"2\"===this.accountType?this.username:\"\"},email:function(){return\"1\"===this.accountType?this.username:\"\"},isComplexValidate:function(){return this.captchaConfig.isComplexValidate},isInWechat:function(){return(0,k.vq)()}}),created:function(){var e=this;if(this.isInWechat){var t=document.referrer;t&&t.includes(\"aihuishou\")&&t.includes(\"/login/oauth\")&&this.$nextTick(function(){e.showDialog=!0,document.title=\"打开系统浏览器登录\"})}(0,w.S)()},methods:O(O(O({},(0,u.PY)({updateNextData:l.A.common.mutation.updateNextData,setShowCaptcha:l.A.captcha.mutation.setShow,clearTicket:l.A.captcha.mutation.clearTicket})),(0,u.i0)({getParamWithTicket:l.A.captcha.action.getParamWithTicket})),{},{handleUsernameValidType:function(){this.usernameValidType=\"blur\"},handlePasswordValidType:function(){this.passwordValidType=\"blur\"},login:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r,a,i,o,c,u,l,d;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r={webAccessType:e.webAccessType,accountType:e.accountType,areaCode:e.areaCode,phone:e.phone,password:e.password,email:e.email},Object.assign(r,{client_id:(0,b.P3)(\"client_id\"),redirect_uri:(0,b.P3)(\"redirect_uri\"),response_type:(0,b.P3)(\"response_type\"),state:(0,b.P3)(\"state\"),scope:(0,b.P3)(\"scope\"),sign:(0,b.P3)(\"sign\")}),e.isLogining=!0,e.isLoginSuccess=!1,null===(n=e.$ga)||void 0===n||n.event(\"login btn\",\"Click\",\"\".concat((0,C.R7)(),\" to login\")),t.prev=1,t.next=2,e.getInvisibleCaptchaToken();case 2:return i=t.sent,t.next=3,e.getParamWithTicket({moduleName:$,param:r,result:e.captchaResult,invisibleToken:i});case 3:return o=t.sent,t.next=4,y[\"default\"].login.toLogin(o);case 4:c=t.sent,null===(a=e.$ga)||void 0===a||a.event(\"login btn\",\"Click\",\"\".concat((0,C.R7)(),\" login success\")),e.isLoginSuccess=!0,window.location.replace(c.data.callbackUrl),t.next=6;break;case 5:t.prev=5,d=t[\"catch\"](1),e.resetCaptcha(),e.isLogining=!1,e.showLoginError=!0,e.handleErrorCode(d),null===(u=e.$ga)||void 0===u||u.event(\"login btn\",\"Click\",\"\".concat((0,C.R7)(),\" login error \").concat(d.code,\" \")),null===(l=e.$ga)||void 0===l||l.event(\"login_error_backend\",\"Click\",\"code_\".concat(d.code,\" \"));case 6:case\"end\":return t.stop()}},t,null,[[1,5]])}))()},handleCaptchaValidate:function(e,t){this.captchaResult=t,this.resetErrorCode(),this.clearTicket({moduleName:$})},handleLogin:function(){if(this.usernameValidType=\"click\",this.passwordValidType=\"click\",this.errorMsg=null,this.errorCode=null,this.showLoginError=!1,!this.validate())return this.showLoginError=!0,void(this.showCaptchaError=!0);this.showCaptchaError=!1,this.login()},handleGoToReset:function(){var e;if(null===(e=this.$ga)||void 0===e||e.event(\"login btn\",\"Click\",\"\".concat((0,C.R7)(),\" login goto reset view\")),window.top===window)this.$router.push({path:\"/reset\",query:this.$route.query});else{var t=window.location,n=t.protocol,r=t.href;window.open(\"\".concat(n,\"/\").concat(r.match(/\\/[^/]+/g)[0],\"/reset\"))}},handleGoToRegister:function(){if(window.top===window)this.$router.push({path:\"/register\",query:this.$route.query});else{var e=window.location,t=e.protocol,n=e.href;window.open(\"\".concat(t,\"/\").concat(n.match(/\\/[^/]+/g)[0],\"/register\"))}},handleErrorCode:function(e){e.code?(_.vF.includes(e.code)?this.setShowCaptcha({moduleName:$,show:!0}):this.errorMsg=this.$t(\"v2_error_code_\".concat(e.code)),this.errorCode=e.code):this.errorMsg=this.$t(\"v2_tips_off_line\")},validate:function(){return!(!this.isUsernameValid||this.usernameError||!this.isPasswordValid||this.passwordError)&&!(this.showCaptcha&&!this.captchaResult)},resetCaptcha:function(){var e;this.captchaResult=null,null===(e=this.$refs.captcha)||void 0===e||e.reset(),this.clearTicket({moduleName:$})},resetErrorCode:function(){this.errorCode=\"\",this.errorMsg=\"\"}}),watch:{username:\"resetErrorCode\",password:\"resetErrorCode\"},beforeRouteEnter:function(e,t,n){n(function(e){document.title=\"\".concat(e.$t(\"v2_common_system_title\"),\" | \").concat(e.$t(\"v2_title_login\"))})},components:{CardContainer:d.A,acInput:h.A,acAlert:p.A,acCaptcha:m.A,acLink:f.A,BrowserGuide:A.A}},S=N,P=n(7358),x=(0,P.A)(S,r,a,!1,null,null,null),I=x.exports},97518:function(e,t,n){n.r(t),n.d(t,{default:function(){return Se}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"card-container\",{staticClass:\"oauth-bind-phone\",attrs:{showLogo:!1,showSkeleton:!e.inited}},[n(\"skeleton\",{attrs:{slot:\"skeleton\"},slot:\"skeleton\"}),n(\"wechat-icon-container\",{attrs:{activeName:e.activeName,user:e.user,bindUser:e.bindUser,descText:e.descText,phone:e.phone}}),n(\"div\",{staticClass:\"text-left\",class:[e.isMobile?\"mt-8\":\"mt-6\"]},[n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.VERIFY_PHONE?n(\"verify-phone\",{ref:\"verifyPhone\",attrs:{btnSize:e.isMobile?\"medium\":\"large\",btnTheme:e.isMobile?\"blue\":\"black\",phone:e.phone,areaCode:e.areaCode,captchaResult:e.captchaResult,moduleName:e.moduleName,errorCode:e.errorCode,errorMsg:e.errorMsg,loading:e.isSendLoading,subscription:e.subscription},on:{\"update:phone\":function(t){e.phone=t},\"update:areaCode\":function(t){e.areaCode=t},\"update:area-code\":function(t){e.areaCode=t},\"update:captchaResult\":function(t){e.captchaResult=t},\"update:captcha-result\":function(t){e.captchaResult=t},\"update:subscription\":function(t){e.subscription=t},next:e.handleNext,send:e.handleSend,resetErrorCode:e.resetErrorCode}}):e._e(),e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.BIND_PHONE?n(\"bind-phone\",{ref:\"bindPhone\",attrs:{btnSize:e.isMobile?\"medium\":\"large\",btnTheme:e.isMobile?\"blue\":\"black\",moduleName:e.moduleName,errorCode:e.errorCode,errorMsg:e.errorMsg,loading:e.isLoading,isSendLoading:e.isSendLoading,count:e.count,maskInfo:e.phone,code:e.code,confirmText:e.bindButtonText},on:{\"update:code\":function(t){e.code=t},send:e.handleSend,confirm:e.handleConfirm,resetErrorCode:e.resetErrorCode}}):e._e(),e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.CHOOSE_BIND_TYPE?n(\"choose-bind-type\",{attrs:{confirmLoading:e.isLoading,isShowBackWarning:e.isShowBackWarning,errorCode:e.errorCode,errorMsg:e.errorMsg,phone:e.phone,nickName:e.user.nickName},on:{reVerify:e.handleReVerify,LoginByPhone:e.handleLoginByPhone,toModify:e.handleToModify,toSmsLogin:e.handleToSmsLogin}}):e._e(),e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.MODIFY_CONFIRM?n(\"modify-confirm\",{attrs:{phone:e.phone,isShowBackWarning:e.isShowBackWarning,confirmLoading:e.isLoading,errorCode:e.errorCode,errorMsg:e.errorMsg},on:{backToChoose:e.handleToChoose,modifyConfirm:e.handleModifyConfirm,reVerify:e.handleReVerify}}):e._e()],1)],1),e.isMobile?n(\"div\",{staticClass:\"mt-6 text-center\"},[n(\"ac-link\",{attrs:{type:\"primary\"},on:{click:e.handleGoToEmailBinding}},[e._v(\" \"+e._s(e.$t(\"v2_weapp_binding_phone_to_email\"))+\" \")]),\"\"!==e.unbindPhone?n(\"div\",{staticClass:\"mt-4\"},[n(\"ac-link\",{attrs:{type:\"primary\"},on:{click:e.handleGoToPhoneUnbind}},[e._v(\" \"+e._s(e.$t(\"v2_weapp_binding_to_unbind\"))+\" \")])],1):e._e()],1):e._e()],1)},a=[],i=n(23219),o=n(13667),c=n(52072),s=n.n(c),u=n(32368),l=n(95441),d=n(74949),h=n(46918),p=n(37151),m=n(51501),f=n(78012),g=n(43435),_=n(88333),v=n(31272),b=n(72409),C=n(11579),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"bind-phone\",on:{keydown:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.handleNext.apply(null,arguments)}}},[n(\"ac-input\",{staticClass:\"phone-num\",attrs:{type:\"tel\",value:e.splitPhone,maxlength:e.PHONE_SPLIT_MAX_LENGTH,areaCode:e.areaCode,errorMsg:e.phoneError,showError:e.showPhoneError,valid:e.phoneValid,isLoadFocus:!0,placeholder:e.$t(\"v2_placeholder_mobile\"),inputType:e.$t(\"v2_placeholder_mobile\"),valueRefresh:e.valueRefresh},on:{input:e.onPhoneInput}}),e.showCaptcha?n(\"div\",{staticClass:\"captcha\"},[n(\"ac-captcha\",{ref:\"captcha\",attrs:{config:e.captchaConfig,showError:e.showCaptchaCodeError,errorCode:e.errorCode},on:{validate:e.onCaptchaValidate}})],1):e._e(),n(\"policy-and-subscription\",{attrs:{showErrorMessage:e.showCheckAgreeError},on:{checkAgreeChange:e.checkAgreeChange,subscriptionChange:e.subscriptionChange}}),n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.showErrorMsg?n(\"div\",{staticClass:\"ac-error-container\"},[n(\"ac-alert\",[e._v(\" \"+e._s(e.errorMsg)+\" \")])],1):e._e()]),n(\"div\",{staticClass:\"action\"},[n(\"ac-button\",{class:{\"view-disabled\":e.isDisabled},attrs:{type:\"primary\",size:e.btnSize,theme:e.btnTheme,block:\"\",loading:e.loading,buttonType:e.$t(\"v2_btn_next\")},on:{click:e.handleNext}},[e._v(\" \"+e._s(e.$t(\"v2_btn_next\"))+\" \")])],1)],1)},y=[],k=n(82068),E=n(85085),A=n(52621),T=n(98276),O=n(20991),$=n(95077),N=n(22680),S=n(11663);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){(0,o.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var I={name:\"Captcha-mixins\",data:function(){return{captchaResult:null}},computed:x(x({},(0,d.L8)({getConfigCaptcha:p.A.captcha.getter.getConfig})),{},{isCaptchaError:function(){return this.errorCode&&m.vF.includes(this.errorCode)},captchaConfig:function(){return this.getConfigCaptcha(this.moduleName)},showCaptcha:function(){return this.captchaConfig.show},captchaValid:function(){return!(this.showCaptcha&&!this.captchaResult)}}),methods:x(x({},(0,d.PY)({clearTicket:p.A.captcha.mutation.clearTicket})),{},{resetCaptcha:function(){var e;this.captchaResult=null,null===(e=this.$refs.captcha)||void 0===e||e.reset(),this.$emit(\"update:captchaResult\",null),this.clearTicket({moduleName:this.moduleName})},onCaptchaValidate:function(e,t){this.captchaResult=t,this.$emit(\"resetErrorCode\"),this.clearTicket({moduleName:this.moduleName})}}),watch:{errorCode:function(){this.isCaptchaError&&(this.showCaptchaCodeError=!0)},showCaptcha:function(e){e&&this.resetCaptcha()}},components:{acCaptcha:S.A}};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){(0,o.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var B={name:\"OAuth-bind-phone-verify\",components:{acInput:k.A,acAlert:E.A,acButton:A.A,PolicyAndSubscription:T.A},mixins:[I],props:{btnSize:String,btnTheme:String,errorCode:[Number,String],errorMsg:String,moduleName:String,loading:Boolean,phone:String},data:function(){return{showCaptchaCodeError:!1,areaCode:\"86\",showPhoneError:!1,showCheckAgreeError:!1,checkAgree:!1,valueRefresh:!1,PHONE_MAX_LENGTH:O.NV,PHONE_SPLIT_FORMAT:O.II,PHONE_SPLIT_MAX_LENGTH:O.aF}},computed:L(L({},(0,d.L8)({initData:p.A.common.getter.initData})),{},{splitPhone:function(){try{return(0,$.b)(this.phone,O.II)}catch(e){return this.phone}},showErrorMsg:function(){return!this.showCaptchaCodeError&&this.errorMsg},phoneError:function(){return this.phone?(0,N.tp)(this.phone)?\"\":this.$t(\"v2_error_format_mobile\"):this.$t(\"v2_error_required_mobile\")},phoneValid:function(){return(0,N.tp)(this.phone)},isDisabled:function(){return\"\"===this.phoneValid||\"\"===this.phone||!this.checkAgree||!this.captchaResult}}),methods:L(L({},(0,d.PY)({updateSubscription:p.A.common.mutation.updateSubscription})),{},{onPhoneInput:function(e){try{this.valueRefresh=!this.valueRefresh;var t=(0,$.SH)(e);if(!t)return void this.$emit(\"update:phone\",\"\");if(!(0,$.Xs)(t))return;var n=(0,$.b)(e,O.II);if(n===this.splitPhone)return;var r=t.slice(0,O.NV);this.$emit(\"update:phone\",r)}catch(a){this.$emit(\"update:phone\",e)}},verify:function(){var e=!0;return this.phoneValid||(this.showPhoneError=!0,e=!1),this.showCaptcha&&!this.captchaValid&&(this.showCaptchaCodeError=!0,e=!1),this.checkAgree||(this.showCheckAgreeError=!0,e=!1),e&&(this.showPhoneError=!1,this.showCaptchaCodeError=!1),e},handleNext:function(){var e=this;this.$emit(\"resetErrorCode\"),this.$nextTick(function(){if(!e.verify())return!1;e.$emit(\"send\",{success:function(){e.$emit(\"next\")}})})},checkAgreeChange:function(e){this.checkAgree=e},subscriptionChange:function(e){this.updateSubscription(e),this.$emit(\"update:subscription\",e)}}),watch:{areaCode:function(e){this.$emit(\"update:areaCode\",e)},captchaResult:function(e){this.$emit(\"update:captchaResult\",e)}}},R=B,U=n(7358),M=(0,U.A)(R,w,y,!1,null,null,null),j=M.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"bind-phone\",on:{keydown:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.handleSubmit.apply(null,arguments)}}},[n(\"ac-verify-code\",{attrs:{maskInfo:e.maskInfo,name:\"code\",loading:e.isSendLoading,showError:e.showError||null!==e.codeError&&\"\"!==e.codeError,errorMsg:e.codeError,valid:e.codeValid,disabled:e.count>0},on:{blur:e.handleBlur,click:e.handleSendSms},model:{value:e.code,callback:function(t){e.code=t},expression:\"code\"}},[e._v(\" \"+e._s(e.sendText)+\" \")]),n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.showErrorMsg?n(\"div\",{staticClass:\"ac-error-container pt-4\"},[n(\"ac-alert\",[e._v(\" \"+e._s(e.errorMsg)+\" \")])],1):e._e()]),n(\"div\",{staticClass:\"action\"},[n(\"ac-button\",{class:{\"view-disabled\":e.isDisabled},attrs:{type:\"primary\",size:e.btnSize,theme:e.btnTheme,block:\"\",loading:e.loading,buttonType:e.confirmText},on:{click:e.handleSubmit}},[e._v(\" \"+e._s(e.confirmText)+\" \")])],1)],1)},V=[],q=n(48397);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){(0,o.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Y={name:\"OAuth-bind-phone-bind\",components:{acVerifyCode:q.A,acAlert:E.A,acButton:A.A},props:{btnSize:String,btnTheme:String,maskInfo:String,errorCode:[Number,String],errorMsg:String,moduleName:String,loading:Boolean,isSendLoading:Boolean,count:Number,confirmText:String,subscription:Boolean},data:function(){return{showError:!1,isLoaded:!0,code:\"\",phoneExist:!1,showPhoneError:!1}},computed:G(G({},(0,d.L8)({initData:p.A.common.getter.initData})),{},{isDisabled:function(){return\"\"===this.code},tipsVerifyCodeHint:function(){return this.$t(\"v2_tips_verify_code_email_hint\").replace(\"%@\",this.maskInfo||\"\")},showErrorMsg:function(){return!this.isSmsError&&this.errorMsg},sendText:function(){return 0===this.count?this.$t(\"v2_btn_resend\"):\"\".concat(this.$t(\"v2_btn_resend\"),\"(\").concat(this.count,\"s)\")},isSmsError:function(){return m.M$.includes(this.errorCode)},codeValid:function(){return!this.isSmsError&&\"\"!==this.code},codeError:function(){return this.isSmsError?this.$t(\"v2_error_code_\".concat(this.errorCode)):this.isLoaded||this.code?null:this.$t(\"v2_error_required_sms\")}}),mounted:function(){},methods:{verify:function(){var e=!0;return this.codeValid||(this.showError=!0,this.isLoaded=!1,e=!1),e&&(this.showError=!1),e&&(this.showPhoneError=!1),e},handleSendSms:function(){var e=this;this.isLoaded=!0,this.showError=!1,this.showCheckAgreeError=!1,this.$emit(\"resetErrorCode\"),this.$emit(\"send\",{error:function(){e.code&&(e.isLoaded=!1)}})},handleSubmit:function(){var e=this;this.$emit(\"resetErrorCode\"),this.$nextTick(function(){if(!e.verify(\"submit\"))return!1;e.$emit(\"confirm\")})},handleBlur:function(){this.isLoaded=!1}},watch:{code:function(e){this.$emit(\"resetErrorCode\"),this.$emit(\"update:code\",e)}}},F=Y,z=(0,U.A)(F,H,V,!1,null,null,null),X=z.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"wechat-choose-bind-type-container\"},[n(\"div\",{staticClass:\"wechat-choose-bind-type-info\"},[n(\"span\",[e._v(e._s(e.$t(\"v2_wechat_bind_info_first\")))]),n(\"ac-link\",{attrs:{acLabel:e.USAGE_TAG_VALUE.WECHAT_LOGIN_CHANGE_PHONE},on:{click:function(){return e.handleReVerify(!0)}}},[e._v(e._s(e.$t(\"v2_wechat_bind_info_change_phone\")))])],1),n(\"transition\",{attrs:{name:\"back-warning-fade\"}},[e.isShowBackWarning?n(\"back-warning\",{on:{backToVerify:e.handleToLogin}}):e._e()],1),n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.errorMsg&&!e.isShowBackWarning?n(\"div\",{staticClass:\"ac-error-container\"},[n(\"ac-alert\",[e._v(\" \"+e._s(e.errorMsg)+\" \")])],1):e._e()]),n(\"ac-button\",{staticClass:\"wechat-choose-bind-type-btn wechat-bind-and-login-btn\",attrs:{type:\"primary\",disabled:e.isShowBackWarning||e.confirmLoading,acLabel:e.USAGE_TAG_VALUE.WECHAT_LOGIN_MODIFY},on:{click:e.toModifyConfirm}},[e._v(\" \"+e._s(e.$t(\"v2_wechat_bind_and_login\"))+\" \")]),e.isInWeappMiniProgram?e._e():n(\"ac-button\",{staticClass:\"wechat-choose-bind-type-btn wechat-continue-login-with-phone-btn second-btn\",attrs:{type:\"variant\",disabled:e.isShowBackWarning,loading:e.confirmLoading,acLabel:e.USAGE_TAG_VALUE.WECHAT_LOGIN_BY_PHONE},on:{click:e.handlePhoneLogin}},[e._v(\" \"+e._s(e.weappContinueTip)+\" \")])],1)},Z=[],J=n(40759),K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"back-warning-container\"},[n(\"div\",{staticClass:\"back-warning-left\"},[n(\"ac-icon\",{staticClass:\"back-warning-icon\",attrs:{name:\"error\",size:24}})],1),n(\"div\",{staticClass:\"back-warning-main\"},[n(\"div\",{staticClass:\"back-warning-title\"},[e._v(\" \"+e._s(e.$t(\"v2_wechat_back-warning-title\"))+\" \")]),n(\"div\",{staticClass:\"back-warning-desc\"},[n(\"span\",[e._v(e._s(e.$t(\"v2_wechat_back-warning-click\")))]),e._v(\" \"),n(\"ac-link\",{on:{click:e.forceBack}},[e._v(e._s(e.$t(\"v2_wechat_back-warning-re-verify\")))]),n(\"span\",[e._v(e._s(e.$t(\"v2_wechat_back-warning-count-down-info\")))])],1)])])},ee=[],te={name:\"back-warning\",data:function(){return{countdown:5e3,timerId:0}},components:{acLink:l.A},mounted:function(){this.startBackCountdown()},methods:{startBackCountdown:function(){var e=this;this.timerId=setTimeout(function(){e.forceBack()},this.countdown)},forceBack:function(){this.$emit(\"backToVerify\"),window.clearTimeout(this.timerId)}},destroyed:function(){window.clearTimeout(this.timerId)}},ne=te,re=(0,U.A)(ne,K,ee,!1,null,null,null),ae=re.exports,ie={components:{acButton:A.A,BackWarning:ae,acAlert:E.A,acLink:l.A},props:{confirmLoading:Boolean,errorMsg:String,isShowBackWarning:Boolean,phone:String,nickName:String},data:function(){return{USAGE_TAG_VALUE:J.tU}},computed:{weappContinueTip:function(){return this.$t(\"v2_wechat_continue_login_with_phone\")},isInWeappMiniProgram:function(){return(0,h.QA)()}},methods:{handleReVerify:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit(\"reVerify\",e)},handleToLogin:function(){this.$emit(\"toSmsLogin\")},handlePhoneLogin:function(){var e=this;this.$emit(\"resetErrorCode\"),this.$nextTick(function(){e.$emit(\"LoginByPhone\")})},toModifyConfirm:function(){this.$emit(\"toModify\")}}},oe=ie,ce=(0,U.A)(oe,Q,Z,!1,null,null,null),se=ce.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"weapp-modify-container\"},[n(\"h2\",{staticClass:\"weapp-modify-title\"},[e._v(\" \"+e._s(e.$t(\"v2_weapp_modify_confirm-title\"))+\" \")]),n(\"div\",{staticClass:\"weapp-modify-desc\"},[e._v(\" \"+e._s(e.modifyInfo)+\" \")]),n(\"transition\",{attrs:{name:\"back-warning-fade\"}},[e.isShowBackWarning?n(\"back-warning\",{on:{backToVerify:e.handleReVerify}}):e._e()],1),n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.errorMsg&&!e.isShowBackWarning?n(\"div\",{staticClass:\"ac-error-container\"},[n(\"ac-alert\",[e._v(\" \"+e._s(e.errorMsg)+\" \")])],1):e._e()]),n(\"div\",{staticClass:\"weapp-modify-operation\"},[n(\"ac-button\",{staticClass:\"weapp-btn-primary weapp-modify-btn\",attrs:{type:\"primary\",loading:e.confirmLoading,disabled:e.isShowBackWarning,acLabel:e.USAGE_TAG_VALUE.WECHAT_MODIFY_CONFIRM},on:{click:e.handleModifyConfirm}},[e._v(\" \"+e._s(e.$t(\"v2_wechat_modify_confirm\"))+\" \")]),n(\"ac-button\",{staticClass:\"weapp-btn-secondary weapp-modify-btn second-btn\",attrs:{type:\"variant\",disabled:e.isShowBackWarning||e.confirmLoading,acLabel:e.USAGE_TAG_VALUE.WECHAT_MODIFY_BACK},on:{click:e.handleBackToChoose}},[e._v(\" \"+e._s(e.$t(\"v2_wechat_modify_regret\"))+\" \")])],1)],1)},le=[],de={name:\"modify-confirm\",data:function(){return{USAGE_TAG_VALUE:J.tU}},props:{confirmLoading:Boolean,isShowBackWarning:Boolean,errorMsg:String,phone:String},computed:{modifyInfo:function(){return this.$t(\"v2_weapp_modify_confirm-desc\").replace(\"XXXXX\",this.phone||\"\")}},methods:{handleBackToChoose:function(){this.$emit(\"backToChoose\")},handleModifyConfirm:function(){this.$emit(\"modifyConfirm\")},handleReVerify:function(){this.$emit(\"reVerify\")}},components:{acButton:A.A,acAlert:E.A,BackWarning:ae}},he=de,pe=(0,U.A)(he,ue,le,!1,null,null,null),me=pe.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{class:{\"weapp-icon-container\":!0}},[n(\"transition\",{attrs:{name:\"fade\",mode:\"out-in\"}},[e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.MODIFY_CONFIRM?n(\"ac-icon\",{staticClass:\"icon-warning weapp-warning-icon\",attrs:{name:\"warning-lg\",size:64,color:\"#ff9502\"}}):e.activeName===e.WECHAT_BIND_ACTIVE_TYPE.CHOOSE_BIND_TYPE?n(\"div\",{staticClass:\"weapp-choose-type\"},[n(\"div\",{staticClass:\"weapp-choose-type-left\"},[n(\"ac-oAuth-user\",{attrs:{pcMt4:\"\",avatarUrl:e.bindUser.avatarUrl,nickName:e.bindUser.nickName,customIcon:\"wechat-grey\",customSize:40}})],1),n(\"div\",{staticClass:\"weapp-choose-type-center\"},[n(\"ac-icon\",{attrs:{name:\"link\",size:24}})],1),n(\"div\",{staticClass:\"weapp-choose-type-right\"},[n(\"ac-oAuth-user\",{attrs:{pcMt4:\"\",customIcon:\"phone\",customSize:40,nickName:e.phone}})],1)]):n(\"ac-oAuth-user\",{attrs:{pcMt4:\"\",avatarUrl:e.user.avatarUrl,nickName:e.user.nickName,desc:e.descText}})],1)],1)},ge=[],_e=n(78841),ve={VERIFY_PHONE:\"VERIFY_PHONE\",BIND_PHONE:\"BIND_PHONE\",CHOOSE_BIND_TYPE:\"CHOOSE_BIND_TYPE\",MODIFY_CONFIRM:\"MODIFY_CONFIRM\"},be={name:\"WechatIconContainer\",components:{acOAuthUser:_e.A},props:{activeName:{type:String,default:\"\"},user:{type:Object,default:null},bindUser:{type:Object,default:null},phone:String,descText:{type:String,default:\"\"}},data:function(){return{WECHAT_BIND_ACTIVE_TYPE:ve}}},Ce=be,we=(0,U.A)(Ce,fe,ge,!1,null,null,null),ye=we.exports,ke=n(17579);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach(function(t){(0,o.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Te=\"微信用户\",Oe={name:\"OAuth-bind-phone\",mixins:[I],data:function(){return{isMobile:h.Fr,moduleName:f.Sn.WECHAT_BIND_PHONE,smsType:g.i.WECHAT_BIND_PHONE,activeName:ve.VERIFY_PHONE,user:{nickName:\"\",avatarUrl:\"\"},bindButtonText:this.$t(\"v2_weapp_binding_phone_submit\"),count:0,interval:null,isSendLoading:!1,isLoading:!1,inited:!1,errorMsg:\"\",errorCode:\"\",phone:\"\",areaCode:\"86\",code:\"\",subscription:!1,unbindPhone:\"\",phoneBindTicket:\"\",WECHAT_BIND_ACTIVE_TYPE:ve}},watch:{initData:{handler:\"fetchUserInfo\",immediate:!0},phone:function(){this.resetErrorCode()}},computed:Ae(Ae({},(0,d.L8)({initData:p.A.common.getter.initData,lang:p.A.common.getter.lang})),{},{bindUser:function(){var e;if(null===(e=this.user)||void 0===e||!e.nickName)return{nickName:\"\",avatarUrl:\"\"};var t=this.user.nickName===Te;return t?{nickName:\"微信\",avatarUrl:\"\"}:{nickName:this.user.nickName,avatarUrl:this.user.avatarUrl}},OAuthType:function(){return\"wechat\"},descText:function(){return h.Fr?this.$t(\"v2_weapp_binding_phone_reminder\"):this.activeName===ve.VERIFY_PHONE?this.$t(\"v2_weapp_binding_reminder_phone\"):\"\"},isShowBackWarning:function(){return this.errorCode===m.nS}}),methods:Ae(Ae(Ae({},(0,d.PY)({updateNextData:p.A.common.mutation.updateNextData,setShowCaptcha:p.A.captcha.mutation.setShow})),(0,d.i0)({getParamWithTicket:p.A.captcha.action.getParamWithTicket})),{},{fetchUserInfo:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r,a,i;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(\"zh_CN\"===e.lang){t.next=1;break}return e.failNavigateHandle(e.$t(\"v2_error_code_520\")),t.abrupt(\"return\");case 1:return t.prev=1,e.loading=!0,n={uuid:e.$route.query.oauthLoginTicket},t.next=2,_[\"default\"].middleware.getOauthUserInfo(n);case 2:r=t.sent,e.user.nickName=r.data.nickName,e.user.avatarUrl=r.data.avatarUrl,e.inited=!0,t.next=4;break;case 3:return t.prev=3,i=t[\"catch\"](1),null===(a=e.$ga)||void 0===a||a.event(\"get wechat userInfo\",\"Click\",\"\".concat((0,v.R7)(),\" get wechat userInfo error \").concat(i.code)),e.failNavigateHandle(i.code?e.$t(\"v2_error_code_\".concat(i.code)):\"\"),t.abrupt(\"return\");case 4:return t.prev=4,e.loading=!1,t.finish(4);case 5:case\"end\":return t.stop()}},t,null,[[1,3,4,5]])}))()},handleNext:function(){document.documentElement.scrollTop=0,this.activeName=ve.BIND_PHONE},handleBindConflict:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\";this.phoneBindTicket=e,this.activeName=ve.CHOOSE_BIND_TYPE},handleSend:function(e){var t=this;return(0,i.A)(s().mark(function n(){var r,a,i,o,c,u,l;return s().wrap(function(n){while(1)switch(n.prev=n.next){case 0:return t.isSendLoading=!0,r={areaCode:t.areaCode,phone:t.phone,smsType:t.smsType},n.prev=1,n.next=2,t.getParamWithTicket({moduleName:t.moduleName,param:r,result:t.captchaResult});case 2:return o=n.sent,null===(a=t.$ga)||void 0===a||a.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" send code to phone\")),(0,b.XP)(b.j9.STEP_1,{path:C.Lq.SEND_SMS,scene:C.Nd.OAUTH_BIND_SMS}),n.next=3,_[\"default\"].common.sendSmsCode(o);case 3:c=n.sent,(0,b.XP)(b.j9.STEP_4,{path:C.Lq.SEND_SMS,scene:C.Nd.OAUTH_BIND_SMS}),0===c.code&&t.startTiming(),null===(i=t.$ga)||void 0===i||i.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" send code to phone success\")),null!==e&&void 0!==e&&e.success&&e.success(c),n.next=5;break;case 4:n.prev=4,l=n[\"catch\"](1),null===(u=t.$ga)||void 0===u||u.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" send code to phone error \").concat(l.code)),t.errorCodeHandle(l),null!==e&&void 0!==e&&e.error&&e.error(l);case 5:return n.prev=5,t.isSendLoading=!1,n.finish(5);case 6:case\"end\":return n.stop()}},n,null,[[1,4,5,6]])}))()},handleConfirm:function(){var e=arguments,t=this;return(0,i.A)(s().mark(function n(){var r,a,i,o,c,u,l;return s().wrap(function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]&&e[0],n.prev=1,t.isLoading=!0,t.bindButtonText=t.$t(\"v2_weapp_binding_submit_ing\"),o={areaCode:t.areaCode,phone:t.phone,smsCode:t.code,subscription:t.subscription,oauthLoginTicket:t.$route.query.oauthLoginTicket,phoneBindTicket:r?t.phoneBindTicket:\"\"},t.isMobile&&(o.autoCreate=!1),null===(a=t.$ga)||void 0===a||a.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" bind to phone\")),(0,b.XP)(b.j9.STEP_6,{path:C.Lq.BIND_WECHAT_BIND_PHONE,scene:C.Nd.OAUTH_BIND_SMS}),n.next=2,_[\"default\"].wechat.bindingPhone(o);case 2:return c=n.sent,(0,b.kL)(),t.bindButtonText=t.$t(\"v2_weapp_binding_submit_ok\"),null===(i=t.$ga)||void 0===i||i.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" bind to phone success\")),window.location.replace(c.data.callbackUrl),n.abrupt(\"return\",c);case 3:n.prev=3,l=n[\"catch\"](1),t.isLoading=!1,t.bindButtonText=t.$t(\"v2_weapp_binding_phone_submit\"),null===(u=t.$ga)||void 0===u||u.event(\"oauthBind btn\",\"Click\",\"\".concat((0,v.R7)(),\" bind to phone error \").concat(l.code)),t.errorCodeHandle(l);case 4:case\"end\":return n.stop()}},n,null,[[1,3]])}))()},handleLoginByPhone:function(){var e=this;return(0,i.A)(s().mark(function t(){var n,r,a;return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n={phoneBindTicket:e.phoneBindTicket},t.prev=1,e.isLoading=!0,t.next=2,_[\"default\"].wechat.phoneLogin(n);case 2:r=t.sent,window.location.replace(r.data.callbackUrl),t.next=4;break;case 3:t.prev=3,a=t[\"catch\"](1),e.errorCodeHandle(a);case 4:return t.prev=4,e.isLoading=!1,t.finish(4);case 5:case\"end\":return t.stop()}},t,null,[[1,3,4,5]])}))()},handleModifyConfirm:function(){var e=this;return(0,i.A)(s().mark(function t(){return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.resetErrorCode(),e.handleConfirm(!0);case 1:case\"end\":return t.stop()}},t)}))()},handleToModify:function(){this.resetErrorCode(),this.activeName=ve.MODIFY_CONFIRM},handleToChoose:function(){this.resetErrorCode(),this.activeName=ve.CHOOSE_BIND_TYPE},handleGoToEmailBinding:function(){this.$router.replace({path:\"/\".concat(this.OAuthType,\"/binding/email\"),query:this.$route.query})},handleGoToPhoneUnbind:function(){this.$router.replace({path:\"/account/\".concat(this.OAuthType,\"/unbind/phone\"),query:Ae(Ae({},this.$route.query),{},{backUrl:window.location.href,phone:this.unbindPhone})})},goToAutoCreate:function(){var e=this;return(0,i.A)(s().mark(function t(){return s().wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!h.QA&&!h._8){t.next=1;break}return e.$router.replace({path:\"/\".concat(e.OAuthType,\"/binding/autocreate\"),query:Ae(Ae({},e.$route.query),{},{type:\"phone\",areaCode:e.areaCode,phone:e.phone,smsCode:e.code})}),t.abrupt(\"return\");case 1:e.$router.push({path:\"/\".concat(e.OAuthType,\"/binding/autocreate\"),query:Ae(Ae({},e.$route.query),{},{type:\"phone\",areaCode:e.areaCode,phone:e.phone,smsCode:e.code})});case 2:case\"end\":return t.stop()}},t)}))()},startTiming:function(){var e=this;this.count=60,this.interval&&window.clearInterval(this.interval),this.interval=window.setInterval(function(){e.count--,e.count<=0&&(window.clearInterval(e.interval),e.interval=null)},1e3)},resetErrorCode:function(){this.errorCode=\"\",this.errorMsg=\"\"},resetCaptcha:function(){var e;this.captchaResult=null,null===(e=this.$refs)||void 0===e||null===(e=e.verifyPhone)||void 0===e||e.resetCaptcha()},failNavigateHandle:function(e){if(\"\"!==e){var t={title:e,callbackUrl:(0,v.hL)()};this.updateNextData({nextData:t})}this.$router.push({path:\"/fail\",query:this.$route.query})},errorCodeHandle:function(e){if(e.code){var t=e.code;this.errorCode=e.code,m.f9.concat(m.DW).includes(t)?(this.setShowCaptcha({moduleName:this.moduleName,show:!0}),this.resetCaptcha(),this.errorMsg=this.$t(\"v2_error_code_\".concat(t))):m.zo.includes(t)?this.failNavigateHandle(this.$t(\"v2_error_code_609\")):t===m.Ik?this.goToAutoCreate():m.Xm.includes(t)?e.data?this.handleBindConflict(e.data):(this.unbindPhone=this.phone,this.errorMsg=this.$t(\"v2_weapp_binding_phone_binding\")):this.errorMsg=this.$t(\"v2_error_code_\".concat(t)),this.errorCode=t}else this.errorMsg=this.$t(\"v2_tips_off_line\")},handleReVerify:function(e){this.resetErrorCode(),this.resetCaptcha(),this.phoneBindTicket=\"\",e&&(this.phone=\"\"),this.activeName=ve.VERIFY_PHONE},handleToSmsLogin:function(){sessionStorage.setItem(\"loginMethod\",\"WITH_MESSAGE\"),sessionStorage.setItem(\"accountPhone\",this.phone),this.$router.push({path:\"/login\",query:this.$route.query})}}),beforeRouteEnter:function(e,t,n){n(function(n){document.title=\"\".concat(n.$t(\"v2_common_system_title\"),\" | \").concat(n.$t(\"v2_title_binding_phone\")),t.path.includes(\"autocreate\")&&e.meta.error&&n.errorCodeHandle(e.meta.error)})},components:{Skeleton:ke.A,CardContainer:u.A,WechatIconContainer:ye,acLink:l.A,VerifyPhone:j,BindPhone:X,ChooseBindType:se,ModifyConfirm:me}},$e=Oe,Ne=(0,U.A)($e,r,a,!1,null,null,null),Se=Ne.exports}}]); //# sourceMappingURL=chunk-common-3acabcaf.baad8c3e.js.map"
}
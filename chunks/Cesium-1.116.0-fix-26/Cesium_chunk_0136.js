{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 136,
    "total_chunks": 194,
    "chunk_size": 49690,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.732Z"
  },
  "content": "(1.0 - Fc) * G_Vis; B += Fc * G_Vis; } } return vec2(A, B) / float(NumSamples); } void main() { out_FragColor = vec4(integrateBrdf(v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0); } `;function Gw(){this._colorTexture=void 0,this._drawCommand=void 0}Object.defineProperties(Gw.prototype,{colorTexture:{get:function(){return this._colorTexture}}});function _at(e,t,n){let i=t.createViewportQuadCommand(Rw,{framebuffer:n,renderState:Ne.fromCache({viewport:new ze(0,0,256,256)})});e._drawCommand=i}Gw.prototype.update=function(e){if(!l(this._colorTexture)){let t=e.context,n=new Ft({context:t,width:256,height:256,pixelFormat:at.RGBA,pixelDatatype:Qe.UNSIGNED_BYTE,sampler:mn.NEAREST});this._colorTexture=n;let i=new $s({context:t,colorTextures:[n],destroyAttachments:!1});_at(this,t,i),this._drawCommand.execute(t),i.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}};Gw.prototype.isDestroyed=function(){return!1};Gw.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),me(this)};var Ew=Gw;var ERi=T(S(),1);var jZi=T(S(),1);var Bye={};function Tat(e,t,n){let i,o,r;if(e instanceof _i){let s=Math.tan(.5*e.fovy);return i=e.near,o=e.near*s,r=e.aspectRatio*o,Math.max(t*i/r,n*i/o)}else if(e instanceof ol)return i=e.near,o=e.top,r=e.right,Math.max(t*i/r,n*i/o);return Math.max(t,n)}var Sat=new h,kye=new h;function Yye(e,t,n,i){if(l(i)&&n(.5)>i){let o=n(0),r=n(1),s=n(.5),a=s-o,c=s-r;return function(d){let u=n(d);if(d<=.5){let p=(u-o)/a;return P.lerp(e,-P.PI_OVER_TWO,p)}let m=(u-r)/c;return P.lerp(-P.PI_OVER_TWO,t,1-m)}}return function(o){return P.lerp(e,t,o)}}function H4(e,t,n,i,o){let r=o,s=Math.max(n,i);if(!l(r)){let a=e.position,c=t,d=e.up,u=e.right,m=e.frustum,p=h.subtract(a,c,Sat),b=h.magnitude(h.multiplyByScalar(d,h.dot(p,d),kye)),f=h.magnitude(h.multiplyByScalar(u,h.dot(p,u),kye));r=Math.min(Tat(m,b,f)*.2,1e9)}if(s<r){let d=-Math.pow((r-n)*1e6,.125),u=Math.pow((r-i)*1e6,1/8);return function(m){let p=m*(u-d)+d;return-Math.pow(p,8)/1e6+r}}return function(a){return P.lerp(n,i,a)}}function Xw(e,t){return P.equalsEpsilon(e,P.TWO_PI,P.EPSILON11)&&(e=0),t>e+Math.PI?e+=P.TWO_PI:t<e-Math.PI&&(e-=P.TWO_PI),e}var Oye=new h;function Cat(e,t,n,i,o,r,s,a){let c=e.camera,d=h.clone(c.position,Oye),u=c.pitch,m=Xw(c.heading,i),p=Xw(c.roll,r),b=H4(c,n,d.z,n.z,s),f=Yye(u,o,b,a);function x(_){let C=_.time/t;c.setView({orientation:{heading:P.lerp(m,i,C),pitch:f(C),roll:P.lerp(p,r,C)}}),D.lerp(d,n,C,c.position),c.position.z=b(C)}return x}function Vat(e,t){e.longitude<t.longitude?e.longitude+=P.TWO_PI:t.longitude+=P.TWO_PI}function Lat(e,t){let n=e.longitude-t.longitude;n<-P.PI?e.longitude+=P.TWO_PI:n>P.PI&&(t.longitude+=P.TWO_PI)}var Zat=new he,Rat=new he;function Gat(e,t,n,i,o,r,s,a,c,d){let u=e.camera,p=e.mapProjection.ellipsoid,b=he.clone(u.positionCartographic,Zat),f=u.pitch,x=Xw(u.heading,i),_=Xw(u.roll,r),C=p.cartesianToCartographic(n,Rat);b.longitude=P.zeroToTwoPi(b.longitude),C.longitude=P.zeroToTwoPi(C.longitude);let V=!1;if(l(a)){let X=P.zeroToTwoPi(a),v=Math.min(b.longitude,C.longitude),W=Math.max(b.longitude,C.longitude),F=X>=v&&X<=W;if(l(c)){let A=Math.abs(b.longitude-C.longitude),y=P.TWO_PI-A;(F?A:y)<(F?y:A)*c&&!F&&(V=!0)}else F||(V=!0)}V?Vat(b,C):Lat(b,C);let L=H4(u,n,b.height,C.height,s),R=Yye(f,o,L,d);function G(){let X=b.longitude,v=C.longitude,W=b.latitude,F=C.latitude;return function(y){let Z=y.time/t,E=h.fromRadians(P.lerp(X,v,Z),P.lerp(W,F,Z),L(Z),p);u.setView({destination:E,orientation:{heading:P.lerp(x,i,Z),pitch:R(Z),roll:P.lerp(_,r,Z)}})}}return G()}function Eat(e,t,n,i,o,r,s){let a=e.camera,c=h.clone(a.position,Oye),d=Xw(a.heading,i),u=a.frustum.right-a.frustum.left,m=H4(a,n,u,n.z,s);function p(b){let f=b.time/t;a.setView({orientation:{heading:P.lerp(d,i,f)}}),D.lerp(c,n,f,a.position);let x=m(f),_=a.frustum,C=_.top/_.right,V=(x-(_.right-_.left))*.5;_.right+=V,_.left-=V,_.top=C*_.right,_.bottom=-_.top}return p}var Uye=new he,Xat=new h;function z4(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function Dye(e,t){function n(){typeof t==\"function\"&&t(),e.enableInputs=!0}return n}Bye.createTween=function(e,t){t=g(t,g.EMPTY_OBJECT);let n=t.destination,i=e.mode;if(i===ie.MORPHING)return z4();let o=g(t.convert,!0),r=e.mapProjection,s=r.ellipsoid,a=t.maximumHeight,c=t.flyOverLongitude,d=t.flyOverLongitudeWeight,u=t.pitchAdjustHeight,m=t.easingFunction;o&&i!==ie.SCENE3D&&(s.cartesianToCartographic(n,Uye),n=r.project(Uye,Xat));let p=e.camera,b=t.endTransform;l(b)&&p._setTransform(b);let f=t.duration;l(f)||(f=Math.ceil(h.distance(p.position,n)/1e6)+2,f=Math.min(f,3));let x=g(t.heading,0),_=g(t.pitch,-P.PI_OVER_TWO),C=g(t.roll,0),V=e.screenSpaceCameraController;V.enableInputs=!1;let L=Dye(V,t.complete),R=Dye(V,t.cancel),G=p.frustum,X=e.mode===ie.SCENE2D;if(X=X&&D.equalsEpsilon(p.position,n,P.EPSILON6),X=X&&P.equalsEpsilon(Math.max(G.right-G.left,G.top-G.bottom),n.z,P.EPSILON6),X=X||e.mode!==ie.SCENE2D&&h.equalsEpsilon(n,p.position,P.EPSILON10),X=X&&P.equalsEpsilon(P.negativePiToPi(x),P.negativePiToPi(p.heading),P.EPSILON10)&&P.equalsEpsilon(P.negativePiToPi(_),P.negativePiToPi(p.pitch),P.EPSILON10)&&P.equalsEpsilon(P.negativePiToPi(C),P.negativePiToPi(p.roll),P.EPSILON10),X)return z4(L,R);let v=new Array(4);if(v[ie.SCENE2D]=Eat,v[ie.SCENE3D]=Gat,v[ie.COLUMBUS_VIEW]=Cat,f<=0)return z4(function(){v[i](e,1,n,x,_,C,a,c,d,u)({time:1}),typeof L==\"function\"&&L()},R);let W=v[i](e,f,n,x,_,C,a,c,d,u);if(!l(m)){let F=p.positionCartographic.height,A=i===ie.SCENE3D?s.cartesianToCartographic(n).height:n.z;F>A&&F>11500?m=Ar.CUBIC_OUT:m=Ar.QUINTIC_IN_OUT}return{duration:f,easingFunction:m,startObject:{time:0},stopObject:{time:f},update:W,complete:L,cancel:R}};var Iw=Bye;var $Zi=T(S(),1),Iat={ROTATE:0,INFINITE_SCROLL:1},Jl=Object.freeze(Iat);function en(e){this._scene=e,this._transform=M.clone(M.IDENTITY),this._invTransform=M.clone(M.IDENTITY),this._actualTransform=M.clone(M.IDENTITY),this._actualInvTransform=M.clone(M.IDENTITY),this._transformChanged=!1,this.position=new h,this._position=new h,this._positionWC=new h,this._positionCartographic=new he,this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new h,this._direction=new h,this._directionWC=new h,this.up=new h,this._up=new h,this._upWC=new h,this.right=new h,this._right=new h,this._rightWC=new h,this.frustum=new _i,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=P.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new ge,this._moveEnd=new ge,this._changed=new ge,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this._changedHeading=void 0,this._changedRoll=void 0,this.percentageChanged=.5,this._viewMatrix=new M,this._invViewMatrix=new M,$ye(this),this._mode=ie.SCENE3D,this._modeChanged=!0;let t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new he(Math.PI,P.PI_OVER_TWO)),this._max2Dfrustum=void 0,uge(this,en.DEFAULT_VIEW_RECTANGLE,this.position,!0);let n=h.magnitude(this.position);n+=n*en.DEFAULT_VIEW_FACTOR,h.normalize(this.position,this.position),h.multiplyByScalar(this.position,n,this.position)}en.TRANSFORM_2D=new M(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);en.TRANSFORM_2D_INVERSE=M.inverseTransformation(en.TRANSFORM_2D,new M);en.DEFAULT_VIEW_RECTANGLE=le.fromDegrees(-95,-20,-70,90);en.DEFAULT_VIEW_FACTOR=.5;en.DEFAULT_OFFSET=new Ou(0,-P.PI_OVER_FOUR,0);function $ye(e){M.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),M.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),M.inverseTransformation(e._viewMatrix,e._invViewMatrix)}function Wat(e){if(!l(e._oldPositionWC))e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC);else{e.positionWCDeltaMagnitudeLastFrame=e.positionWCDeltaMagnitude;let t=h.subtract(e.positionWC,e._oldPositionWC,e._oldPositionWC);e.positionWCDeltaMagnitude=h.magnitude(t),e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC),e.positionWCDeltaMagnitude>0?(e.timeSinceMoved=0,e._lastMovedTimestamp=fi()):e.timeSinceMoved=Math.max(fi()-e._lastMovedTimestamp,0)/1e3}}en.prototype.canPreloadFlight=function(){return l(this._currentFlight)&&this._mode!==ie.SCENE2D};en.prototype._updateCameraChanged=function(){let e=this;if(Wat(e),e._changed.numberOfListeners===0)return;let t=e.percentageChanged,n=e.heading;l(e._changedHeading)||(e._changedHeading=n);let i=Math.abs(e._changedHeading-n)%P.TWO_PI;i=i>P.PI?P.TWO_PI-i:i;let o=i/Math.PI;o>t&&(e._changedHeading=n);let r=e.roll;l(e._changedRoll)||(e._changedRoll=r);let s=Math.abs(e._changedRoll-r)%P.TWO_PI;s=s>P.PI?P.TWO_PI-s:s;let a=s/Math.PI;if(a>t&&(e._changedRoll=r),(a>t||o>t)&&e._changed.raiseEvent(Math.max(a,o)),e._mode===ie.SCENE2D){if(!l(e._changedFrustum)){e._changedPosition=h.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone();return}let p=e.position,b=e._changedPosition,f=e.frustum,x=e._changedFrustum,_=p.x+f.left,C=p.x+f.right,V=b.x+x.left,L=b.x+x.right,R=p.y+f.bottom,G=p.y+f.top,X=b.y+x.bottom,v=b.y+x.top,W=Math.max(_,V),F=Math.min(C,L),A=Math.max(R,X),y=Math.min(G,v),Z;if(W>=F||A>=G)Z=1;else{let E=x;_<V&&C>L&&R<X&&G>v&&(E=f),Z=1-(F-W)*(y-A)/((E.right-E.left)*(E.top-E.bottom))}Z>t&&(e._changed.raiseEvent(Z),e._changedPosition=h.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone(e._changedFrustum));return}if(!l(e._changedDirection)){e._changedPosition=h.clone(e.positionWC,e._changedPosition),e._changedDirection=h.clone(e.directionWC,e._changedDirection);return}let c=P.acosClamped(h.dot(e.directionWC,e._changedDirection)),d;l(e.frustum.fovy)?d=c/(e.frustum.fovy*.5):d=c;let m=h.distance(e.positionWC,e._changedPosition)/e.positionCartographic.height;(d>t||m>t)&&(e._changed.raiseEvent(Math.max(d,m)),e._changedPosition=h.clone(e.positionWC,e._changedPosition),e._changedDirection=h.clone(e.directionWC,e._changedDirection))};function Pat(e){Wt.basisTo2D(e._projection,e._transform,e._actualTransform)}var vat=new he,wat=new h,XD=new h,Fat=new se,Aat=new se,Mat=new se,Nat=new se,kat=new se;function Uat(e){let t=e._projection,n=t.ellipsoid,i=M.getColumn(e._transform,3,Fat),o=n.cartesianToCartographic(i,vat),r=t.project(o,wat),s=Aat;s.x=r.z,s.y=r.x,s.z=r.y,s.w=1;let a=se.clone(se.UNIT_X,kat),c=se.add(M.getColumn(e._transform,0,XD),i,XD);n.cartesianToCartographic(c,o),t.project(o,r);let d=Mat;d.x=r.z,d.y=r.x,d.z=r.y,d.w=0,h.subtract(d,s,d),d.x=0;let u=Nat;if(h.magnitudeSquared(d)>P.EPSILON10)h.cross(a,d,u);else{let m=se.add(M.getColumn(e._transform,1,XD),i,XD);n.cartesianToCartographic(m,o),t.project(o,r),u.x=r.z,u.y=r.x,u.z=r.y,u.w=0,h.subtract(u,s,u),u.x=0,h.magnitudeSquared(u)<P.EPSILON10&&(se.clone(se.UNIT_Y,d),se.clone(se.UNIT_Z,u))}h.cross(u,a,d),h.normalize(d,d),h.cross(a,d,u),h.normalize(u,u),M.setColumn(e._actualTransform,0,d,e._actualTransform),M.setColumn(e._actualTransform,1,u,e._actualTransform),M.setColumn(e._actualTransform,2,a,e._actualTransform),M.setColumn(e._actualTransform,3,s,e._actualTransform)}var K4=new h;function Sc(e){let t=e._mode,n=!1,i=0;t===ie.SCENE2D&&(i=e.frustum.right-e.frustum.left,n=i!==e._positionCartographic.height);let o=e._position,r=!h.equals(o,e.position)||n;r&&(o=h.clone(e.position,e._position));let s=e._direction,a=!h.equals(s,e.direction);a&&(h.normalize(e.direction,e.direction),s=h.clone(e.direction,e._direction));let c=e._up,d=!h.equals(c,e.up);d&&(h.normalize(e.up,e.up),c=h.clone(e.up,e._up));let u=e._right,m=!h.equals(u,e.right);m&&(h.normalize(e.right,e.right),u=h.clone(e.right,e._right));let p=e._transformChanged||e._modeChanged;e._transformChanged=!1,p&&(M.inverseTransformation(e._transform,e._invTransform),e._mode===ie.COLUMBUS_VIEW||e._mode===ie.SCENE2D?M.equals(M.IDENTITY,e._transform)?M.clone(en.TRANSFORM_2D,e._actualTransform):e._mode===ie.COLUMBUS_VIEW?Pat(e):Uat(e):M.clone(e._transform,e._actualTransform),M.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);let b=e._actualTransform;if(r||p)if(e._positionWC=M.multiplyByPoint(b,o,e._positionWC),t===ie.SCENE3D||t===ie.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{let f=K4;f.x=e._positionWC.y,f.y=e._positionWC.z,f.z=e._positionWC.x,t===ie.SCENE2D&&(f.z=i),e._projection.unproject(f,e._positionCartographic)}if(a||d||m){let f=h.dot(s,h.cross(c,u,K4));if(Math.abs(1-f)>P.EPSILON2){let x=1/h.magnitudeSquared(c),_=h.dot(c,s)*x,C=h.multiplyByScalar(s,_,K4);c=h.normalize(h.subtract(c,C,e._up),e._up),h.clone(c,e.up),u=h.cross(s,c,e._right),h.clone(u,e.right)}}(a||p)&&(e._directionWC=M.multiplyByPointAsVector(b,s,e._directionWC),h.normalize(e._directionWC,e._directionWC)),(d||p)&&(e._upWC=M.multiplyByPointAsVector(b,c,e._upWC),h.normalize(e._upWC,e._upWC)),(m||p)&&(e._rightWC=M.multiplyByPointAsVector(b,u,e._rightWC),h.normalize(e._rightWC,e._rightWC)),(r||a||d||m||p)&&$ye(e)}function ege(e,t){let n;return P.equalsEpsilon(Math.abs(e.z),1,P.EPSILON3)?n=Math.atan2(t.y,t.x)-P.PI_OVER_TWO:n=Math.atan2(e.y,e.x)-P.PI_OVER_TWO,P.TWO_PI-P.zeroToTwoPi(n)}function tge(e){return P.PI_OVER_TWO-P.acosClamped(e.z)}function nge(e,t,n){let i=0;return P.equalsEpsilon(Math.abs(e.z),1,P.EPSILON3)||(i=Math.atan2(-n.z,t.z),i=P.zeroToTwoPi(i+P.TWO_PI)),i}var PD=new M,vD=new M;Object.defineProperties(en.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return Sc(this),this._invTransform}},viewMatrix:{get:function(){return Sc(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return Sc(this),this._invViewMatrix}},positionCartographic:{get:function(){return Sc(this),this._positionCartographic}},positionWC:{get:function(){return Sc(this),this._positionWC}},directionWC:{get:function(){return Sc(this),this._directionWC}},upWC:{get:function(){return Sc(this),this._upWC}},rightWC:{get:function(){return Sc(this),this._rightWC}},heading:{get:function(){if(this._mode!==ie.MORPHING){let e=this._projection.ellipsoid,t=M.clone(this._transform,PD),n=Wt.eastNorthUpToFixedFrame(this.positionWC,e,vD);this._setTransform(n);let i=ege(this.direction,this.up);return this._setTransform(t),i}}},pitch:{get:function(){if(this._mode!==ie.MORPHING){let e=this._projection.ellipsoid,t=M.clone(this._transform,PD),n=Wt.eastNorthUpToFixedFrame(this.positionWC,e,vD);this._setTransform(n);let i=tge(this.direction);return this._setTransform(t),i}}},roll:{get:function(){if(this._mode!==ie.MORPHING){let e=this._projection.ellipsoid,t=M.clone(this._transform,PD),n=Wt.eastNorthUpToFixedFrame(this.positionWC,e,vD);this._setTransform(n);let i=nge(this.direction,this.up,this.right);return this._setTransform(t),i}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}});en.prototype.update=function(e){let t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==ie.MORPHING,t=this._mode===ie.SCENE2D),t){let n=this._max2Dfrustum=this.frustum.clone(),i=2,o=n.top/n.right;n.right=this._maxCoord.x*i,n.left=-n.right,n.top=o*n.right,n.bottom=-n.top}this._mode===ie.SCENE2D&&sge(this,this.position)};var Dat=new h,Bat=new h,Yat=new h;en.prototype._setTransform=function(e){let t=h.clone(this.positionWC,Dat),n=h.clone(this.upWC,Bat),i=h.clone(this.directionWC,Yat);M.clone(e,this._transform),this._transformChanged=!0,Sc(this);let o=this._actualInvTransform;M.multiplyByPoint(o,t,this.position),M.multiplyByPointAsVector(o,i,this.direction),M.multiplyByPointAsVector(o,n,this.up),h.cross(this.direction,this.up,this.right),Sc(this)};var Oat=new D,zat=new bn,Hat=new h,Kat=new h;function ige(e){if(!M.equals(M.IDENTITY,e.transform))return h.magnitude(e.position);let t=e._scene,n=t.globe,i=Oat;i.x=t.canvas.clientWidth/2,i.y=t.canvas.clientHeight/2;let o;if(l(n)){let a=e.getPickRay(i,zat);o=n.pickWorldCoordinates(a,t,!0,Hat)}let r;t.pickPositionSupported&&(r=t.pickPositionWorldCoordinates(i,Kat));let s;if(l(o)||l(r)){let a=l(r)?h.distance(r,e.positionWC):Number.POSITIVE_INFINITY,c=l(o)?h.distance(o,e.positionWC):Number.POSITIVE_INFINITY;s=Math.min(a,c)}else s=Math.max(e.positionCartographic.height,0);return s}en.prototype._adjustOrthographicFrustum=function(e){this.frustum instanceof rn&&(!e&&this._positionCartographic.height<15e4||(this.frustum.width=ige(this)))};var wD=new h,$4=new M,Jat=new M,ej=new Fe,tj=new $,oge=new he;function Qat(e,t,n){let i=M.clone(e.transform,$4),o=Wt.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,Jat);e._setTransform(o),h.clone(h.ZERO,e.position),n.heading=n.heading-P.PI_OVER_TWO;let r=Fe.fromHeadingPitchRoll(n,ej),s=$.fromQuaternion(r,tj);$.getColumn(s,0,e.direction),$.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(i),e._adjustOrthographicFrustum(!0)}function jat(e,t,n,i){let o=M.clone(e.transform,$4);if(e._setTransform(M.IDENTITY),!h.equals(t,e.positionWC)){if(i){let a=e._projection,c=a.ellipsoid.cartesianToCartographic(t,oge);t=a.project(c,wD)}h.clone(t,e.position)}n.heading=n.heading-P.PI_OVER_TWO;let r=Fe.fromHeadingPitchRoll(n,ej),s=$.fromQuaternion(r,tj);$.getColumn(s,0,e.direction),$.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(o),e._adjustOrthographicFrustum(!0)}function qat(e,t,n,i){let o=M.clone(e.transform,$4);if(e._setTransform(M.IDENTITY),!h.equals(t,e.positionWC)){if(i){let c=e._projection,d=c.ellipsoid.cartesianToCartographic(t,oge);t=c.project(d,wD)}D.clone(t,e.position);let r=-t.z*.5,s=-r,a=e.frustum;if(s>r){let c=a.top/a.right;a.right=s,a.left=r,a.top=a.right*c,a.bottom=-a.top}}if(e._scene.mapMode2D===Jl.ROTATE){n.heading=n.heading-P.PI_OVER_TWO,n.pitch=-P.PI_OVER_TWO,n.roll=0;let r=Fe.fromHeadingPitchRoll(n,ej),s=$.fromQuaternion(r,tj);$.getColumn(s,2,e.up),h.cross(e.direction,e.up,e.right)}e._setTransform(o)}var $at=new h,ect=new h,tct=new h;function rge(e,t,n,i){let o=h.clone(n.direction,$at),r=h.clone(n.up,ect);if(e._scene.mode===ie.SCENE3D){let a=e._projection.ellipsoid,c=Wt.eastNorthUpToFixedFrame(t,a,PD),d=M.inverseTransformation(c,vD);M.multiplyByPointAsVector(d,o,o),M.multiplyByPointAsVector(d,r,r)}let s=h.cross(o,r,tct);return i.heading=ege(o,r),i.pitch=tge(o),i.roll=nge(o,r,s),i}var q4={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},kV=new ja;en.prototype.setView=function(e){e=g(e,g.EMPTY_OBJECT);let t=g(e.orientation,g.EMPTY_OBJECT),n=this._mode;if(n===ie.MORPHING)return;l(e.endTransform)&&this._setTransform(e.endTransform);let i=g(e.convert,!0),o=g(e.destination,h.clone(this.positionWC,wD));l(o)&&l(o.west)&&(o=this.getRectangleCameraCoordinates(o,wD),i=!1),l(t.direction)&&(t=rge(this,o,t,q4.orientation)),kV.heading=g(t.heading,0),kV.pitch=g(t.pitch,-P.PI_OVER_TWO),kV.roll=g(t.roll,0),n===ie.SCENE3D?Qat(this,o,kV):n===ie.SCENE2D?qat(this,o,kV,i):jat(this,o,kV,i)};var nct=new h;en.prototype.flyHome=function(e){let t=this._mode;if(t===ie.MORPHING&&this._scene.completeMorph(),t===ie.SCENE2D)this.flyTo({destination:en.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:M.IDENTITY});else if(t===ie.SCENE3D){let n=this.getRectangleCameraCoordinates(en.DEFAULT_VIEW_RECTANGLE),i=h.magnitude(n);i+=i*en.DEFAULT_VIEW_FACTOR,h.normalize(n,n),h.multiplyByScalar(n,i,n),this.flyTo({destination:n,duration:e,endTransform:M.IDENTITY})}else if(t===ie.COLUMBUS_VIEW){let n=this._projection.ellipsoid.maximumRadius,i=new h(0,-1,1);i=h.multiplyByScalar(h.normalize(i,i),5*n,i),this.flyTo({destination:i,duration:e,orientation:{heading:0,pitch:-Math.acos(h.normalize(i,nct).z),roll:0},endTransform:M.IDENTITY,convert:!1})}};en.prototype.worldToCameraCoordinates=function(e,t){return l(t)||(t=new se),Sc(this),M.multiplyByVector(this._actualInvTransform,e,t)};en.prototype.worldToCameraCoordinatesPoint=function(e,t){return l(t)||(t=new h),Sc(this),M.multiplyByPoint(this._actualInvTransform,e,t)};en.prototype.worldToCameraCoordinatesVector=function(e,t){return l(t)||(t=new h),Sc(this),M.multiplyByPointAsVector(this._actualInvTransform,e,t)};en.prototype.cameraToWorldCoordinates=function(e,t){return l(t)||(t=new se),Sc(this),M.multiplyByVector(this._actualTransform,e,t)};en.prototype.cameraToWorldCoordinatesPoint=function(e,t){return l(t)||(t=new h),Sc(this),M.multiplyByPoint(this._actualTransform,e,t)};en.prototype.cameraToWorldCoordinatesVector=function(e,t){return l(t)||(t=new h),Sc(this),M.multiplyByPointAsVector(this._actualTransform,e,t)};function sge(e,t){let n=e._scene.mapMode2D===Jl.ROTATE,i=e._maxCoord.x,o=e._maxCoord.y,r,s;n?(s=i,r=-s):(s=t.x-i*2,r=t.x+i*2),t.x>i&&(t.x=s),t.x<-i&&(t.x=r),t.y>o&&(t.y=o),t.y<-o&&(t.y=-o)}var zye=new h;en.prototype.move=function(e,t){let n=this.position;h.multiplyByScalar(e,t,zye),h.add(n,zye,n),this._mode===ie.SCENE2D&&sge(this,n),this._adjustOrthographicFrustum(!0)};en.prototype.moveForward=function(e){e=g(e,this.defaultMoveAmount),this._mode===ie.SCENE2D?FD(this,e):this.move(this.direction,e)};en.prototype.moveBackward=function(e){e=g(e,this.defaultMoveAmount),this._mode===ie.SCENE2D?FD(this,-e):this.move(this.direction,-e)};en.prototype.moveUp=function(e){e=g(e,this.defaultMoveAmount),this.move(this.up,e)};en.prototype.moveDown=function(e){e=g(e,this.defaultMoveAmount),this.move(this.up,-e)};en.prototype.moveRight=function(e){e=g(e,this.defaultMoveAmount),this.move(this.right,e)};en.prototype.moveLeft=function(e){e=g(e,this.defaultMoveAmount),this.move(this.right,-e)};en.prototype.lookLeft=function(e){e=g(e,this.defaultLookAmount),this._mode!==ie.SCENE2D&&this.look(this.up,-e)};en.prototype.lookRight=function(e){e=g(e,this.defaultLookAmount),this._mode!==ie.SCENE2D&&this.look(this.up,e)};en.prototype.lookUp=function(e){e=g(e,this.defaultLookAmount),this._mode!==ie.SCENE2D&&this.look(this.right,-e)};en.prototype.lookDown=function(e){e=g(e,this.defaultLookAmount),this._mode!==ie.SCENE2D&&this.look(this.right,e)};var ict=new Fe,oct=new $;en.prototype.look=function(e,t){let n=g(t,this.defaultLookAmount),i=Fe.fromAxisAngle(e,-n,ict),o=$.fromQuaternion(i,oct),r=this.direction,s=this.up,a=this.right;$.multiplyByVector(o,r,r),$.multiplyByVector(o,s,s),$.multiplyByVector(o,a,a)};en.prototype.twistLeft=function(e){e=g(e,this.defaultLookAmount),this.look(this.direction,e)};en.prototype.twistRight=function(e){e=g(e,this.defaultLookAmount),this.look(this.direction,-e)};var rct=new Fe,sct=new $;en.prototype.rotate=function(e,t){let n=g(t,this.defaultRotateAmount),i=Fe.fromAxisAngle(e,-n,rct),o=$.fromQuaternion(i,sct);$.multiplyByVector(o,this.position,this.position),$.multiplyByVector(o,this.direction,this.direction),$.multiplyByVector(o,this.up,this.up),h.cross(this.direction,this.up,this.right),h.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)};en.prototype.rotateDown=function(e){e=g(e,this.defaultRotateAmount),age(this,e)};en.prototype.rotateUp=function(e){e=g(e,this.defaultRotateAmount),age(this,-e)};var act=new h,cct=new h,lct=new h,Hye=new h;function age(e,t){let n=e.position;if(l(e.constrainedAxis)&&!h.equalsEpsilon(e.position,h.ZERO,P.EPSILON2)){let i=h.normalize(n,act),o=h.equalsEpsilon(i,e.constrainedAxis,P.EPSILON2),r=h.equalsEpsilon(i,h.negate(e.constrainedAxis,Hye),P.EPSILON2);if(!o&&!r){let s=h.normalize(e.constrainedAxis,cct),a=h.dot(i,s),c=P.acosClamped(a);t>0&&t>c&&(t=c-P.EPSILON4),a=h.dot(i,h.negate(s,Hye)),c=P.acosClamped(a),t<0&&-t>c&&(t=-c+P.EPSILON4);let d=h.cross(s,i,lct);e.rotate(d,t)}else(o&&t<0||r&&t>0)&&e.rotate(e.right,t)}else e.rotate(e.right,t)}en.prototype.rotateRight=function(e){e=g(e,this.defaultRotateAmount),cge(this,-e)};en.prototype.rotateLeft=function(e){e=g(e,this.defaultRotateAmount),cge(this,e)};function cge(e,t){l(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function FD(e,t){let n=e.frustum,i;if(t=t*.5,Math.abs(n.top)+Math.abs(n.bottom)>Math.abs(n.left)+Math.abs(n.right)){let o=n.top-t,r=n.bottom+t,s=e._maxCoord.y;e._scene.mapMode2D===Jl.ROTATE&&(s*=e.maximumZoomFactor),r>s&&(r=s,o=-s),o<=r&&(o=1,r=-1),i=n.right/n.top,n.top=o,n.bottom=r,n.right=n.top*i,n.left=-n.right}else{let o=n.right-t,r=n.left+t,s=e._maxCoord.x;e._scene.mapMode2D===Jl.ROTATE&&(s*=e.maximumZoomFactor),o>s&&(o=s,r=-s),o<=r&&(o=1,r=-1),i=n.top/n.right,n.right=o,n.left=r,n.top=n.right*i,n.bottom=-n.top}}function lge(e,t){e.move(e.direction,t)}en.prototype.zoomIn=function(e){e=g(e,this.defaultZoomAmount),this._mode===ie.SCENE2D?FD(this,e):lge(this,e)};en.prototype.zoomOut=function(e){e=g(e,this.defaultZoomAmount),this._mode===ie.SCENE2D?FD(this,-e):lge(this,-e)};en.prototype.getMagnitude=function(){if(this._mode===ie.SCENE3D)return h.magnitude(this.position);if(this._mode===ie.COLUMBUS_VIEW)return Math.abs(this.position.z);if(this._mode===ie.SCENE2D)return Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom)};var dct=new M;en.prototype.lookAt=function(e,t){let n=Wt.eastNorthUpToFixedFrame(e,oe.WGS84,dct);this.lookAtTransform(n,t)};var uct=new h,mct=new Fe,hct=new Fe,fct=new $;function dge(e,t,n){t=P.clamp(t,-P.PI_OVER_TWO,P.PI_OVER_TWO),e=P.zeroToTwoPi(e)-P.PI_OVER_TWO;let i=Fe.fromAxisAngle(h.UNIT_Y,-t,mct),o=Fe.fromAxisAngle(h.UNIT_Z,-e,hct),r=Fe.multiply(o,i,o),s=$.fromQuaternion(r,fct),a=h.clone(h.UNIT_X,uct);return $.multiplyByVector(s,a,a),h.negate(a,a),h.multiplyByScalar(a,n,a),a}en.prototype.lookAtTransform=function(e,t){if(this._setTransform(e),!l(t))return;let n;if(l(t.heading)?n=dge(t.heading,t.pitch,t.range):n=t,this._mode===ie.SCENE2D){D.clone(D.ZERO,this.position),h.negate(n,this.up),this.up.z=0,h.magnitudeSquared(this.up)<P.EPSILON10&&h.clone(h.UNIT_Y,this.up),h.normalize(this.up,this.up),this._setTransform(M.IDENTITY),h.negate(h.UNIT_Z,this.direction),h.cross(this.direction,this.up,this.right),h.normalize(this.right,this.right);let i=this.frustum,o=i.top/i.right;i.right=h.magnitude(n)*.5,i.left=-i.right,i.top=o*i.right,i.bottom=-i.top,this._setTransform(e);return}h.clone(n,this.position),h.negate(this.position,this.direction),h.normalize(this.direction,this.direction),h.cross(this.direction,h.UNIT_Z,this.right),h.magnitudeSquared(this.right)<P.EPSILON10&&h.clone(h.UNIT_X,this.right),h.normalize(this.right,this.right),h.cross(this.right,this.direction,this.up),h.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)};var Ww=new he,pct=new he,bct=new h,yct=new h,gct=new h,xct=new h,_ct=new h,Tct=new h,Sct=new h,J4=new h,Cct={direction:new h,right:new h,up:new h},Kye;function Tc(e,t,n,i){return Math.abs(h.dot(t,n))/i-h.dot(e,n)}function uge(e,t,n,i){let o=e._projection.ellipsoid,r=i?e:Cct,s=t.north,a=t.south,c=t.east,d=t.west;d>c&&(c+=P.TWO_PI);let u=(d+c)*.5,m;if(a<-P.PI_OVER_TWO+P.RADIANS_PER_DEGREE&&s>P.PI_OVER_TWO-P.RADIANS_PER_DEGREE)m=0;else{let F=Ww;F.longitude=u,F.latitude=s,F.height=0;let A=pct;A.longitude=u,A.latitude=a,A.height=0;let y=Kye;(!l(y)||y.ellipsoid!==o)&&(Kye=y=new Cp(void 0,void 0,o)),y.setEndPoints(F,A),m=y.interpolateUsingFraction(.5,Ww).latitude}let p=Ww;p.longitude=u,p.latitude=m,p.height=0;let b=o.cartographicToCartesian(p,Sct),f=Ww;f.longitude=c,f.latitude=s;let x=o.cartographicToCartesian(f,bct);f.longitude=d;let _=o.cartographicToCartesian(f,gct);f.longitude=u;let C=o.cartographicToCartesian(f,_ct);f.latitude=a;let V=o.cartographicToCartesian(f,Tct);f.longitude=c;let L=o.cartographicToCartesian(f,xct);f.longitude=d;let R=o.cartographicToCartesian(f,yct);h.subtract(_,b,_),h.subtract(L,b,L),h.subtract(x,b,x),h.subtract(R,b,R),h.subtract(C,b,C),h.subtract(V,b,V);let G=o.geodeticSurfaceNormal(b,r.direction);h.negate(G,G);let X=h.cross(G,h.UNIT_Z,r.right);h.normalize(X,X);let v=h.cross(X,G,r.up),W;if(e.frustum instanceof rn){let F=Math.max(h.distance(x,_),h.distance(L,R)),A=Math.max(h.distance(x,L),h.distance(_,R)),y,Z,E=e.frustum.projectionMatrix,I=e.frustum._offCenterFrustum,w=I.right/I.top,k=A*w;F>k?(y=F,Z=y/w):(Z=A,y=k),W=Math.max(y,Z)}else{let F=Math.tan(e.frustum.fovy*.5),A=e.frustum.aspectRatio*F;if(W=Math.max(Tc(G,v,_,F),Tc(G,v,L,F),Tc(G,v,x,F),Tc(G,v,R,F),Tc(G,v,C,F),Tc(G,v,V,F),Tc(G,X,_,A),Tc(G,X,L,A),Tc(G,X,x,A),Tc(G,X,R,A),Tc(G,X,C,A),Tc(G,X,V,A)),a<0&&s>0){let y=Ww;y.longitude=d,y.latitude=0,y.height=0;let Z=o.cartographicToCartesian(y,J4);h.subtract(Z,b,Z),W=Math.max(W,Tc(G,v,Z,F),Tc(G,X,Z,A)),y.longitude=c,Z=o.cartographicToCartesian(y,J4),h.subtract(Z,b,Z),W=Math.max(W,Tc(G,v,Z,F),Tc(G,X,Z,A))}}return h.add(b,h.multiplyByScalar(G,-W,J4),n)}var Vct=new he,Lct=new h,Zct=new h;function Rct(e,t,n){let i=e._projection;t.west>t.east&&(t=le.MAX_VALUE);let o=e._actualTransform,r=e._actualInvTransform,s=Vct;s.longitude=t.east,s.latitude=t.north;let a=i.project(s,Lct);M.multiplyByPoint(o,a,a),M.multiplyByPoint(r,a,a),s.longitude=t.west,s.latitude=t.south;let c=i.project(s,Zct);if(M.multiplyByPoint(o,c,c),M.multiplyByPoint(r,c,c),n.x=(a.x-c.x)*.5+c.x,n.y=(a.y-c.y)*.5+c.y,l(e.frustum.fovy)){let d=Math.tan(e.frustum.fovy*.5),u=e.frustum.aspectRatio*d;n.z=Math.max((a.x-c.x)/u,(a.y-c.y)/d)*.5}else{let d=a.x-c.x,u=a.y-c.y;n.z=Math.max(d,u)}return n}var Gct=new he,Ect=new h,Xct=new h;function Ict(e,t,n){let i=e._projection,o=t.east;t.west>t.east&&(e._scene.mapMode2D===Jl.INFINITE_SCROLL?o+=P.TWO_PI:(t=le.MAX_VALUE,o=t.east));let r=Gct;r.longitude=o,r.latitude=t.north;let s=i.project(r,Ect);r.longitude=t.west,r.latitude=t.south;let a=i.project(r,Xct),c=Math.abs(s.x-a.x)*.5,d=Math.abs(s.y-a.y)*.5,u,m,p=e.frustum.right/e.frustum.top,b=d*p;return c>b?(u=c,m=u/p):(m=d,u=b),d=Math.max(2*u,2*m),n.x=(s.x-a.x)*.5+a.x,n.y=(s.y-a.y)*.5+a.y,r=i.unproject(n,r),r.height=d,n=i.project(r,n),n}en.prototype.getRectangleCameraCoordinates=function(e,t){let n=this._mode;if(l(t)||(t=new h),n===ie.SCENE3D)return uge(this,e,t);if(n===ie.COLUMBUS_VIEW)return Rct(this,e,t);if(n===ie.SCENE2D)return Ict(this,e,t)};var Wct=new bn;function Pct(e,t,n,i){n=g(n,oe.WGS84);let o=e.getPickRay(t,Wct),r=jn.rayEllipsoid(o,n);if(!r)return;let s=r.start>0?r.start:r.stop;return bn.getPoint(o,s,i)}var vct=new bn;function wct(e,t,n,i){let r=e.getPickRay(t,vct).origin;r=h.fromElements(r.y,r.z,0,r);let s=n.unproject(r);if(!(s.latitude<-P.PI_OVER_TWO||s.latitude>P.PI_OVER_TWO))return n.ellipsoid.cartographicToCartesian(s,i)}var Fct=new bn;function Act(e,t,n,i){let o=e.getPickRay(t,Fct),r=-o.origin.x/o.direction.x;bn.getPoint(o,r,i);let s=n.unproject(new h(i.y,i.z,0));if(!(s.latitude<-P.PI_OVER_TWO||s.latitude>P.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return n.ellipsoid.cartographicToCartesian(s,i)}en.prototype.pickEllipsoid=function(e,t,n){let i=this._scene.canvas;if(!(i.clientWidth===0||i.clientHeight===0)){if(l(n)||(n=new h),t=g(t,oe.WGS84),this._mode===ie.SCENE3D)n=Pct(this,e,t,n);else if(this._mode===ie.SCENE2D)n=wct(this,e,this._projection,n);else if(this._mode===ie.COLUMBUS_VIEW)n=Act(this,e,this._projection,n);else return;return n}};var Mct=new h,Nct=new h,kct=new h;function Uct(e,t,n){let i=e._scene.canvas,o=i.clientWidth,r=i.clientHeight,s=Math.tan(e.frustum.fovy*.5),a=e.frustum.aspectRatio*s,c=e.frustum.near,d=2/o*t.x-1,u=2/r*(r-t.y)-1,m=e.positionWC;h.clone(m,n.origin);let p=h.multiplyByScalar(e.directionWC,c,Mct);h.add(m,p,p);let b=h.multiplyByScalar(e.rightWC,d*c*a,Nct),f=h.multiplyByScalar(e.upWC,u*c*s,kct),x=h.add(p,b,n.direction);return h.add(x,f,x),h.subtract(x,m,x),h.normalize(x,x),n}var ID=new h;function Dct(e,t,n){let i=e._scene.canvas,o=i.clientWidth,r=i.clientHeight,s=e.frustum,a=s.offCenterFrustum;l(a)&&(s=a);let c=2/o*t.x-1;c*=(s.right-s.left)*.5;let d=2/r*(r-t.y)-1;d*=(s.top-s.bottom)*.5;let u=n.origin;return h.clone(e.position,u),h.multiplyByScalar(e.right,c,ID),h.add(ID,u,u),h.multiplyByScalar(e.up,d,ID),h.add(ID,u,u),h.clone(e.directionWC,n.direction),(e._mode===ie.COLUMBUS_VIEW||e._mode===ie.SCENE2D)&&h.fromElements(n.origin.z,n.origin.x,n.origin.y,n.origin),n}en.prototype.getPickRay=function(e,t){l(t)||(t=new bn);let n=this._scene.canvas;if(n.clientWidth<=0||n.clientHeight<=0)return;let i=this.frustum;return l(i.aspectRatio)&&l(i.fov)&&l(i.near)?Uct(this,e,t):Dct(this,e,t)};var Bct=new h,Yct=new h;en.prototype.distanceToBoundingSphere=function(e){let t=h.subtract(this.positionWC,e.center,Bct),n=h.multiplyByScalar(this.directionWC,h.dot(t,this.directionWC),Yct);return Math.max(0,h.magnitude(n)-e.radius)};var Oct=new D;en.prototype.getPixelSize=function(e,t,n){let i=this.distanceToBoundingSphere(e),o=this.frustum.getPixelDimensions(t,n,i,this._scene.pixelRatio,Oct);return Math.max(o.x,o.y)};function zct(e,t,n,i,o,r){let s=h.clone(t);n.y>i?s.y-=n.y-i:n.y<-i&&(s.y+=-i-n.y),n.z>o?s.z-=n.z-o:n.z<-o&&(s.z+=-o-n.z);function a(c){let d=h.lerp(t,s,c.time,new h);e.worldToCameraCoordinatesPoint(d,e.position)}return{easingFunction:Ar.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:r,update:a}}var Hct=new h,Jye=new h,Kct=new h,Jct=new h;function Qct(e,t){let n=e.position,i=e.direction,o=e.worldToCameraCoordinatesVector(h.UNIT_X,Hct),r=-h.dot(o,n)/h.dot(o,i),s=h.add(n,h.multiplyByScalar(i,r,Jye),Jye);e.cameraToWorldCoordinatesPoint(s,s),n=e.cameraToWorldCoordinatesPoint(e.position,Kct);let a=Math.tan(e.frustum.fovy*.5),c=e.frustum.aspectRatio*a,d=h.magnitude(h.subtract(n,s,Jct)),u=c*d,m=a*d,p=e._maxCoord.x,b=e._maxCoord.y,f=Math.max(u-p,p),x=Math.max(m-b,b);if(n.z<-f||n.z>f||n.y<-x||n.y>x){let _=s.y<-f||s.y>f,C=s.z<-x||s.z>x;if(_||C)return zct(e,n,s,f,x,t)}}en.prototype.createCorrectPositionTween=function(e){if(this._mode===ie.COLUMBUS_VIEW)return Qct(this,e)};var jct=new h,Ks={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};en.prototype.cancelFlight=function(){l(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)};en.prototype.completeFlight=function(){if(l(this._currentFlight)){this._currentFlight.cancelTween();let e={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};e.destination=Ks.destination,e.orientation.heading=Ks.heading,e.orientation.pitch=Ks.pitch,e.orientation.roll=Ks.roll,this.setView(e),l(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}};en.prototype.flyTo=function(e){e=g(e,g.EMPTY_OBJECT);let t=e.destination;if(this._mode===ie.MORPHING)return;this.cancelFlight();let i=t instanceof le;i&&(t=this.getRectangleCameraCoordinates(t,jct));let o=g(e.orientation,g.EMPTY_OBJECT);if(l(o.direction)&&(o=rge(this,t,o,q4.orientation)),l(e.duration)&&e.duration<=0){let u=q4;u.destination=e.destination,u.orientation.heading=o.heading,u.orientation.pitch=o.pitch,u.orientation.roll=o.roll,u.convert=e.convert,u.endTransform=e.endTransform,this.setView(u),typeof e.complete==\"function\"&&e.complete();return}let r=this,s;Ks.destination=t,Ks.heading=o.heading,Ks.pitch=o.pitch,Ks.roll=o.roll,Ks.duration=e.duration,Ks.complete=function(){s===r._currentFlight&&(r._currentFlight=void 0),l(e.complete)&&e.complete()},Ks.cancel=e.cancel,Ks.endTransform=e.endTransform,Ks.convert=i?!1:e.convert,Ks.maximumHeight=e.maximumHeight,Ks.pitchAdjustHeight=e.pitchAdjustHeight,Ks.flyOverLongitude=e.flyOverLongitude,Ks.flyOverLongitudeWeight=e.flyOverLongitudeWeight,Ks.easingFunction=e.easingFunction;let a=this._scene,c=Iw.createTween(a,Ks);if(c.duration===0){typeof c.complete==\"function\"&&c.complete();return}s=a.tweens.add(c),this._currentFlight=s;let d=this._scene.preloadFlightCamera;this._mode!==ie.SCENE2D&&(l(d)||(d=en.clone(this)),d.setView({destination:t,orientation:o}),this._scene.preloadFlightCullingVolume=d.frustum.computeCullingVolume(d.positionWC,d.directionWC,d.upWC))};function qct(e,t){let n=e.frustum,i=Math.tan(n.fovy*.5),o=n.aspectRatio*i;return Math.max(t/o,t/i)}function $ct(e,t){let n=e.frustum,i=n.offCenterFrustum;l(i)&&(n=i);let o,r,s=n.right/n.top,a=t*s;return t>a?(o=t,r=o/s):(r=t,o=a),Math.max(o,r)*1.5}var elt=100;function mge(e,t,n){n=Ou.clone(l(n)?n:en.DEFAULT_OFFSET);let i=e._scene.screenSpaceCameraController.minimumZoomDistance,o=e._scene.screenSpaceCameraController.maximumZoomDistance,r=n.range;if(!l(r)||r===0){let s=t.radius;s===0?n.range=elt:e.frustum instanceof rn||e._mode===ie.SCENE2D?n.range=$ct(e,s):n.range=qct(e,s),n.range=P.clamp(n.range,i,o)}return n}en.prototype.viewBoundingSphere=function(e,t){t=mge(this,e,t),this.lookAt(e.center,t)};var tlt=new M,nlt=new h,ilt=new h,olt=new h,rlt=new h,slt=new se,alt=new Fe,clt=new $;en.prototype.flyToBoundingSphere=function(e,t){t=g(t,g.EMPTY_OBJECT);let n=this._mode===ie.SCENE2D||this._mode===ie.COLUMBUS_VIEW;this._setTransform(M.IDENTITY);let i=mge(this,e,t.offset),o;n?o=h.multiplyByScalar(h.UNIT_Z,i.range,nlt):o=dge(i.heading,i.pitch,i.range);let r=Wt.eastNorthUpToFixedFrame(e.center,oe.WGS84,tlt);M.multiplyByPoint(r,o,o);let s,a;if(!n){if(s=h.subtract(e.center,o,ilt),h.normalize(s,s),a=M.multiplyByPointAsVector(r,h.UNIT_Z,olt),1-Math.abs(h.dot(s,a))<P.EPSILON6){let d=Fe.fromAxisAngle(s,i.heading,alt),u=$.fromQuaternion(d,clt);h.fromCartesian4(M.getColumn(r,1,slt),a),$.multiplyByVector(u,a,a)}let c=h.cross(s,a,rlt);h.cross(c,s,a),h.normalize(a,a)}this.flyTo({destination:o,orientation:{direction:s,up:a},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Qye=new h,jye=new h,Q4=new h,qye=new h,Pw=[new h,new h,new h,new h];function llt(e,t){let n=t.radii,i=e.positionWC,o=h.multiplyComponents(t.oneOverRadii,i,Qye),r=h.magnitude(o),s=h.normalize(o,jye),a,c;h.equalsEpsilon(s,h.UNIT_Z,P.EPSILON10)?(a=new h(0,1,0),c=new h(0,0,1)):(a=h.normalize(h.cross(h.UNIT_Z,s,Q4),Q4),c=h.normalize(h.cross(s,a,qye),qye));let d=Math.sqrt(h.magnitudeSquared(o)-1),u=h.multiplyByScalar(s,1/r,Qye),m=d/r,p=h.multiplyByScalar(a,m,jye),b=h.multiplyByScalar(c,m,Q4),f=h.add(u,b,Pw[0]);h.subtract(f,p,f),h.multiplyComponents(n,f,f);let x=h.subtract(u,b,Pw[1]);h.subtract(x,p,x),h.multiplyComponents(n,x,x);let _=h.subtract(u,b,Pw[2]);h.add(_,p,_),h.multiplyComponents(n,_,_);let C=h.add(u,b,Pw[3]);return h.add(C,p,C),h.multiplyComponents(n,C,C),Pw}var j4=new D,dlt=new h,bg=[new he,new he,new he,new he];function WD(e,t,n,i,o,r){j4.x=e,j4.y=t;let s=i.pickEllipsoid(j4,o,dlt);return l(s)?(bg[n]=o.cartesianToCartographic(s,bg[n]),1):(bg[n]=o.cartesianToCartographic(r[n],bg[n]),0)}en.prototype.computeViewRectangle=function(e,t){e=g(e,oe.WGS84);let n=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),i=new ce(h.ZERO,e.maximumRadius);if(n.computeVisibility(i)===nn.OUTSIDE)return;let r=this._scene.canvas,s=r.clientWidth,a=r.clientHeight,c=0,d=llt(this,e);if(c+=WD(0,0,0,this,e,d),c+=WD(0,a,1,this,e,d),c+=WD(s,a,2,this,e,d),c+=WD(s,0,3,this,e,d),c<2)return le.MAX_VALUE;t=le.fromCartographicArray(bg,t);let u=0,m=bg[3].longitude;for(let p=0;p<4;++p){let b=bg[p].longitude,f=Math.abs(b-m);f>P.PI?u+=P.TWO_PI-f:u+=f,m=b}return P.equalsEpsilon(Math.abs(u),P.TWO_PI,P.EPSILON9)&&(t.west=-P.PI,t.east=P.PI,bg[0].latitude>=0?t.north=P.PI_OVER_TWO:t.south=-P.PI_OVER_TWO),t};en.prototype.switchToPerspectiveFrustum=function(){if(this._mode===ie.SCENE2D||this.frustum instanceof _i)return;let e=this._scene;this.frustum=new _i,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=P.toRadians(60)};en.prototype.switchToOrthographicFrustum=function(){if(this._mode===ie.SCENE2D||this.frustum instanceof rn)return;let e=ige(this),t=this._scene;this.frustum=new rn,this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.width=e};en.clone=function(e,t){return l(t)||(t=new en(e._scene)),h.clone(e.position,t.position),h.clone(e.direction,t.direction),h.clone(e.up,t.up),h.clone(e.right,t.right),M.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t};var lo=en;var IRi=T(S(),1);function ult(e){this.pass=e.pass,this.commandList=e.commandList,this.camera=e.camera,this.cullingVolume=e.cullingVolume,this.ready=!1}var em=ult;var NRi=T(S(),1);var yge=T(td(),1),hge=576,mlt=100,vw=\"#ffffff\",nj=\"#48b\";function gge(e,t){this.credit=e,this.count=g(t,1)}function hlt(e,t){let n=e.length;for(let i=0;i<n;i++){let o=e[i];if(Zt.equals(o,t))return!0}return!1}function flt(e){let t=e._previousCesiumCredit,n=e._currentCesiumCredit;Zt.equals(n,t)||(l(t)&&e._cesiumCreditContainer.removeChild(t.element),l(n)&&e._cesiumCreditContainer.appendChild(n.element),e._previousCesiumCredit=n)}var xge=\"cesium-credit-delimiter\";function fge(e){let t=document.createElement(\"span\");return t.textContent=e,t.className=xge,t}function pge(e,t){if(l(t)){let n=document.createElement(t);n._creditId=e._creditId,n.appendChild(e),e=n}return e}function bge(e,t,n,i){let o=e.childNodes,r=-1;t.sort(function(s,a){return a.count-s.count});for(let s=0;s<t.length;++s){let a=t[s].credit;if(l(a)){if(r=s,l(n)&&(r*=2,s>0)){let d=r-1;if(o.length<=d)e.appendChild(fge(n));else{let u=o[d];u.className!==xge&&e.replaceChild(fge(n),u)}}let c=a.element;if(o.length<=r)e.appendChild(pge(c,i));else{let d=o[r];d._creditId!==a._id&&e.replaceChild(pge(c,i),d)}}}for(++r;r<o.length;)e.removeChild(o[r])}function plt(e){let t=e._lightboxCredits,n=e.viewport.clientWidth,i=e.viewport.clientHeight;n!==e._lastViewportWidth&&(n<hge?(t.className=\"cesium-credit-lightbox cesium-credit-lightbox-mobile\",t.style.marginTop=\"0\"):(t.className=\"cesium-credit-lightbox cesium-credit-lightbox-expanded\",t.style.marginTop=`${Math.floor((i-t.clientHeight)*.5)}px`),e._lastViewportWidth=n),n>=hge&&i!==e._lastViewportHeight&&(t.style.marginTop=`${Math.floor((i-t.clientHeight)*.5)}px`,e._lastViewportHeight=i)}function Cc(e,t){let n=`${e} {`;for(let i in t)t.hasOwnProperty(i)&&(n+=`${i}: ${t[i]}; `);return n+=` } `,n}function blt(e){let t=\"\";t+=Cc(\".cesium-credit-lightbox-overlay\",{display:\"none\",\"z-index\":\"1\",position:\"absolute\",top:\"0\",left:\"0\",width:\"100%\",height:\"100%\",\"background-color\":\"rgba(80, 80, 80, 0.8)\"}),t+=Cc(\".cesium-credit-lightbox\",{\"background-color\":\"#303336\",color:vw,position:\"relative\",\"min-height\":`${mlt}px`,margin:\"auto\"}),t+=Cc(\".cesium-credit-lightbox > ul > li a, .cesium-credit-lightbox > ul > li a:visited\",{color:vw}),t+=Cc(\".cesium-credit-lightbox > ul > li a:hover\",{color:nj}),t+=Cc(\".cesium-credit-lightbox.cesium-credit-lightbox-expanded\",{border:\"1px solid #444\",\"border-radius\":\"5px\",\"max-width\":\"370px\"}),t+=Cc(\".cesium-credit-lightbox.cesium-credit-lightbox-mobile\",{height:\"100%\",width:\"100%\"}),t+=Cc(\".cesium-credit-lightbox-title\",{padding:\"20px 20px 0 20px\"}),t+=Cc(\".cesium-credit-lightbox-close\",{\"font-size\":\"18pt\",cursor:\"pointer\",position:\"absolute\",top:\"0\",right:\"6px\",color:vw}),t+=Cc(\".cesium-credit-lightbox-close:hover\",{color:nj}),t+=Cc(\".cesium-credit-lightbox > ul\",{margin:\"0\",padding:\"12px 20px 12px 40px\",\"font-size\":\"13px\"}),t+=Cc(\".cesium-credit-lightbox > ul > li\",{\"padding-bottom\":\"6px\"}),t+=Cc(\".cesium-credit-lightbox > ul > li *\",{padding:\"0\",margin:\"0\"}),t+=Cc(\".cesium-credit-expand-link\",{\"padding-left\":\"5px\",cursor:\"pointer\",\"text-decoration\":\"underline\",color:vw}),t+=Cc(\".cesium-credit-expand-link:hover\",{color:nj}),t+=Cc(\".cesium-credit-text\",{color:vw}),t+=Cc(\".cesium-credit-textContainer *, .cesium-credit-logoContainer *\",{display:\"inline\"});function n(r){if(r.shadowRoot)return r.shadowRoot;if(r.getRootNode){let s=r.getRootNode();if(s instanceof ShadowRoot)return s}}let i=g(n(e),document.head),o=document.createElement(\"style\");o.innerHTML=t,i.appendChild(o)}function dr(e,t,n){let i=this;n=g(n,document.body);let o=document.createElement(\"div\");o.className=\"cesium-credit-lightbox-overlay\",n.appendChild(o);let r=document.createElement(\"div\");r.className=\"cesium-credit-lightbox\",o.appendChild(r);function s(f){r.contains(f.target)||i.hideLightbox()}o.addEventListener(\"click\",s,!1);let a=document.createElement(\"div\");a.className=\"cesium-credit-lightbox-title\",a.textContent=\"Data provided by:\",r.appendChild(a);let c=document.createElement(\"a\");c.onclick=this.hideLightbox.bind(this),c.innerHTML=\"&times;\",c.className=\"cesium-credit-lightbox-close\",r.appendChild(c);let d=document.createElement(\"ul\");r.appendChild(d);let u=document.createElement(\"div\");u.className=\"cesium-credit-logoContainer\",u.style.display=\"inline\",e.appendChild(u);let m=document.createElement(\"div\");m.className=\"cesium-credit-textContainer\",m.style.display=\"inline\",e.appendChild(m);let p=document.createElement(\"a\");p.className=\"cesium-credit-expand-link\",p.onclick=this.showLightbox.bind(this),p.textContent=\"Data attribution\",e.appendChild(p),blt(e);let b=Zt.clone(dr.cesiumCredit);this._delimiter=g(t,\" \\u2022 \"),this._screenContainer=m,this._cesiumCreditContainer=u,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=r,this._creditList=d,this._lightbox=o,this._hideLightbox=s,this._expandLink=p,this._expanded=!1,this._staticCredits=[],this._cesiumCredit=b,this._previousCesiumCredit=void 0,this._currentCesiumCredit=b,this._creditDisplayElementPool=[],this._creditDisplayElementIndex=0,this._currentFrameCredits={screenCredits:new Lt,lightboxCredits:new Lt},this._defaultCredit=void 0,this.viewport=n,this.container=e}function _ge(e,t,n,i){i=g(i,1);let o=t.get(n.id);if(l(o))o.count<Number.MAX_VALUE&&(o.count+=i);else{let r=e._creditDisplayElementPool,s=e._creditDisplayElementPoolIndex;s<r.length?(o=r[s],o.credit=n,o.count=i):(o=new gge(n,i),r.push(o)),++e._creditDisplayElementPoolIndex,t.set(n.id,o)}}dr.prototype.addCreditToNextFrame=function(e){if(e.isIon()){l(this._defaultCredit)||(this._defaultCredit=Zt.clone(Tge())),this._currentCesiumCredit=this._defaultCredit;return}let t;e.showOnScreen?t=this._currentFrameCredits.screenCredits:t=this._currentFrameCredits.lightboxCredits,_ge(this,t,e)};dr.prototype.addStaticCredit=function(e){let t=this._staticCredits;hlt(t,e)||t.push(e)};dr.prototype.removeStaticCredit=function(e){let t=this._staticCredits,n=t.indexOf(e);n!==-1&&t.splice(n,1)};dr.prototype.showLightbox=function(){this._lightbox.style.display=\"block\",this._expanded=!0};dr.prototype.hideLightbox=function(){this._lightbox.style.display=\"none\",this._expanded=!1};dr.prototype.update=function(){this._expanded&&plt(this)};dr.prototype.beginFrame=function(){let e=this._currentFrameCredits;this._creditDisplayElementPoolIndex=0;let t=e.screenCredits,n=e.lightboxCredits;t.removeAll(),n.removeAll();let i=this._staticCredits;for(let o=0;o<i.length;++o){let r=i[o],s=r.showOnScreen?t:n;r.isIon()&&Zt.equals(dr.cesiumCredit,this._cesiumCredit)||_ge(this,s,r,Number.MAX_VALUE)}Zt.equals(dr.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=Zt.clone(dr.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit};dr.prototype.endFrame=function(){let e=this._currentFrameCredits.screenCredits.values;bge(this._screenContainer,e,this._delimiter,void 0);let t=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=t.length>0?\"inline\":\"none\",bge(this._creditList,t,void 0,\"li\"),flt(this)};dr.prototype.destroy=function(){return this._lightbox.removeEventListener(\"click\",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),me(this)};dr.prototype.isDestroyed=function(){return!1};dr._cesiumCredit=void 0;dr._cesiumCreditInitialized=!1;var AD;function Tge(){if(!l(AD)){let e=on(\"Assets/Images/ion-credit.png\");e.indexOf(\"http://\")!==0&&e.indexOf(\"https://\")!==0&&e.indexOf(\"data:\")!==0&&(e=new yge.default(e).path()),AD=new Zt(`<a href=\"https://cesium.com/\" target=\"_blank\"><img src=\"${e}\" title=\"Cesium ion\"/></a>`,!0)}return dr._cesiumCreditInitialized||(dr._cesiumCredit=AD,dr._cesiumCreditInitialized=!0),AD}Object.defineProperties(dr,{cesiumCredit:{get:function(){return Tge(),dr._cesiumCredit},set:function(e){dr._cesiumCredit=e,dr._cesiumCreditInitialized=!0}}});dr.CreditDisplayElement=gge;var ww=dr;var AGi=T(S(),1);var iGi=T(S(),1);var MD=0,ylt=1;function TT(e){let t=e.frustum,n=e.orientation,i=e.origin,o=g(e.vertexFormat,Pe.DEFAULT),r=g(e._drawNearPlane,!0),s,a;t instanceof _i?(s=MD,a=_i.packedLength):t instanceof rn&&(s=ylt,a=rn.packedLength),this._frustumType=s,this._frustum=t.clone(),this._origin=h.clone(i),this._orientation=Fe.clone(n),this._drawNearPlane=r,this._vertexFormat=o,this._workerName=\"createFrustumGeometry\",this.packedLength=2+a+h.packedLength+Fe.packedLength+Pe.packedLength}TT.pack=function(e,t,n){n=g(n,0);let i=e._frustumType,o=e._frustum;return t[n++]=i,i===MD?(_i.pack(o,t,n),n+=_i.packedLength):(rn.pack(o,t,n),n+=rn.packedLength),h.pack(e._origin,t,n),n+=h.packedLength,Fe.pack(e._orientation,t,n),n+=Fe.packedLength,Pe.pack(e._vertexFormat,t,n),n+=Pe.packedLength,t[n]=e._drawNearPlane?1:0,t};var glt=new _i,xlt=new rn,_lt=new Fe,Tlt=new h,Slt=new Pe;TT.unpack=function(e,t,n){t=g(t,0);let i=e[t++],o;i===MD?(o=_i.unpack(e,t,glt),t+=_i.packedLength):(o=rn.unpack(e,t,xlt),t+=rn.packedLength);let r=h.unpack(e,t,Tlt);t+=h.packedLength;let s=Fe.unpack(e,t,_lt);t+=Fe.packedLength;let a=Pe.unpack(e,t,Slt);t+=Pe.packedLength;let c=e[t]===1;if(!l(n))return new TT({frustum:o,origin:r,orientation:s,vertexFormat:a,_drawNearPlane:c});let d=i===n._frustumType?n._frustum:void 0;return n._frustum=o.clone(d),n._frustumType=i,n._origin=h.clone(r,n._origin),n._orientation=Fe.clone(s,n._orientation),n._vertexFormat=Pe.clone(a,n._vertexFormat),n._drawNearPlane=c,n};function UV(e,t,n,i,o,r,s,a){let c=e/3*2;for(let"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 182,
    "total_chunks": 194,
    "chunk_size": 28490,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.759Z"
  },
  "content": "this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),me(this)};var F7=dA;var f6i=T(S(),1);var ySe=T(_M(),1);var G7i=T(S(),1);function C_t(e,t,n){return` float clipDistance = clip(gl_FragCoord, ${e}, ${t}); vec4 clippingPlanesEdgeColor = vec4(1.0); clippingPlanesEdgeColor.rgb = ${n}.rgb; float clippingPlanesEdgeWidth = ${n}.a; if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) { out_FragColor = clippingPlanesEdgeColor; } `}var uA=C_t;var I7i=T(S(),1);var V_t={modifyFragmentShader:function(t){return t=Ue.replaceMain(t,\"czm_splitter_main\"),t+=`uniform float czm_splitDirection; void main() { #ifndef SHADOW_MAP if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; #endif czm_splitter_main(); } `,t},addUniforms:function(t,n){n.czm_splitDirection=function(){return t.splitDirection}}},_L=V_t;var dS={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function mA(e){this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=O.clone(O.DARKGRAY),this._highlightColor=O.clone(O.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=dS.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=g(e.opaquePass,Ze.OPAQUE),this._cull=g(e.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=M.clone(M.IDENTITY),this._modelMatrix=M.clone(M.IDENTITY),this.time=0,this.shadows=_n.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=g(e.splitDirection,Hc.NONE),this._splittingEnabled=!1,this._error=void 0,L_t(this,e)}Object.defineProperties(mA.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},color:{get:function(){return O.clone(this._highlightColor)},set:function(e){this._highlightColor=O.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if(l(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=ce.clone(e,this._boundingSphere)}}});function L_t(e,t){let n=m_.parse(t.arrayBuffer,t.byteOffset);if(e._parsedContent=n,e._rtcCenter=n.rtcCenter,e._hasNormals=n.hasNormals,e._hasColors=n.hasColors,e._hasBatchIds=n.hasBatchIds,e._isTranslucent=n.isTranslucent,!n.hasBatchIds&&l(n.batchTableBinary)&&(n.styleableProperties=wp.getBinaryProperties(n.pointsLength,n.batchTableJson,n.batchTableBinary)),l(n.draco)){let a=n.draco;e._decodingState=dS.NEEDS_DECODE,a.dequantizeInShader=e._dequantizeInShader}let i=n.positions;l(i)&&(e._isQuantized=i.isQuantized,e._quantizedVolumeScale=i.quantizedVolumeScale,e._quantizedVolumeOffset=i.quantizedVolumeOffset,e._quantizedRange=i.quantizedRange);let o=n.normals;l(o)&&(e._isOctEncoded16P=o.octEncoded);let r=n.colors;l(r)&&(l(r.constantColor)&&(e._constantColor=O.clone(r.constantColor,e._constantColor),e._hasColors=!1),e._isRGB565=r.isRGB565);let s=n.batchIds;l(n.batchIds)&&(s.name=\"BATCH_ID\",s.semantic=\"BATCH_ID\",s.setIndex=void 0),n.hasBatchIds&&e._batchTableLoaded(n.batchLength,n.batchTableJson,n.batchTableBinary),e._pointsLength=n.pointsLength}var Z_t=new h,R_t=new h,G_t=new h,pSe,B3;function E_t(e){if(!l(B3)){pSe=new ySe.default(0),B3=new Array(e);for(let t=0;t<e;++t)B3[t]=pSe.random()}return B3}function X_t(e){let n=e.length/3,i=Math.min(n,20),o=E_t(20),r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=h.fromElements(r,r,r,Z_t),c=h.fromElements(s,s,s,R_t);for(let u=0;u<i;++u){let m=Math.floor(o[u]*n),p=h.unpack(e,m*3,G_t);h.minimumByComponent(a,p,a),h.maximumByComponent(c,p,c)}let d=ce.fromCornerPoints(a,c);return d.radius+=P.EPSILON2,d}function bSe(e,t){let n=Q.fromTypedArray(e);return n===Q.INT||n===Q.UNSIGNED_INT||n===Q.DOUBLE?(wt(\"Cast pnts property to floats\",`Point cloud property \"${t}\" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(e)):e}var I_t=new se,W_t=new se,P_t=new O,gSe=0,Y3=1,U7=2,xSe=3,v_t=4,A7=new M,w_t=new M;function F_t(e,t){let n=t.context,i=e._parsedContent,o=e._pointsLength,r=i.positions,s=i.colors,a=i.normals,c=i.batchIds,d=i.styleableProperties,u=l(d),m=e._isQuantized,p=e._isQuantizedDraco,b=e._isOctEncoded16P,f=e._isOctEncodedDraco,x=e._quantizedRange,_=e._octEncodedRange,C=e._isRGB565,V=e._isTranslucent,L=e._hasColors,R=e._hasNormals,G=e._hasBatchIds,X,v,W=[],F={};if(e._styleableShaderAttributes=F,u){let U=v_t;for(let Y in d)if(d.hasOwnProperty(Y)){let N=d[Y],J=bSe(N.typedArray,Y);X=N.componentCount,v=Q.fromTypedArray(J);let z=pt.createVertexBuffer({context:n,typedArray:J,usage:Me.STATIC_DRAW});e._geometryByteLength+=z.sizeInBytes;let ee={index:U,vertexBuffer:z,componentsPerAttribute:X,componentDatatype:v,normalize:!1,offsetInBytes:0,strideInBytes:0};W.push(ee),F[Y]={location:U,componentCount:X},++U}}let A=pt.createVertexBuffer({context:n,typedArray:r.typedArray,usage:Me.STATIC_DRAW});e._geometryByteLength+=A.sizeInBytes;let y;L&&(y=pt.createVertexBuffer({context:n,typedArray:s.typedArray,usage:Me.STATIC_DRAW}),e._geometryByteLength+=y.sizeInBytes);let Z;R&&(Z=pt.createVertexBuffer({context:n,typedArray:a.typedArray,usage:Me.STATIC_DRAW}),e._geometryByteLength+=Z.sizeInBytes);let E;G&&(c.typedArray=bSe(c.typedArray,\"batchIds\"),E=pt.createVertexBuffer({context:n,typedArray:c.typedArray,usage:Me.STATIC_DRAW}),e._geometryByteLength+=E.sizeInBytes);let I=[];if(m?v=Q.UNSIGNED_SHORT:p?v=x<=255?Q.UNSIGNED_BYTE:Q.UNSIGNED_SHORT:v=Q.FLOAT,I.push({index:gSe,vertexBuffer:A,componentsPerAttribute:3,componentDatatype:v,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(m||p?e._boundingSphere=ce.fromCornerPoints(h.ZERO,e._quantizedVolumeScale):e._boundingSphere=X_t(r.typedArray)),L)if(C)I.push({index:Y3,vertexBuffer:y,componentsPerAttribute:1,componentDatatype:Q.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{let U=V?4:3;I.push({index:Y3,vertexBuffer:y,componentsPerAttribute:U,componentDatatype:Q.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}R&&(b?(X=2,v=Q.UNSIGNED_BYTE):f?(X=2,v=_<=255?Q.UNSIGNED_BYTE:Q.UNSIGNED_SHORT):(X=3,v=Q.FLOAT),I.push({index:U7,vertexBuffer:Z,componentsPerAttribute:X,componentDatatype:v,normalize:!1,offsetInBytes:0,strideInBytes:0})),G&&I.push({index:xSe,vertexBuffer:E,componentsPerAttribute:1,componentDatatype:Q.fromTypedArray(c.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),u&&(I=I.concat(W));let w=new ti({context:n,attributes:I}),k={depthTest:{enabled:!0}},B={depthTest:{enabled:!0},depthMask:!1,blending:un.ALPHA_BLEND};e._opaquePass===Ze.CESIUM_3D_TILE&&(k.stencilTest=Mt.setCesium3DTileBit(),k.stencilMask=Mt.CESIUM_3D_TILE_MASK,B.stencilTest=Mt.setCesium3DTileBit(),B.stencilMask=Mt.CESIUM_3D_TILE_MASK),e._opaqueRenderState=Ne.fromCache(k),e._translucentRenderState=Ne.fromCache(B),e._drawCommand=new je({boundingVolume:new ce,cull:e._cull,modelMatrix:new M,primitiveType:we.POINTS,vertexArray:w,count:o,shaderProgram:void 0,uniformMap:void 0,renderState:V?e._translucentRenderState:e._opaqueRenderState,pass:V?Ze.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}function A_t(e,t){let n=t.context,i=e._isQuantized,o=e._isQuantizedDraco,r=e._isOctEncodedDraco,s={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){let a=I_t;if(a.x=e._attenuation?e.maximumAttenuation:e._pointSize,a.x*=t.pixelRatio,a.y=e.time,e._attenuation){let c=t.camera.frustum,d;t.mode===ie.SCENE2D||c instanceof rn?d=Number.POSITIVE_INFINITY:d=n.drawingBufferHeight/t.camera.frustum.sseDenominator,a.z=e.geometricError*e.geometricErrorScale,a.w=d}return a},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){let a=e.clippingPlanes;return e.isClipped?a.texture:n.defaultTexture},u_clippingPlanesEdgeStyle:function(){let a=e.clippingPlanes;if(!l(a))return O.TRANSPARENT;let c=O.clone(a.edgeColor,P_t);return c.alpha=a.edgeWidth,c},u_clippingPlanesMatrix:function(){let a=e.clippingPlanes;if(!l(a))return M.IDENTITY;let c=g(e.clippingPlanesOriginMatrix,e._modelMatrix);M.multiply(n.uniformState.view3D,c,A7);let d=M.multiply(A7,a.modelMatrix,A7);return M.inverseTranspose(d,w_t)}};_L.addUniforms(e,s),(i||o||r)&&(s=Ct(s,{u_quantizedVolumeScaleAndOctEncodedRange:function(){let a=W_t;if(l(e._quantizedVolumeScale)){let c=h.clone(e._quantizedVolumeScale,a);h.divideByScalar(c,e._quantizedRange,a)}return a.w=e._octEncodedRange,a}})),l(e._uniformMapLoaded)&&(s=e._uniformMapLoaded(s)),e._drawCommand.uniformMap=s}function M7(e,t){let n=/czm_3dtiles_property_(\\d+)/g,i=n.exec(e);for(;i!==null;){let o=parseInt(i[1]);t.indexOf(o)===-1&&t.push(o),i=n.exec(e)}}function N7(e,t){e=e.slice(e.indexOf(` `));let n=/czm_3dtiles_builtin_property_(\\w+)/g,i=n.exec(e);for(;i!==null;){let o=i[1];t.indexOf(o)===-1&&t.push(o),i=n.exec(e)}}function k7(e,t){let n=e.numberOfAttributes;for(let i=0;i<n;++i){let o=e.getAttribute(i);if(o.index===t)return o}}var M_t={POSITION:\"czm_3dtiles_builtin_property_POSITION\",POSITION_ABSOLUTE:\"czm_3dtiles_builtin_property_POSITION_ABSOLUTE\",COLOR:\"czm_3dtiles_builtin_property_COLOR\",NORMAL:\"czm_3dtiles_builtin_property_NORMAL\"};function N_t(e,t,n){let i,o,r,s=t.context,a=l(n),c=e._isQuantized,d=e._isQuantizedDraco,u=e._isOctEncoded16P,m=e._isOctEncodedDraco,p=e._isRGB565,b=e._isTranslucent,f=e._hasColors,x=e._hasNormals,_=e._hasBatchIds,C=e._backFaceCulling,V=e._normalShading,L=e._drawCommand.vertexArray,R=e.clippingPlanes,G=e._attenuation,X,v,W,F=b,A=Oe(M_t),y={},Z=e._styleableShaderAttributes;for(o in Z)Z.hasOwnProperty(o)&&(r=Z[o],A[o]=`czm_3dtiles_property_${r.location}`,y[r.location]=r);if(a){let ae={translucent:!1},ye=\"(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)\";X=n.getColorShaderFunction(`getColorFromStyle${ye}`,A,ae),v=n.getShowShaderFunction(`getShowFromStyle${ye}`,A,ae),W=n.getPointSizeShaderFunction(`getPointSizeFromStyle${ye}`,A,ae),l(X)&&ae.translucent&&(F=!0)}e._styleTranslucent=F;let E=l(X),I=l(v),w=l(W),k=e.isClipped,B=[],U=[];E&&(M7(X,B),N7(X,U)),I&&(M7(v,B),N7(v,U)),w&&(M7(W,B),N7(W,U));let Y=U.indexOf(\"COLOR\")>=0,N=U.indexOf(\"NORMAL\")>=0;if(N&&!x)throw new ue(\"Style references the NORMAL semantic but the point cloud does not have normals\");for(o in Z)if(Z.hasOwnProperty(o)){r=Z[o];let ae=B.indexOf(r.location)>=0,ye=k7(L,r.location);ye.enabled=ae}let J=f&&(!E||Y);if(f){let ae=k7(L,Y3);ae.enabled=J}let z=x&&(V||C||N);if(x){let ae=k7(L,U7);ae.enabled=z}let ee={a_position:gSe};J&&(ee.a_color=Y3),z&&(ee.a_normal=U7),_&&(ee.a_batchId=xSe);let H=\"\",j=B.length;for(i=0;i<j;++i){let ae=B[i];r=y[ae];let ye=r.componentCount,Te=`czm_3dtiles_property_${ae}`,Le;ye===1?Le=\"float\":Le=`vec${ye}`,H+=`in ${Le} ${Te}; `,ee[Te]=r.location}A_t(e,t);let q=`in vec3 a_position; out vec4 v_color; uniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; uniform vec4 u_constantColor; uniform vec4 u_highlightColor; `;q+=`float u_pointSize; float tiles3d_tileset_time; `,G&&(q+=`float u_geometricError; float u_depthMultiplier; `),q+=H,J&&(b?q+=`in vec4 a_color; `:p?q+=`in float a_color; const float SHIFT_RIGHT_11 = 1.0 / 2048.0; const float SHIFT_RIGHT_5 = 1.0 / 32.0; const float SHIFT_LEFT_11 = 2048.0; const float SHIFT_LEFT_5 = 32.0; const float NORMALIZE_6 = 1.0 / 64.0; const float NORMALIZE_5 = 1.0 / 32.0; `:q+=`in vec3 a_color; `),z&&(u||m?q+=`in vec2 a_normal; `:q+=`in vec3 a_normal; `),_&&(q+=`in float a_batchId; `),(c||d||m)&&(q+=`uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; `),E&&(q+=X),I&&(q+=v),w&&(q+=W),q+=`void main() { u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; `,G&&(q+=` u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; `),J?b?q+=` vec4 color = a_color; `:p?q+=` float compressed = a_color; float r = floor(compressed * SHIFT_RIGHT_11); compressed -= r * SHIFT_LEFT_11; float g = floor(compressed * SHIFT_RIGHT_5); compressed -= g * SHIFT_LEFT_5; float b = compressed; vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); vec4 color = vec4(rgb, 1.0); `:q+=` vec4 color = vec4(a_color, 1.0); `:q+=` vec4 color = u_constantColor; `,c||d?q+=` vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; `:q+=` vec3 position = a_position; `,q+=` vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); `,z?(u?q+=` vec3 normal = czm_octDecode(a_normal); `:m?q+=` vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; `:q+=` vec3 normal = a_normal; `,q+=` vec3 normalEC = czm_normal * normal; `):q+=` vec3 normal = vec3(1.0); `,E&&(q+=` color = getColorFromStyle(position, position_absolute, color, normal); `),I&&(q+=` float show = float(getShowFromStyle(position, position_absolute, color, normal)); `),w?q+=` gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; `:G?q+=` vec4 positionEC = czm_modelView * vec4(position, 1.0); float depth = -positionEC.z; gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); `:q+=` gl_PointSize = u_pointSize; `,q+=` color = color * u_highlightColor; `,z&&V&&(q+=` float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); diffuseStrength = max(diffuseStrength, 0.4); color.xyz *= diffuseStrength * czm_lightColor; `),q+=` v_color = color; gl_Position = czm_modelViewProjection * vec4(position, 1.0); `,z&&C&&(q+=` float visible = step(-normalEC.z, 0.0); gl_Position *= visible; gl_PointSize *= visible; `),I&&(q+=` gl_Position.w *= float(show); gl_PointSize *= float(show); `),q+=`} `;let pe=`in vec4 v_color; `;k&&(pe+=`uniform highp sampler2D u_clippingPlanes; uniform mat4 u_clippingPlanesMatrix; uniform vec4 u_clippingPlanesEdgeStyle; `,pe+=` `,pe+=K0(R,s),pe+=` `),pe+=`void main() { out_FragColor = czm_gammaCorrect(v_color); `,k&&(pe+=uA(\"u_clippingPlanes\",\"u_clippingPlanesMatrix\",\"u_clippingPlanesEdgeStyle\")),pe+=`} `,e.splitDirection!==Hc.NONE&&(pe=_L.modifyFragmentShader(pe)),l(e._vertexShaderLoaded)&&(q=e._vertexShaderLoaded(q)),l(e._fragmentShaderLoaded)&&(pe=e._fragmentShaderLoaded(pe));let _e=e._drawCommand;l(_e.shaderProgram)&&_e.shaderProgram.destroy(),_e.shaderProgram=Ht.fromCache({context:s,vertexShaderSource:q,fragmentShaderSource:pe,attributeLocations:ee});try{_e.shaderProgram._bind()}catch{throw new ue(\"Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.\")}}function k_t(e,t){if(e._decodingState===dS.READY)return!1;if(e._decodingState===dS.NEEDS_DECODE){let n=e._parsedContent,i=n.draco,o=Dp.decodePointCloud(i,t);l(o)&&(e._decodingState=dS.DECODING,o.then(function(r){e._decodingState=dS.READY;let s=l(r.POSITION)?r.POSITION.array:void 0,a=l(r.RGB)?r.RGB.array:void 0,c=l(r.RGBA)?r.RGBA.array:void 0,d=l(r.NORMAL)?r.NORMAL.array:void 0,u=l(r.BATCH_ID)?r.BATCH_ID.array:void 0,m=l(s)&&l(r.POSITION.data.quantization),p=l(d)&&l(r.NORMAL.data.quantization);if(m){let _=r.POSITION.data.quantization,C=_.range;e._quantizedVolumeScale=h.fromElements(C,C,C),e._quantizedVolumeOffset=h.unpack(_.minValues),e._quantizedRange=(1<<_.quantizationBits)-1,e._isQuantizedDraco=!0}p&&(e._octEncodedRange=(1<<r.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);let b=n.styleableProperties,f=i.batchTableProperties;for(let _ in f)if(f.hasOwnProperty(_)){let C=r[_];l(b)||(b={}),b[_]={typedArray:C.array,componentCount:C.data.componentsPerAttribute}}l(s)&&(n.positions={typedArray:s});let x=g(c,a);l(x)&&(n.colors={typedArray:x}),l(d)&&(n.normals={typedArray:d}),l(u)&&(n.batchIds={typedArray:u}),n.styleableProperties=b}).catch(function(r){e._decodingState=dS.FAILED,e._error=r}))}return!0}var U_t=new se,D_t=new h;mA.prototype.update=function(e){let t=e.context;if(l(this._error)){let d=this._error;throw this._error=void 0,d}if(k_t(this,t))return;let i=!1,o=!M.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,o=!0),l(this._drawCommand)||(F_t(this,e),o=!0,i=!0,this._ready=!0,this._parsedContent=void 0),o){M.clone(this.modelMatrix,this._modelMatrix);let d=this._drawCommand.modelMatrix;if(M.clone(this._modelMatrix,d),l(this._rtcCenter)&&M.multiplyByTranslation(d,this._rtcCenter,d),l(this._quantizedVolumeOffset)&&M.multiplyByTranslation(d,this._quantizedVolumeOffset,d),e.mode!==ie.SCENE3D){let m=e.mapProjection,p=M.getColumn(d,3,U_t);se.equals(p,se.UNIT_W)||Wt.basisTo2D(m,d,d)}let u=this._drawCommand.boundingVolume;if(ce.clone(this._boundingSphere,u),this._cull){let m=u.center;M.multiplyByPoint(d,m,m);let p=M.getScale(d,D_t);u.radius*=h.maximumComponent(p)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,i=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,i=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,i=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,i=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,i=!0);let r=this.splitDirection!==Hc.NONE;this._splittingEnabled!==r&&(this._splittingEnabled=r,i=!0),i&&N_t(this,e,this._style),this._drawCommand.castShadows=_n.castShadows(this.shadows),this._drawCommand.receiveShadows=_n.receiveShadows(this.shadows);let s=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=s?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=s?Ze.TRANSLUCENT:this._opaquePass;let a=e.commandList,c=e.passes;(c.render||c.pick)&&a.push(this._drawCommand)};mA.prototype.isDestroyed=function(){return!1};mA.prototype.destroy=function(){let e=this._drawCommand;return l(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),me(this)};var hA=mA;var y6i=T(S(),1);function $d(){fe.throwInstantiationError()}$d.computeDefaultLevelZeroMaximumGeometricError=function(e){return e.ellipsoid.maximumRadius*2*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))};Object.defineProperties($d.prototype,{quadtree:{get:fe.throwInstantiationError,set:fe.throwInstantiationError},tilingScheme:{get:fe.throwInstantiationError},errorEvent:{get:fe.throwInstantiationError}});$d.prototype.update=fe.throwInstantiationError;$d.prototype.beginUpdate=fe.throwInstantiationError;$d.prototype.endUpdate=fe.throwInstantiationError;$d.prototype.getLevelMaximumGeometricError=fe.throwInstantiationError;$d.prototype.loadTile=fe.throwInstantiationError;$d.prototype.computeTileVisibility=fe.throwInstantiationError;$d.prototype.showTileThisFrame=fe.throwInstantiationError;$d.prototype.computeDistanceToTile=fe.throwInstantiationError;$d.prototype.isDestroyed=fe.throwInstantiationError;$d.prototype.destroy=fe.throwInstantiationError;var D7=$d;var S6i=T(S(),1);function B7(e){e=g(e,1),this._radius=g(e,1)}Object.defineProperties(B7.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}});B7.prototype.emit=function(e){let t=P.randomBetween(0,P.TWO_PI),n=P.randomBetween(0,P.PI),i=P.randomBetween(0,this._radius),o=i*Math.cos(t)*Math.sin(n),r=i*Math.sin(t)*Math.sin(n),s=i*Math.cos(n);e.position=h.fromElements(o,r,s,e.position),e.velocity=h.normalize(e.position,e.velocity)};var Y7=B7;var L6i=T(S(),1);function fA(){}fA.prototype.evaluate=function(e,t){fe.throwInstantiationError()};fA.prototype.evaluateColor=function(e,t){fe.throwInstantiationError()};fA.prototype.getShaderFunction=function(e,t,n,i){fe.throwInstantiationError()};fA.prototype.getVariables=function(){fe.throwInstantiationError()};var O7=fA;var X6i=T(S(),1);function TL(e){this._ready=!1,this._provider=void 0,this._errorEvent=new ge,this._readyEvent=new ge,Y_t(this,e)}Object.defineProperties(TL.prototype,{errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}}});TL.fromWorldTerrain=function(e){return new TL(tS(e))};TL.fromWorldBathymetry=function(e){return new TL(D9(e))};function B_t(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}async function Y_t(e,t){let n;try{n=await Promise.resolve(t),e._provider=n,e._ready=!0,e._readyEvent.raiseEvent(n)}catch(i){B_t(e._errorEvent,i)}}var pA=TL;var P6i=T(S(),1);function SL(){}SL.prototype.boundingVolume=void 0;SL.prototype.boundingSphere=void 0;SL.prototype.distanceToCamera=function(e){fe.throwInstantiationError()};SL.prototype.intersectPlane=function(e){fe.throwInstantiationError()};SL.prototype.createDebugVolume=function(e){fe.throwInstantiationError()};var z7=SL;var k6i=T(S(),1);function bA(e){e=g(e,g.EMPTY_OBJECT),this._tilingScheme=l(e.tilingScheme)?e.tilingScheme:new Ui({ellipsoid:e.ellipsoid}),this._color=g(e.color,O.YELLOW),this._errorEvent=new ge,this._tileWidth=g(e.tileWidth,256),this._tileHeight=g(e.tileHeight,256),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0}Object.defineProperties(bA.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}});bA.prototype.getTileCredits=function(e,t,n){};bA.prototype.requestImage=function(e,t,n,i){let o=document.createElement(\"canvas\");o.width=256,o.height=256;let r=o.getContext(\"2d\"),s=this._color.toCssColorString();return r.strokeStyle=s,r.lineWidth=2,r.strokeRect(1,1,255,255),r.font=\"bold 25px Arial\",r.textAlign=\"center\",r.fillStyle=s,r.fillText(`L: ${n}`,124,86),r.fillText(`X: ${e}`,124,136),r.fillText(`Y: ${t}`,124,186),Promise.resolve(o)};bA.prototype.pickFeatures=function(e,t,n,i,o){};var yA=bA;var B6i=T(S(),1);function H7(e){fe.throwInstantiationError()}H7.prototype.isReady=fe.throwInstantiationError;H7.prototype.shouldDiscardImage=fe.throwInstantiationError;var K7=H7;var O6i=T(S(),1),O_t={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3},J7=Object.freeze(O_t);var lqi=T(S(),1);function mS(e){e=g(e,g.EMPTY_OBJECT),this.show=g(e.show,!0),this.modelMatrix=M.clone(g(e.modelMatrix,M.IDENTITY)),this.shadows=g(e.shadows,_n.ENABLED),this.maximumMemoryUsage=g(e.maximumMemoryUsage,256),this.shading=new cf(e.shading),this.style=e.style,this.frameFailed=new ge,this.frameChanged=new ge,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new Kp,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=new Array(5).fill(0),this._runningAverage=0}Object.defineProperties(mS.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){fs.setOwner(e,this,\"_clippingPlanes\")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if(l(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}}});function z_t(e){return`uniform vec4 czm_pickColor; ${e}`}function H_t(e){return function(t){return Ct(t,{czm_pickColor:function(){return e._pickId.color}})}}function K_t(){return\"czm_pickColor\"}mS.prototype.makeStyleDirty=function(){this._styleDirty=!0};mS.prototype._getAverageLoadTime=function(){return this._runningLength===0?.05:this._runningAverage};var J_t=new te;function j7(e){let t=e._clock,n=t.canAnimate&&t.shouldAnimate,i=t.multiplier;return n?i:0}function uS(e,t){return e._intervals.indexOf(t.start)}function Q_t(e,t){let n=e._intervals,i=e._clock,o=j7(e);if(o===0)return;let r=e._getAverageLoadTime(),s=te.addSeconds(i.currentTime,r*o,J_t),a=n.indexOf(s),c=uS(e,t);return a===c&&(o>=0?++a:--a),n.get(a)}function j_t(e){let t=e._intervals,i=e._clock.currentTime,o=t.indexOf(i);return t.get(o)}function q_t(e,t,n){let i=j7(e),o=uS(e,t),r=uS(e,n);return i>=0?o>=r:o<=r}function TSe(e,t){return function(n){let i=l(n.message)?n.message:n.toString();e.frameFailed.numberOfListeners>0?e.frameFailed.raiseEvent({uri:t,message:i}):(console.log(`A frame failed to load: ${t}`),console.log(`Error: ${i}`))}}function $_t(e,t,n){let i=uS(e,t),o=e._frames,r=o[i];if(!l(r)){let s=t.data.transform,a=l(s)?M.fromArray(s):void 0,c=t.data.uri;r={pointCloud:void 0,transform:a,timestamp:fi(),sequential:!0,ready:!1,touchedFrameNumber:n.frameNumber,uri:c},o[i]=r,Xe.fetchArrayBuffer({url:c}).then(function(d){r.pointCloud=new hA({arrayBuffer:d,cull:!0,fragmentShaderLoaded:z_t,uniformMapLoaded:H_t(e),pickIdLoaded:K_t})}).catch(TSe(e,c))}return r}function eTt(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}function tTt(e,t,n,i){t.touchedFrameNumber<i.frameNumber-1&&(t.sequential=!1);let o=t.pointCloud;if(l(o)&&!t.ready){let r=i.commandList,s=r.length;if(SSe(e,t,n,i),o.ready&&(t.ready=!0,e._totalMemoryUsageInBytes+=o.geometryByteLength,r.length=s,t.sequential)){let a=(fi()-t.timestamp)/1e3;eTt(e,a)}}t.touchedFrameNumber=i.frameNumber}var nTt=new M;function iTt(e,t){let n=e.shading;return l(n)&&l(n.baseResolution)?n.baseResolution:l(t.boundingSphere)?P.cbrt(t.boundingSphere.volume()/t.pointsLength):0}function oTt(e){let t=e.shading;return l(t)&&l(t.maximumAttenuation)?t.maximumAttenuation:10}var rTt=new cf;function SSe(e,t,n,i){let o=g(e.shading,rTt),r=t.pointCloud,s=g(t.transform,M.IDENTITY);r.modelMatrix=M.multiplyTransformation(e.modelMatrix,s,nTt),r.style=e.style,r.time=n.timeSinceLoad,r.shadows=e.shadows,r.clippingPlanes=e._clippingPlanes,r.isClipped=n.isClipped,r.attenuation=o.attenuation,r.backFaceCulling=o.backFaceCulling,r.normalShading=o.normalShading,r.geometricError=iTt(e,r),r.geometricErrorScale=o.geometricErrorScale,r.maximumAttenuation=oTt(e);try{r.update(i)}catch(a){TSe(e,t.uri)(a)}t.touchedFrameNumber=i.frameNumber}function Q7(e,t,n,i){let o=$_t(e,t,i);tTt(e,o,n,i)}function sTt(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}function CSe(e,t){let n=e._frames,i=n.length;for(let o=0;o<i;++o){let r=n[o];if(l(r)&&(!l(t)||t(r))){let s=r.pointCloud;r.ready&&(e._totalMemoryUsageInBytes-=s.geometryByteLength),l(s)&&s.destroy(),r===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),n[o]=void"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 78,
    "total_chunks": 194,
    "chunk_size": 30614,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.693Z"
  },
  "content": "se,ANe=new ze,Iz=new D,Wz=new D;Ia.wgs84ToWindowCoordinates=function(e,t,n){return Ia.wgs84WithEyeOffsetToWindowCoordinates(e,t,h.ZERO,n)};var Cre=new se,Vre=new h;function eI(e,t,n,i){let o=n.viewMatrix,r=M.multiplyByVector(o,se.fromElements(e.x,e.y,e.z,1,Cre),Cre),s=h.multiplyComponents(t,h.normalize(r,Vre),Vre);return r.x+=t.x+s.x,r.y+=t.y+s.y,r.z+=s.z,M.multiplyByVector(n.frustum.projectionMatrix,r,i)}var MNe=new he(Math.PI,P.PI_OVER_TWO),NNe=new h,kNe=new h;Ia.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,n,i){let o=e.frameState,r=Ia.computeActualWgs84Position(o,t,FNe);if(!l(r))return;let s=e.canvas,a=ANe;a.x=0,a.y=0,a.width=s.clientWidth,a.height=s.clientHeight;let c=e.camera,d=!1;if(o.mode===ie.SCENE2D){let u=e.mapProjection,m=MNe,p=u.project(m,NNe),b=h.clone(c.position,kNe),f=c.frustum.clone(),x=M.computeViewportTransformation(a,0,1,new M),_=c.frustum.projectionMatrix,C=c.positionWC.y,V=h.fromElements(P.sign(C)*p.x-C,0,-c.positionWC.x),L=Wt.pointToGLWindowCoordinates(_,x,V);if(C===0||L.x<=0||L.x>=s.clientWidth)d=!0;else{if(L.x>s.clientWidth*.5){a.width=L.x,c.frustum.right=p.x-C,dc=eI(r,n,c,dc),Ia.clipToGLWindowCoordinates(a,dc,Iz),a.x+=L.x,c.position.x=-c.position.x;let R=c.frustum.right;c.frustum.right=-c.frustum.left,c.frustum.left=-R,dc=eI(r,n,c,dc),Ia.clipToGLWindowCoordinates(a,dc,Wz)}else{a.x+=L.x,a.width-=L.x,c.frustum.left=-p.x-C,dc=eI(r,n,c,dc),Ia.clipToGLWindowCoordinates(a,dc,Iz),a.x=a.x-a.width,c.position.x=-c.position.x;let R=c.frustum.left;c.frustum.left=-c.frustum.right,c.frustum.right=-R,dc=eI(r,n,c,dc),Ia.clipToGLWindowCoordinates(a,dc,Wz)}h.clone(b,c.position),c.frustum=f.clone(),i=D.clone(Iz,i),(i.x<0||i.x>s.clientWidth)&&(i.x=Wz.x)}}if(o.mode!==ie.SCENE2D||d){if(dc=eI(r,n,c,dc),dc.z<0&&!(c.frustum instanceof rn)&&!(c.frustum instanceof Vr))return;i=Ia.clipToGLWindowCoordinates(a,dc,i)}return i.y=s.clientHeight-i.y,i};Ia.wgs84ToDrawingBufferCoordinates=function(e,t,n){if(n=Ia.wgs84ToWindowCoordinates(e,t,n),!!l(n))return Ia.transformWindowToDrawingBuffer(e,n,n)};var Jp=new h,UNe=new he;Ia.computeActualWgs84Position=function(e,t,n){let i=e.mode;if(i===ie.SCENE3D)return h.clone(t,n);let o=e.mapProjection,r=o.ellipsoid.cartesianToCartographic(t,UNe);if(!l(r))return;if(o.project(r,Jp),i===ie.COLUMBUS_VIEW)return h.fromElements(Jp.z,Jp.x,Jp.y,n);if(i===ie.SCENE2D)return h.fromElements(0,Jp.x,Jp.y,n);let s=e.morphTime;return h.fromElements(P.lerp(Jp.z,t.x,s),P.lerp(Jp.x,t.y,s),P.lerp(Jp.y,t.z,s),n)};var Lre=new h,Zre=new h,Rre=new M;Ia.clipToGLWindowCoordinates=function(e,t,n){return h.divideByScalar(t,t.w,Lre),M.computeViewportTransformation(e,0,1,Rre),M.multiplyByPoint(Rre,Lre,Zre),D.fromCartesian3(Zre,n)};Ia.transformWindowToDrawingBuffer=function(e,t,n){let i=e.canvas,o=e.drawingBufferWidth/i.clientWidth,r=e.drawingBufferHeight/i.clientHeight;return D.fromElements(t.x*o,t.y*r,n)};var DNe=new se,Gre=new se;Ia.drawingBufferToWgs84Coordinates=function(e,t,n,i){let r=e.context.uniformState,s=r.currentFrustum,a=s.x,c=s.y;if(e.frameState.useLogDepth){let b=n*r.log2FarDepthFromNearPlusOne,f=Math.pow(2,b)-1;n=c*(1-a/(f+a))/(c-a)}let d=e.view.passState.viewport,u=se.clone(se.UNIT_W,DNe);u.x=(t.x-d.x)/d.width*2-1,u.y=(t.y-d.y)/d.height*2-1,u.z=n*2-1,u.w=1;let m,p=e.camera.frustum;if(l(p.fovy)){m=M.multiplyByVector(r.inverseViewProjection,u,Gre);let b=1/m.w;h.multiplyByScalar(m,b,m)}else{let b=p.offCenterFrustum;l(b)&&(p=b),m=Gre,m.x=(u.x*(p.right-p.left)+p.left+p.right)*.5,m.y=(u.y*(p.top-p.bottom)+p.bottom+p.top)*.5,m.z=(u.z*(a-c)-a-c)*.5,m.w=1,m=M.multiplyByVector(r.inverseView,m,m)}return h.fromCartesian4(m,i)};var Zi=Ia;var c0n=T(S(),1),BNe={LEFT:-1,UP:-1,NONE:0,RIGHT:1,DOWN:1},Hc=Object.freeze(BNe);var ibn=T(S(),1);var f0n=T(S(),1);var LC={};LC._deprecationWarning=Is;var Qp=Uint32Array.BYTES_PER_ELEMENT;LC.parse=function(e,t){let n=g(t,0);t=n;let i=new Uint8Array(e),o=new DataView(e);t+=Qp;let r=o.getUint32(t,!0);if(r!==1)throw new ue(`Only Batched 3D Model version 1 is supported. Version ${r} is not.`);t+=Qp;let s=o.getUint32(t,!0);t+=Qp;let a=o.getUint32(t,!0);t+=Qp;let c=o.getUint32(t,!0);t+=Qp;let d=o.getUint32(t,!0);t+=Qp;let u=o.getUint32(t,!0);t+=Qp;let m;d>=570425344?(t-=Qp*2,m=a,d=c,u=0,a=0,c=0,LC._deprecationWarning(\"b3dm-legacy-header\",\"This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.\")):u>=570425344&&(t-=Qp,m=d,d=a,u=c,a=0,c=0,LC._deprecationWarning(\"b3dm-legacy-header\",\"This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.\"));let p;a===0?p={BATCH_LENGTH:g(m,0)}:(p=Go(i,t,a),t+=a);let b=new Uint8Array(e,t,c);t+=c;let f,x;d>0&&(f=Go(i,t,d),t+=d,u>0&&(x=new Uint8Array(e,t,u),x=new Uint8Array(x),t+=u));let _=n+s-t;if(_===0)throw new ue(\"glTF byte length must be greater than 0.\");let C;return t%4===0?C=new Uint8Array(e,t,_):(LC._deprecationWarning(\"b3dm-glb-unaligned\",\"The embedded glb is not aligned to a 4-byte boundary.\"),C=new Uint8Array(i.subarray(t,t+_))),{batchLength:m,featureTableJson:p,featureTableBinary:b,batchTableJson:f,batchTableBinary:x,gltf:C}};var tI=LC;var x0n=T(S(),1);function nI(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function Ere(e,t,n,i,o,r){let s=e._cachedTypedArrays,a=s[t];return l(a)||(a=Q.createArrayBufferView(n,e.buffer.buffer,e.buffer.byteOffset+r,o*i),s[t]=a),a}function YNe(e,t,n,i){let o=e._cachedTypedArrays,r=o[t];return l(r)||(r=Q.createTypedArray(n,i),o[t]=r),r}nI.prototype.getGlobalProperty=function(e,t,n){let i=this.json[e];if(l(i))return l(i.byteOffset)?(t=g(t,Q.UNSIGNED_INT),n=g(n,1),Ere(this,e,t,n,1,i.byteOffset)):i};nI.prototype.hasProperty=function(e){return l(this.json[e])};nI.prototype.getPropertyArray=function(e,t,n){let i=this.json[e];if(l(i))return l(i.byteOffset)?(l(i.componentType)&&(t=Q.fromName(i.componentType)),Ere(this,e,t,n,this.featuresLength,i.byteOffset)):YNe(this,e,t,i)};nI.prototype.getProperty=function(e,t,n,i,o){let r=this.json[e];if(!l(r))return;let s=this.getPropertyArray(e,t,n);if(n===1)return s[i];for(let a=0;a<n;++a)o[a]=s[n*i+a];return o};var Um=nI;var M0n=T(S(),1);function iI(e){let t=e.count,n=e.batchTable,i=e.binaryBody,o=g(e.parseAsPropertyAttributes,!1),r=e.customAttributeOutput,s=ONe(n),a;l(s.jsonProperties)&&(a=new Op({count:t,properties:s.jsonProperties}));let c;l(s.hierarchy)&&(c=new Nx({extension:s.hierarchy,binaryBody:i}));let d=wm.BATCH_TABLE_CLASS_NAME,u=s.binaryProperties,m,p,b;if(o){let _=HNe(t,d,u,i,r);b=_.transcodedSchema,p=[new r_({propertyAttribute:_.propertyAttributeJson,class:_.transcodedClass})]}else{let _=zNe(t,d,u,i);b=_.transcodedSchema;let C=_.featureTableJson;m=new El({count:C.count,properties:C.properties,class:_.transcodedClass,bufferViews:_.bufferViewsTypedArrays}),p=[]}let f=[];if(l(m)||l(a)||l(c)){let _=new zc({id:0,name:\"Batch Table\",count:t,metadataTable:m,jsonMetadataTable:a,batchTableHierarchy:c});f.push(_)}let x={schema:b,propertyTables:f,propertyAttributes:p,extensions:s.extensions,extras:s.extras};return new Xa(x)}function ONe(e){let t=e.HIERARCHY,n=e.extras,i=e.extensions,o;l(t)?(iI._deprecationWarning(\"batchTableHierarchyExtension\",\"The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead.\"),o=t):l(i)&&(o=i[\"3DTILES_batch_table_hierarchy\"]);let r,s={};for(let a in e){if(!e.hasOwnProperty(a)||a===\"HIERARCHY\"||a===\"extensions\"||a===\"extras\")continue;let c=e[a];Array.isArray(c)?(r=l(r)?r:{},r[a]=c):s[a]=c}return{binaryProperties:s,jsonProperties:r,hierarchy:o,extras:n,extensions:i}}function zNe(e,t,n,i){let o={},r={},s={},a=0;for(let m in n){if(!n.hasOwnProperty(m))continue;if(!l(i))throw new ue(`Property ${m} requires a batch table binary.`);let p=n[m],b=hd(p);r[m]={bufferView:a},o[m]=Xre(p),s[a]=b.createArrayBufferView(i.buffer,i.byteOffset+p.byteOffset,e),a++}let c={classes:{}};c.classes[t]={properties:o};let d=Fm.fromJson(c);return{featureTableJson:{class:t,count:e,properties:r},bufferViewsTypedArrays:s,transcodedSchema:d,transcodedClass:d.classes[t]}}function HNe(e,t,n,i,o){let r={},s={},a=0;for(let m in n){if(!n.hasOwnProperty(m))continue;let p=n[m];if(!l(i)&&!l(p.typedArray))throw new ue(`Property ${m} requires a batch table binary.`);let b=qt.sanitizeGlslIdentifier(m);(b===\"\"||r.hasOwnProperty(b))&&(b=`property_${a}`,a++);let f=Xre(p);f.name=m,r[b]=f;let x=b.toUpperCase();x.startsWith(\"_\")||(x=`_${x}`);let _=p.typedArray;l(_)||(_=hd(p).createArrayBufferView(i.buffer,i.byteOffset+p.byteOffset,e));let C=new Nt.Attribute;C.name=x,C.count=e,C.type=p.type;let V=Q.fromTypedArray(_);(V===Q.INT||V===Q.UNSIGNED_INT||V===Q.DOUBLE)&&(iI._oneTimeWarning(\"Cast pnts property to floats\",`Point cloud property \"${x}\" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),_=new Float32Array(_)),C.componentDatatype=Q.fromTypedArray(_),C.typedArray=_,o.push(C),s[b]={attribute:x}}let c={classes:{}};c.classes[t]={properties:r};let d=Fm.fromJson(c);return{class:t,propertyAttributeJson:{properties:s},transcodedSchema:d,transcodedClass:d.classes[t]}}function Xre(e){let t=KNe(e.componentType);return{type:e.type,componentType:t}}function KNe(e){switch(e){case\"BYTE\":return\"INT8\";case\"UNSIGNED_BYTE\":return\"UINT8\";case\"SHORT\":return\"INT16\";case\"UNSIGNED_SHORT\":return\"UINT16\";case\"INT\":return\"INT32\";case\"UNSIGNED_INT\":return\"UINT32\";case\"FLOAT\":return\"FLOAT32\";case\"DOUBLE\":return\"FLOAT64\"}}iI._deprecationWarning=Is;iI._oneTimeWarning=wt;var jp=iI;var c_={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},JNe=Nt.FeatureIdAttribute;function ry(e){e=g(e,g.EMPTY_OBJECT);let t=e.b3dmResource,n=e.baseResource,i=e.arrayBuffer,o=g(e.byteOffset,0),r=g(e.releaseGltfJson,!1),s=g(e.asynchronous,!0),a=g(e.incrementallyLoadTextures,!0),c=g(e.upAxis,Ro.Y),d=g(e.forwardAxis,Ro.X),u=g(e.loadAttributesAsTypedArray,!1),m=g(e.loadAttributesFor2D,!1),p=g(e.enablePick,!1),b=g(e.loadIndicesForWireframe,!1),f=g(e.loadPrimitiveOutline,!0),x=g(e.loadForClassification,!1);n=l(n)?n:t.clone(),this._b3dmResource=t,this._baseResource=n,this._arrayBuffer=i,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=a,this._upAxis=c,this._forwardAxis=d,this._loadAttributesAsTypedArray=u,this._loadAttributesFor2D=m,this._enablePick=p,this._loadIndicesForWireframe=b,this._loadPrimitiveOutline=f,this._loadForClassification=x,this._state=c_.UNLOADED,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=M.IDENTITY}l(Object.create)&&(ry.prototype=Object.create(io.prototype),ry.prototype.constructor=ry);Object.defineProperties(ry.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});ry.prototype.load=function(){if(l(this._promise))return this._promise;let e=tI.parse(this._arrayBuffer,this._byteOffset),t=e.batchLength,n=e.featureTableJson,i=e.featureTableBinary,o=e.batchTableJson,r=e.batchTableBinary,s=new Um(n,i);t=s.getGlobalProperty(\"BATCH_LENGTH\"),this._batchLength=t;let a=s.getGlobalProperty(\"RTC_CENTER\",Q.FLOAT,3);l(a)&&(this._transform=M.fromTranslation(h.fromArray(a))),this._batchTable={json:o,binary:r};let c=new Hp({typedArray:e.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,loadForClassification:this._loadForClassification,renameBatchIdSemantic:!0});this._gltfLoader=c,this._state=c_.LOADING;let d=this;return this._promise=c.load().then(function(){if(!d.isDestroyed())return d._state=c_.PROCESSING,d}).catch(function(u){if(!d.isDestroyed())return QNe(d,u)}),this._promise};function QNe(e,t){return e.unload(),e._state=c_.FAILED,t=e.getError(\"Failed to load b3dm\",t),Promise.reject(t)}ry.prototype.process=function(e){if(this._state===c_.READY)return!0;if(this._state!==c_.PROCESSING||!this._gltfLoader.process(e))return!1;let n=this._gltfLoader.components;return n.transform=M.multiplyTransformation(this._transform,n.transform,n.transform),jNe(this,n),this._components=n,this._arrayBuffer=void 0,this._state=c_.READY,!0};function jNe(e,t){let n=e._batchTable,i=e._batchLength;if(i===0)return;let o;if(l(n.json))o=jp({count:i,batchTable:n.json,binaryBody:n.binary});else{let a=new zc({name:wm.BATCH_TABLE_CLASS_NAME,count:i});o=new Xa({schema:{},propertyTables:[a]})}let r=t.scene.nodes,s=r.length;for(let a=0;a<s;a++)Ire(r[a]);t.structuralMetadata=o}function Ire(e){let t=e.children.length;for(let i=0;i<t;i++)Ire(e.children[i]);let n=e.primitives.length;for(let i=0;i<n;i++){let o=e.primitives[i],r=qt.getAttributeBySemantic(o,St.FEATURE_ID);if(l(r)){r.setIndex=0;let s=new JNe;s.propertyTableId=0,s.setIndex=0,s.positionalLabel=\"featureId_0\",o.featureIds.push(s)}}}ry.prototype.unload=function(){l(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),this._components=void 0,this._arrayBuffer=void 0};var oI=ry;var Lbn=T(S(),1);function sy(e){e=g(e,g.EMPTY_OBJECT),this._geoJson=e.geoJson,this._components=void 0}l(Object.create)&&(sy.prototype=Object.create(io.prototype),sy.prototype.constructor=sy);Object.defineProperties(sy.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}}});sy.prototype.load=function(){return Promise.resolve(this)};sy.prototype.process=function(e){return l(this._components)||(this._components=dke(this._geoJson,e),this._geoJson=void 0),!0};function qNe(){this.lines=void 0,this.points=void 0,this.properties=void 0}function $Ne(){this.features=[]}function Pz(e){let t=e[0],n=e[1],i=g(e[2],0);return new h(t,n,i)}function vz(e){let t=e.length,n=new Array(t);for(let o=0;o<t;o++)n[o]=Pz(e[o]);return[n]}function eke(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=vz(e[i])[0];return n}function Wre(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=vz(e[i])[0];return n}function tke(e){let t=e.length,n=[];for(let i=0;i<t;i++)Array.prototype.push.apply(n,Wre(e[i]));return n}function nke(e){return[Pz(e)]}function ike(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=Pz(e[i]);return n}var oke={LineString:vz,MultiLineString:eke,MultiPolygon:tke,Polygon:Wre,MultiPoint:ike,Point:nke},rke={LineString:we.LINES,MultiLineString:we.LINES,MultiPolygon:we.LINES,Polygon:we.LINES,MultiPoint:we.POINTS,Point:we.POINTS};function Pre(e,t){if(!l(e.geometry))return;let n=e.geometry.type,i=oke[n],o=rke[n],r=e.geometry.coordinates;if(!l(i)||!l(r))return;let s=new qNe;o===we.LINES?s.lines=i(r):o===we.POINTS&&(s.points=i(r)),s.properties=e.properties,t.features.push(s)}function ske(e,t){let n=e.features,i=n.length;for(let o=0;o<i;o++)Pre(n[o],t)}var ake={FeatureCollection:ske,Feature:Pre},sN=new h;function cke(e,t,n){let i=0,o=0,r=e.length;for(let F=0;F<r;F++){let A=e[F];if(l(A.lines)){let y=A.lines.length;for(let Z=0;Z<y;Z++){let E=A.lines[Z];i+=E.length,o+=(E.length-1)*2}}}let s=new Float32Array(i*3),a=new Float32Array(i),c=Ae.createTypedArray(i,o),d=Ae.fromTypedArray(c),u=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),m=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=0,b=0;for(let F=0;F<r;F++){let A=e[F];if(!l(A.lines))continue;let y=A.lines.length;for(let Z=0;Z<y;Z++){let E=A.lines[Z],I=E.length;for(let w=0;w<I;w++){let k=E[w],B=h.fromDegrees(k.x,k.y,k.z,oe.WGS84,sN),U=M.multiplyByPoint(t,B,sN);h.minimumByComponent(u,U,u),h.maximumByComponent(m,U,m),h.pack(U,s,p*3),a[p]=F,w<I-1&&(c[b*2]=p,c[b*2+1]=p+1,b++),p++}}}let f=pt.createVertexBuffer({typedArray:s,context:n.context,usage:Me.STATIC_DRAW});f.vertexArrayDestroyable=!1;let x=pt.createVertexBuffer({typedArray:a,context:n.context,usage:Me.STATIC_DRAW});x.vertexArrayDestroyable=!1;let _=pt.createIndexBuffer({typedArray:c,context:n.context,usage:Me.STATIC_DRAW,indexDatatype:d});_.vertexArrayDestroyable=!1;let C=new Nt.Attribute;C.semantic=St.POSITION,C.componentDatatype=Q.FLOAT,C.type=tn.VEC3,C.count=i,C.min=u,C.max=m,C.buffer=f;let V=new Nt.Attribute;V.semantic=St.FEATURE_ID,V.setIndex=0,V.componentDatatype=Q.FLOAT,V.type=tn.SCALAR,V.count=i,V.buffer=x;let L=[C,V],R=new Nt.Material;R.unlit=!0;let G=new Nt.Indices;G.indexDatatype=d,G.count=c.length,G.buffer=_;let X=new Nt.FeatureIdAttribute;X.featureCount=r,X.propertyTableId=0,X.setIndex=0,X.positionalLabel=\"featureId_0\";let v=[X],W=new Nt.Primitive;return W.attributes=L,W.indices=G,W.featureIds=v,W.primitiveType=we.LINES,W.material=R,W}function lke(e,t,n){let i=0,o=e.length;for(let L=0;L<o;L++){let R=e[L];l(R.points)&&(i+=R.points.length)}let r=new Float32Array(i*3),s=new Float32Array(i),a=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),c=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),d=0;for(let L=0;L<o;L++){let R=e[L];if(!l(R.points))continue;let G=R.points.length;for(let X=0;X<G;X++){let v=R.points[X],W=h.fromDegrees(v.x,v.y,v.z,oe.WGS84,sN),F=M.multiplyByPoint(t,W,sN);h.minimumByComponent(a,F,a),h.maximumByComponent(c,F,c),h.pack(F,r,d*3),s[d]=L,d++}}let u=pt.createVertexBuffer({typedArray:r,context:n.context,usage:Me.STATIC_DRAW});u.vertexArrayDestroyable=!1;let m=pt.createVertexBuffer({typedArray:s,context:n.context,usage:Me.STATIC_DRAW});m.vertexArrayDestroyable=!1;let p=new Nt.Attribute;p.semantic=St.POSITION,p.componentDatatype=Q.FLOAT,p.type=tn.VEC3,p.count=i,p.min=a,p.max=c,p.buffer=u;let b=new Nt.Attribute;b.semantic=St.FEATURE_ID,b.setIndex=0,b.componentDatatype=Q.FLOAT,b.type=tn.SCALAR,b.count=i,b.buffer=m;let f=[p,b],x=new Nt.Material;x.unlit=!0;let _=new Nt.FeatureIdAttribute;_.featureCount=o,_.propertyTableId=0,_.setIndex=0,_.positionalLabel=\"featureId_0\";let C=[_],V=new Nt.Primitive;return V.attributes=f,V.featureIds=C,V.primitiveType=we.POINTS,V.material=x,V}function dke(e,t){let n=new $Ne,i=ake[e.type];l(i)&&i(e,n);let o=n.features,r=o.length;if(r===0)throw new ue(\"GeoJSON must have at least one feature\");let s={};for(let F=0;F<r;F++){let A=o[F],y=g(A.properties,g.EMPTY_OBJECT);for(let Z in y)y.hasOwnProperty(Z)&&(l(s[Z])||(s[Z]=new Array(r)))}for(let F=0;F<r;F++){let A=o[F];for(let y in s)if(s.hasOwnProperty(y)){let Z=g(A.properties[y],\"\");s[y][F]=Z}}let a=new Op({count:r,properties:s}),d=[new zc({id:0,count:r,jsonMetadataTable:a})],u=Fm.fromJson({}),m=new Xa({schema:u,propertyTables:d}),p=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),b=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),f=!1,x=!1;for(let F=0;F<r;F++){let A=o[F];if(l(A.lines)){f=!0;let y=A.lines.length;for(let Z=0;Z<y;Z++){let E=A.lines[Z],I=E.length;for(let w=0;w<I;w++)h.minimumByComponent(p,E[w],p),h.maximumByComponent(b,E[w],b)}}if(l(A.points)){x=!0;let y=A.points.length;for(let Z=0;Z<y;Z++){let E=A.points[Z];h.minimumByComponent(p,E,p),h.maximumByComponent(b,E,b)}}}let _=h.midpoint(p,b,new h),C=h.fromDegrees(_.x,_.y,_.z,oe.WGS84,new h),V=Wt.eastNorthUpToFixedFrame(C,oe.WGS84,new M),L=M.inverseTransformation(V,new M),R=[];f&&R.push(cke(o,L,t)),x&&R.push(lke(o,L,t));let G=new Nt.Node;G.index=0,G.primitives=R;let X=[G],v=new Nt.Scene;v.nodes=X;let W=new Nt.Components;return W.scene=v,W.nodes=X,W.transform=V,W.structuralMetadata=m,W}sy.prototype.unload=function(){this._components=void 0};var rI=sy;var ayn=T(S(),1);var Ibn=T(S(),1);var aN={};aN._deprecationWarning=Is;var ay=Uint32Array.BYTES_PER_ELEMENT;aN.parse=function(e,t){let n=g(t,0);t=n;let i=new Uint8Array(e),o=new DataView(e);t+=ay;let r=o.getUint32(t,!0);if(r!==1)throw new ue(`Only Instanced 3D Model version 1 is supported. Version ${r} is not.`);t+=ay;let s=o.getUint32(t,!0);t+=ay;let a=o.getUint32(t,!0);if(a===0)throw new ue(\"featureTableJsonByteLength is zero, the feature table must be defined.\");t+=ay;let c=o.getUint32(t,!0);t+=ay;let d=o.getUint32(t,!0);t+=ay;let u=o.getUint32(t,!0);t+=ay;let m=o.getUint32(t,!0);if(m!==1&&m!==0)throw new ue(`Only glTF format 0 (uri) or 1 (embedded) are supported. Format ${m} is not.`);t+=ay;let p=Go(i,t,a);t+=a;let b=new Uint8Array(e,t,c);t+=c;let f,x;d>0&&(f=Go(i,t,d),t+=d,u>0&&(x=new Uint8Array(e,t,u),x=new Uint8Array(x),t+=u));let _=n+s-t;if(_===0)throw new ue(\"glTF byte length must be greater than 0.\");let C;return t%4===0?C=new Uint8Array(e,t,_):(aN._deprecationWarning(\"i3dm-glb-unaligned\",\"The embedded glb is not aligned to a 4-byte boundary.\"),C=new Uint8Array(i.subarray(t,t+_))),{gltfFormat:m,featureTableJson:p,featureTableBinary:b,batchTableJson:f,batchTableBinary:x,gltf:C}};var sI=aN;var qp={NOT_LOADED:0,LOADING:1,PROCESSING:2,POST_PROCESSING:3,READY:4,FAILED:5,UNLOADED:6},cN=Nt.Attribute,uke=Nt.FeatureIdAttribute,wre=Nt.Instances;function $p(e){e=g(e,g.EMPTY_OBJECT);let t=e.i3dmResource,n=e.arrayBuffer,i=e.baseResource,o=g(e.byteOffset,0),r=g(e.releaseGltfJson,!1),s=g(e.asynchronous,!0),a=g(e.incrementallyLoadTextures,!0),c=g(e.upAxis,Ro.Y),d=g(e.forwardAxis,Ro.X),u=g(e.loadAttributesAsTypedArray,!1),m=g(e.loadIndicesForWireframe,!1),p=g(e.loadPrimitiveOutline,!0),b=g(e.enablePick,!1);i=l(i)?i:t.clone(),this._i3dmResource=t,this._baseResource=i,this._arrayBuffer=n,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=a,this._upAxis=c,this._forwardAxis=d,this._loadAttributesAsTypedArray=u,this._loadIndicesForWireframe=m,this._loadPrimitiveOutline=p,this._enablePick=b,this._state=qp.NOT_LOADED,this._promise=void 0,this._gltfLoader=void 0,this._buffers=[],this._components=void 0,this._transform=M.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}l(Object.create)&&($p.prototype=Object.create(io.prototype),$p.prototype.constructor=$p);Object.defineProperties($p.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});$p.prototype.load=function(){if(l(this._promise))return this._promise;let e=sI.parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,n=e.featureTableBinary,i=e.batchTableJson,o=e.batchTableBinary,r=e.gltfFormat,s=new Um(t,n);this._featureTable=s;let a=s.getGlobalProperty(\"INSTANCES_LENGTH\");if(s.featuresLength=a,!l(a))throw new ue(\"Feature table global property: INSTANCES_LENGTH must be defined\");this._instancesLength=a;let c=s.getGlobalProperty(\"RTC_CENTER\",Q.FLOAT,3);l(c)&&(this._transform=M.fromTranslation(h.fromArray(c))),this._batchTable={json:i,binary:o};let d={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,enablePick:this._enablePick,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline};if(r===0){let m=Zl(e.gltf);m=m.replace(/[\\s\\0]+$/,\"\");let p=this._baseResource.getDerivedResource({url:m});d.gltfResource=p,d.baseResource=p}else d.gltfResource=this._i3dmResource,d.typedArray=e.gltf;let u=new Hp(d);return this._gltfLoader=u,this._state=qp.LOADING,this._promise=u.load().then(()=>{if(!this.isDestroyed())return this._state=qp.PROCESSING,this}).catch(m=>{if(!this.isDestroyed())throw mke(this,m)}),this._promise};function mke(e,t){return e.unload(),e._state=qp.FAILED,e.getError(\"Failed to load i3dm\",t)}$p.prototype.process=function(e){if(this._state===qp.READY)return!0;let t=this._gltfLoader,n=!1;if(this._state===qp.PROCESSING&&(n=t.process(e)),!n)return!1;let i=t.components;return i.transform=M.multiplyTransformation(this._transform,i.transform,i.transform),pke(this,i,e),hke(this,i),this._components=i,this._arrayBuffer=void 0,this._state=qp.READY,!0};function hke(e,t){let n=e._batchTable,i=e._instancesLength;if(i===0)return;let o;if(l(n.json))o=jp({count:i,batchTable:n.json,binaryBody:n.binary});else{let r=new zc({name:wm.BATCH_TABLE_CLASS_NAME,count:i});o=new Xa({schema:{},propertyTables:[r]})}t.structuralMetadata=o}var lN=new h,wz=new Array(4),fke=new M;function pke(e,t,n){let i,o=e._featureTable,r=e._instancesLength;if(r===0)return;let s=o.getGlobalProperty(\"RTC_CENTER\",Q.FLOAT,3),a=o.getGlobalProperty(\"EAST_NORTH_UP\"),c=o.hasProperty(\"NORMAL_UP\")||o.hasProperty(\"NORMAL_UP_OCT32P\")||a,d=o.hasProperty(\"SCALE\")||o.hasProperty(\"SCALE_NON_UNIFORM\"),u=yke(o,r),m;c&&(m=new Float32Array(4*r));let p;d&&(p=new Float32Array(3*r));let b=new Float32Array(r),f=h.unpackArray(u),x=new h,_=new h,C=new h,V=new h,L=new $,R=new Fe,G=new Array(4),X=new h,v=new Array(3),W=new M;if(!l(s)||h.equals(h.unpack(s),h.ZERO)){let U=ce.fromPoints(f);for(i=0;i<f.length;i++)h.subtract(f[i],U.center,lN),u[3*i+0]=lN.x,u[3*i+1]=lN.y,u[3*i+2]=lN.z;let Y=M.fromTranslation(U.center,fke);t.transform=M.multiplyTransformation(Y,t.transform,t.transform)}for(i=0;i<r;i++){x=h.clone(f[i]),l(s)&&h.add(x,h.unpack(s),x),c&&(gke(o,a,i,R,x,C,_,V,L,W),Fe.pack(R,G,0),m[4*i+0]=G[0],m[4*i+1]=G[1],m[4*i+2]=G[2],m[4*i+3]=G[3]),d&&(xke(o,i,X),h.pack(X,v,0),p[3*i+0]=v[0],p[3*i+1]=v[1],p[3*i+2]=v[2]);let U=o.getProperty(\"BATCH_ID\",Q.UNSIGNED_SHORT,1,i);l(U)||(U=i),b[i]=U}let F=new wre;F.transformInWorldSpace=!0;let A=e._buffers,y=new cN;if(y.name=\"Instance Translation\",y.semantic=zr.TRANSLATION,y.componentDatatype=Q.FLOAT,y.type=tn.VEC3,y.count=r,y.typedArray=u,!c){let U=pt.createVertexBuffer({context:n.context,typedArray:u,usage:Me.STATIC_DRAW});U.vertexArrayDestroyable=!1,A.push(U),y.buffer=U}if(F.attributes.push(y),c){let U=new cN;U.name=\"Instance Rotation\",U.semantic=zr.ROTATION,U.componentDatatype=Q.FLOAT,U.type=tn.VEC4,U.count=r,U.typedArray=m,F.attributes.push(U)}if(d){let U=new cN;if(U.name=\"Instance Scale\",U.semantic=zr.SCALE,U.componentDatatype=Q.FLOAT,U.type=tn.VEC3,U.count=r,c)U.typedArray=p;else{let Y=pt.createVertexBuffer({context:n.context,typedArray:p,usage:Me.STATIC_DRAW});Y.vertexArrayDestroyable=!1,A.push(Y),U.buffer=Y}F.attributes.push(U)}let Z=new cN;Z.name=\"Instance Feature ID\",Z.setIndex=0,Z.semantic=zr.FEATURE_ID,Z.componentDatatype=Q.FLOAT,Z.type=tn.SCALAR,Z.count=r;let E=pt.createVertexBuffer({context:n.context,typedArray:b,usage:Me.STATIC_DRAW});E.vertexArrayDestroyable=!1,A.push(E),Z.buffer=E,F.attributes.push(Z);let I=new uke;I.propertyTableId=0,I.setIndex=0,I.positionalLabel=\"instanceFeatureId_0\",F.featureIds.push(I);let w=t.nodes,k=w.length,B=!1;for(i=0;i<k;i++){let U=w[i];U.primitives.length>0&&(U.instances=B?bke(F):F,B=!0)}}function bke(e){let t=new wre;t.transformInWorldSpace=e.transformInWorldSpace;let n=e.attributes,i=n.length;for(let o=0;o<i;o++){let r=Oe(n[o],!1);t.attributes.push(r)}return t.featureIds=e.featureIds,t}function yke(e,t){if(e.hasProperty(\"POSITION\"))return e.getPropertyArray(\"POSITION\",Q.FLOAT,3);if(e.hasProperty(\"POSITION_QUANTIZED\")){let n=e.getPropertyArray(\"POSITION_QUANTIZED\",Q.UNSIGNED_SHORT,3),i=e.getGlobalProperty(\"QUANTIZED_VOLUME_OFFSET\",Q.FLOAT,3);if(!l(i))throw new ue(\"Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.\");let o=e.getGlobalProperty(\"QUANTIZED_VOLUME_SCALE\",Q.FLOAT,3);if(!l(o))throw new ue(\"Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.\");let r=new Float32Array(n.length);for(let s=0;s<n.length/3;s++)for(let a=0;a<3;a++){let c=3*s+a;r[c]=n[c]/65535*o[a]+i[a]}return r}else throw new ue(\"Either POSITION or POSITION_QUANTIZED must be defined for each instance.\")}var vre=new Array(4);function gke(e,t,n,i,o,r,s,a,c,d){let u=e.getProperty(\"NORMAL_UP\",Q.FLOAT,3,n,wz),m=e.getProperty(\"NORMAL_RIGHT\",Q.FLOAT,3,n,vre),p=!1;if(l(u)){if(!l(m))throw new ue(\"To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.\");h.unpack(u,0,r),h.unpack(m,0,s),p=!0}else{let b=e.getProperty(\"NORMAL_UP_OCT32P\",Q.UNSIGNED_SHORT,2,n,wz),f=e.getProperty(\"NORMAL_RIGHT_OCT32P\",Q.UNSIGNED_SHORT,2,n,vre);if(l(b)){if(!l(f))throw new ue(\"To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.\");wn.octDecodeInRange(b[0],b[1],65535,r),wn.octDecodeInRange(f[0],f[1],65535,s),p=!0}else t?(Wt.eastNorthUpToFixedFrame(o,oe.WGS84,d),M.getMatrix3(d,c)):$.clone($.IDENTITY,c)}p&&(h.cross(s,r,a),h.normalize(a,a),$.setColumn(c,0,s,c),$.setColumn(c,1,r,c),$.setColumn(c,2,a,c)),Fe.fromRotationMatrix(c,i)}function xke(e,t,n){n=h.fromElements(1,1,1,n);let i=e.getProperty(\"SCALE\",Q.FLOAT,1,t);l(i)&&h.multiplyByScalar(n,i,n);let o=e.getProperty(\"SCALE_NON_UNIFORM\",Q.FLOAT,3,t,wz);l(o)&&(n.x*=o[0],n.y*=o[1],n.z*=o[2])}function _ke(e){let t=e._buffers,n=t.length;for(let i=0;i<n;i++){let o=t[i];o.isDestroyed()||o.destroy()}t.length=0}$p.prototype.isUnloaded=function(){return this._state===qp.UNLOADED};$p.prototype.unload=function(){l(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),_ke(this),this._components=void 0,this._arrayBuffer=void 0,this._state=qp.UNLOADED};var aI=$p;var Rgn=T(S(),1);var ygn=T(S(),1);var lyn=T(S(),1),Tke={STOPPED:0,ANIMATING:1},Dm=Object.freeze(Tke);var cgn=T(S(),1);var xyn=T(S(),1);var byn=T(S(),1);function ZC(){this.times=void 0,this.points=void 0,fe.throwInstantiationError()}ZC.getPointType=function(e){if(typeof e==\"number\")return Number;if(e instanceof h)return h;if(e instanceof Fe)return Fe};ZC.prototype.evaluate=fe.throwInstantiationError;ZC.prototype.findTimeInterval=function(e,t){let n=this.times,i=n.length;if(t=g(t,0),e>=n[t]){if(t+1<i&&e<n[t+1])return t;if(t+2<i&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;let o;if(e>n[t])for(o=t;o<i-1&&!(e>=n[o]&&e<n[o+1]);++o);else for(o=t-1;o>=0&&!(e>=n[o]&&e<n[o+1]);--o);return o===i-1&&(o=i-2),o};ZC.prototype.wrapTime=function(e){let t=this.times,n=t[t.length-1],i=t[0],o=n-i,r;return e<i&&(r=Math.floor((i-e)/o)+1,e+=r*o),e>n&&(r=Math.floor((e-n)/o)+1,e-=r*o),e};ZC.prototype.clampTime=function(e){let"
}
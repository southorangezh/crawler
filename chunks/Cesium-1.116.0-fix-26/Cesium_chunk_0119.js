{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 119,
    "total_chunks": 194,
    "chunk_size": 35307,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.722Z"
  },
  "content": "Fd(e,t,n,i){let o=i.keys,r=new Pv.default(\".\"),s=e.querySelectorAll(t);for(let a=0;a<s.length;a++){let c=s[a],d=c.getAttribute(n);if(l(d)){let m=new Pv.default(d).absoluteTo(r).toString(),p=o.indexOf(m);if(p!==-1){let b=o[p];c.setAttribute(n,i[b]),t===\"a\"&&c.getAttribute(\"download\")===null&&c.setAttribute(\"download\",b)}}}}function Ad(e,t,n,i){let o=e.querySelectorAll(t);for(let r=0;r<o.length;r++){let s=o[r],a=s.getAttribute(n),c=QQ(a,i);l(c)&&s.setAttribute(n,c.url)}}function U0e(e,t,n){let i=Cs(e,\"id\");i=l(i)&&i.length!==0?i:Bn(),l(n)&&(i=n+i);let o=t.getById(i);return l(o)&&(i=Bn(),l(n)&&(i=n+i)),o=t.add(new zo({id:i})),l(o.kml)||(o.addProperty(\"kml\"),o.kml=new Bnt),o}function vv(e,t){return e===\"absolute\"||e===\"relativeToGround\"||t===\"relativeToSeaFloor\"}function BU(e,t){if(!l(e))return h.fromDegrees(0,0,0,t);let n=e.match(/[^\\s,\\n]+/g);if(!l(n))return h.fromDegrees(0,0,0,t);let i=parseFloat(n[0]),o=parseFloat(n[1]),r=parseFloat(n[2]);return i=isNaN(i)?0:i,o=isNaN(o)?0:o,r=isNaN(r)?0:r,h.fromDegrees(i,o,r,t)}function kU(e,t){if(!l(e))return;let n=e.textContent.match(/[^\\s\\n]+/g);if(!l(n))return;let i=n.length,o=new Array(i),r=0;for(let s=0;s<i;s++)o[r++]=BU(n[s],t);return o}function lg(e,t){if(!l(e))return;let n=e.getAttribute(t);if(n!==null){let i=parseFloat(n);return isNaN(i)?void 0:i}}function Cs(e,t){if(!l(e))return;let n=e.getAttribute(t);return n!==null?n:void 0}function Xi(e,t,n){if(!l(e))return;let i=e.childNodes,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.localName===t&&n.indexOf(s.namespaceURI)!==-1)return s}}function w0e(e,t,n){if(!l(e))return;let i=[],o=e.getElementsByTagNameNS(\"*\",t),r=o.length;for(let s=0;s<r;s++){let a=o[s];a.localName===t&&n.indexOf(a.namespaceURI)!==-1&&i.push(a)}return i}function fh(e,t,n){if(!l(e))return[];let i=[],o=e.childNodes,r=o.length;for(let s=0;s<r;s++){let a=o[s];a.localName===t&&n.indexOf(a.namespaceURI)!==-1&&i.push(a)}return i}function qn(e,t,n){let i=Xi(e,t,n);if(l(i)){let o=parseFloat(i.textContent);return isNaN(o)?void 0:o}}function In(e,t,n){let i=Xi(e,t,n);if(l(i))return i.textContent.trim()}function ph(e,t,n){let i=Xi(e,t,n);if(l(i)){let o=i.textContent.trim();return o===\"1\"||/^true$/i.test(o)}}function QQ(e,t,n){if(!l(e))return;let i;if(l(n)){e=e.replace(/\\\\/g,\"/\");let o=n[e];if(l(o))i=new Xe({url:o});else{let r=new Pv.default(t.getUrlComponent()),s=new Pv.default(e);o=n[s.absoluteTo(r)],l(o)&&(i=new Xe({url:o}))}}return l(i)||(i=t.getDerivedResource({url:e})),i}var Ol={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function zQ(e,t){if(!l(e)||/^\\s*$/gm.test(e))return;e[0]===\"#\"&&(e=e.substring(1));let n=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,r=parseInt(e.substring(6,8),16)/255;return t?(r>0?(Ol.maximumRed=r,Ol.red=void 0):(Ol.maximumRed=void 0,Ol.red=0),o>0?(Ol.maximumGreen=o,Ol.green=void 0):(Ol.maximumGreen=void 0,Ol.green=0),i>0?(Ol.maximumBlue=i,Ol.blue=void 0):(Ol.maximumBlue=void 0,Ol.blue=0),Ol.alpha=n,O.fromRandom(Ol)):new O(r,o,i,n)}function uT(e,t,n){let i=In(e,t,n);if(l(i))return zQ(i,In(e,\"colorMode\",n)===\"random\")}function fnt(e){let t=Xi(e,\"TimeStamp\",ve.kmlgx),n=In(t,\"when\",ve.kmlgx);if(!l(t)||!l(n)||n.length===0)return;let i=te.fromIso8601(n),o=new Wr;return o.addInterval(new Sn({start:i,stop:Be.MAXIMUM_VALUE})),o}function pnt(e){let t=Xi(e,\"TimeSpan\",ve.kmlgx);if(!l(t))return;let n,i=Xi(t,\"begin\",ve.kmlgx),o=l(i)?te.fromIso8601(i.textContent):void 0,r=Xi(t,\"end\",ve.kmlgx),s=l(r)?te.fromIso8601(r.textContent):void 0;if(l(o)&&l(s)){if(te.lessThan(s,o)){let a=o;o=s,s=a}n=new Wr,n.addInterval(new Sn({start:o,stop:s}))}else l(o)?(n=new Wr,n.addInterval(new Sn({start:o,stop:Be.MAXIMUM_VALUE}))):l(s)&&(n=new Wr,n.addInterval(new Sn({start:Be.MINIMUM_VALUE,stop:s})));return n}function D0e(){let e=new ec;return e.width=cg,e.height=cg,e.scaleByDistance=new At(E0e,X0e,I0e,W0e),e.pixelOffsetScaleByDistance=new At(E0e,X0e,I0e,W0e),e}function jQ(){let e=new Rm;return e.outline=!0,e.outlineColor=O.WHITE,e}function B0e(){let e=new Zm;return e.translucencyByDistance=new At(3e6,1,5e6,0),e.pixelOffset=new D(17,0),e.horizontalOrigin=ui.LEFT,e.font=\"16px sans-serif\",e.style=wo.FILL_AND_OUTLINE,e}function qQ(e,t,n,i,o){let r=In(e,\"href\",ve.kml);if(!l(r)||r.length===0)return;if(r.indexOf(\"root://icons/palette-\")===0){let a=r.charAt(21),c=g(qn(e,\"x\",ve.gx),0),d=g(qn(e,\"y\",ve.gx),0);c=Math.min(c/32,7),d=7-Math.min(d/32,7);let u=8*d+c;r=`https://maps.google.com/mapfiles/kml/pal${a}/icon${u}.png`}let s=QQ(r,n,i);if(o){let a=In(e,\"refreshMode\",ve.kml),c=In(e,\"viewRefreshMode\",ve.kml);a===\"onInterval\"||a===\"onExpire\"?wt(`kml-refreshMode-${a}`,`KML - Unsupported Icon refreshMode: ${a}`):(c===\"onStop\"||c===\"onRegion\")&&wt(`kml-refreshMode-${c}`,`KML - Unsupported Icon viewRefreshMode: ${c}`);let d=g(In(e,\"viewBoundScale\",ve.kml),1),u=c===\"onStop\"?\"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]\":\"\",m=g(In(e,\"viewFormat\",ve.kml),u),p=In(e,\"httpQuery\",ve.kml);l(m)&&s.setQueryParameters(nd(DU(m))),l(p)&&s.setQueryParameters(nd(DU(p)));let b=t._ellipsoid;return e4(s,t.camera,t.canvas,d,t._lastCameraView.bbox,b),s}return s}function bnt(e,t,n,i,o){let r=qn(t,\"scale\",ve.kml),s=qn(t,\"heading\",ve.kml),a=uT(t,\"color\",ve.kml),c=Xi(t,\"Icon\",ve.kml),d=qQ(c,e,i,o,!1);l(c)&&!l(d)&&(d=!1);let u=qn(c,\"x\",ve.gx),m=qn(c,\"y\",ve.gx),p=qn(c,\"w\",ve.gx),b=qn(c,\"h\",ve.gx),f=Xi(t,\"hotSpot\",ve.kml),x=lg(f,\"x\"),_=lg(f,\"y\"),C=Cs(f,\"xunits\"),V=Cs(f,\"yunits\"),L=n.billboard;l(L)||(L=D0e(),n.billboard=L),L.image=d,L.scale=r,L.color=a,(l(u)||l(m)||l(p)||l(b))&&(L.imageSubRegion=new ze(u,m,p,b)),l(s)&&s!==0&&(L.rotation=P.toRadians(-s),L.alignedAxis=h.UNIT_Z),r=g(r,1);let R,G;l(x)&&(C===\"pixels\"?R=-x*r:C===\"insetPixels\"?R=(x-cg)*r:C===\"fraction\"&&(R=-x*cg*r),R+=cg*.5*r),l(_)&&(V===\"pixels\"?G=_*r:V===\"insetPixels\"?G=(-_+cg)*r:V===\"fraction\"&&(G=_*cg*r),G-=cg*.5*r),(l(R)||l(G))&&(L.pixelOffset=new D(R,G))}function UU(e,t,n,i,o){for(let r=0,s=t.childNodes.length;r<s;r++){let a=t.childNodes.item(r);if(a.localName===\"IconStyle\")bnt(e,a,n,i,o);else if(a.localName===\"LabelStyle\"){let c=n.label;l(c)||(c=B0e(),n.label=c),c.scale=g(qn(a,\"scale\",ve.kml),c.scale),c.fillColor=g(uT(a,\"color\",ve.kml),c.fillColor),c.text=n.name}else if(a.localName===\"LineStyle\"){let c=n.polyline;l(c)||(c=new ic,n.polyline=c),c.width=qn(a,\"width\",ve.kml),c.material=uT(a,\"color\",ve.kml),l(uT(a,\"outerColor\",ve.gx))&&wt(\"kml-gx:outerColor\",\"KML - gx:outerColor is not supported in a LineStyle\"),l(qn(a,\"outerWidth\",ve.gx))&&wt(\"kml-gx:outerWidth\",\"KML - gx:outerWidth is not supported in a LineStyle\"),l(qn(a,\"physicalWidth\",ve.gx))&&wt(\"kml-gx:physicalWidth\",\"KML - gx:physicalWidth is not supported in a LineStyle\"),l(ph(a,\"labelVisibility\",ve.gx))&&wt(\"kml-gx:labelVisibility\",\"KML - gx:labelVisibility is not supported in a LineStyle\")}else if(a.localName===\"PolyStyle\"){let c=n.polygon;l(c)||(c=jQ(),n.polygon=c),c.material=g(uT(a,\"color\",ve.kml),c.material),c.fill=g(ph(a,\"fill\",ve.kml),c.fill),c.outline=g(ph(a,\"outline\",ve.kml),c.outline)}else if(a.localName===\"BalloonStyle\"){let c=g(zQ(In(a,\"bgColor\",ve.kml)),O.WHITE),d=g(zQ(In(a,\"textColor\",ve.kml)),O.BLACK),u=In(a,\"text\",ve.kml);n.addProperty(\"balloonStyle\"),n.balloonStyle={bgColor:c,textColor:d,text:u}}else if(a.localName===\"ListStyle\"){let c=In(a,\"listItemType\",ve.kml);(c===\"radioFolder\"||c===\"checkOffOnly\")&&wt(`kml-listStyle-${c}`,`KML - Unsupported ListStyle with listItemType: ${c}`)}}}function ynt(e,t,n,i,o){let r=new zo,s,a=-1,c=t.childNodes,d=c.length;for(let m=0;m<d;m++){let p=c[m];(p.localName===\"Style\"||p.localName===\"StyleMap\")&&(a=m)}if(a!==-1){let m=c[a];if(m.localName===\"Style\")UU(e,m,r,i,o);else{let p=fh(m,\"Pair\",ve.kml);for(let b=0;b<p.length;b++){let f=p[b],x=In(f,\"key\",ve.kml);if(x===\"normal\"){let _=In(f,\"styleUrl\",ve.kml);if(l(_))s=n.getById(_),l(s)||(s=n.getById(`#${_}`)),l(s)&&r.merge(s);else{let C=Xi(f,\"Style\",ve.kml);UU(e,C,r,i,o)}}else wt(`kml-styleMap-${x}`,`KML - Unsupported StyleMap key: ${x}`)}}}let u=In(t,\"styleUrl\",ve.kml);if(l(u)){let m=u;if(u[0]!==\"#\"&&u.indexOf(\"#\")!==-1){let p=u.split(\"#\"),b=p[0];m=`${i.getDerivedResource({url:b}).getUrlComponent()}#${p[1]}`}s=n.getById(m),l(s)||(s=n.getById(`#${m}`)),l(s)&&r.merge(s)}return r}function gnt(e,t,n){return t.fetchXML().then(function(i){return Y0e(e,i,n,t,!0)})}function Y0e(e,t,n,i,o,r){let s,a,c,d,u=w0e(t,\"Style\",ve.kml);if(l(u)){let x=u.length;for(s=0;s<x;s++)d=u[s],a=Cs(d,\"id\"),l(a)&&(a=`#${a}`,o&&l(i)&&(a=i.getUrlComponent()+a),l(n.getById(a))||(c=new zo({id:a}),n.add(c),UU(e,d,c,i,r)))}let m=w0e(t,\"StyleMap\",ve.kml);if(l(m)){let x=m.length;for(s=0;s<x;s++){let _=m[s];if(a=Cs(_,\"id\"),l(a)){let C=fh(_,\"Pair\",ve.kml);for(let V=0;V<C.length;V++){let L=C[V],R=In(L,\"key\",ve.kml);if(R===\"normal\"){if(a=`#${a}`,o&&l(i)&&(a=i.getUrlComponent()+a),!l(n.getById(a))){c=n.getOrCreateEntity(a);let G=In(L,\"styleUrl\",ve.kml);if(l(G)){G[0]!==\"#\"&&(G=`#${G}`),o&&l(i)&&(G=i.getUrlComponent()+G);let X=n.getById(G);l(X)&&c.merge(X)}else d=Xi(L,\"Style\",ve.kml),UU(e,d,c,i,r)}}else wt(`kml-styleMap-${R}`,`KML - Unsupported StyleMap key: ${R}`)}}}}let p=[],b=t.getElementsByTagName(\"styleUrl\"),f=b.length;for(s=0;s<f;s++){let x=b[s].textContent;if(x[0]!==\"#\"){let _=x.split(\"#\");if(_.length===2){let C=_[0],V=i.getDerivedResource({url:C});p.push(gnt(e,V,n))}}}return p}function $Q(e,t,n){let i=new I0(e,t.id,[\"position\"]),o=new Lf(t.position);t.polyline=l(n.polyline)?n.polyline.clone():new ic,t.polyline.positions=new X0([i,o])}function O0e(e,t){return!l(e)&&!l(t)||e===\"clampToGround\"?Je.CLAMP_TO_GROUND:e===\"relativeToGround\"?Je.RELATIVE_TO_GROUND:e===\"absolute\"?Je.NONE:t===\"clampToSeaFloor\"?(wt(\"kml-gx:altitudeMode-clampToSeaFloor\",\"KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround.\"),Je.CLAMP_TO_GROUND):t===\"relativeToSeaFloor\"?(wt(\"kml-gx:altitudeMode-relativeToSeaFloor\",\"KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround.\"),Je.RELATIVE_TO_GROUND):(l(e)?wt(\"kml-altitudeMode-unknown\",`KML - Unknown <kml:altitudeMode>:${e}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):wt(\"kml-gx:altitudeMode-unknown\",`KML - Unknown <gx:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),Je.CLAMP_TO_GROUND)}function xnt(e,t,n){return n===\"relativeToSeaFloor\"||t===\"absolute\"||t===\"relativeToGround\"?e:((l(t)&&t!==\"clampToGround\"||l(n)&&n!==\"clampToSeaFloor\")&&wt(\"kml-altitudeMode-unknown\",`KML - Unknown altitudeMode: ${g(t,n)}`),new Lf(e))}function _nt(e,t,n,i){if(!l(e))return;if(n===\"relativeToSeaFloor\"||t===\"absolute\"||t===\"relativeToGround\")return e;(l(t)&&t!==\"clampToGround\"||l(n)&&n!==\"clampToSeaFloor\")&&wt(\"kml-altitudeMode-unknown\",`KML - Unknown altitudeMode: ${g(t,n)}`);let o=e.length;for(let r=0;r<o;r++){let s=e[r];i.scaleToGeodeticSurface(s,s)}return e}function YU(e,t,n,i){let o=t.label;l(o)||(o=l(n.label)?n.label.clone():B0e(),t.label=o),o.text=t.name;let r=t.billboard;l(r)||(r=l(n.billboard)?n.billboard.clone():D0e(),t.billboard=r),l(r.image)?r.image.getValue()||(r.image=void 0):r.image=e._pinBuilder.fromColor(O.YELLOW,64);let s=1;l(r.scale)&&(s=r.scale.getValue(),s!==0?o.pixelOffset=new D(s*16+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),l(i)&&e._clampToGround&&(r.heightReference=i,o.heightReference=i)}function z0e(e,t){let n=e.path;l(n)||(n=new Xp,n.leadTime=0,e.path=n);let i=t.polyline;l(i)&&(n.material=i.material,n.width=i.width)}function Tnt(e,t,n,i,o){let r=In(n,\"coordinates\",ve.kml),s=In(n,\"altitudeMode\",ve.kml),a=In(n,\"altitudeMode\",ve.gx),c=ph(n,\"extrude\",ve.kml),d=e._ellipsoid,u=BU(r,d);return i.position=u,YU(e,i,o,O0e(s,a)),c&&vv(s,a)&&$Q(t,i,o),!0}function F0e(e,t,n,i,o){let r=Xi(n,\"coordinates\",ve.kml),s=In(n,\"altitudeMode\",ve.kml),a=In(n,\"altitudeMode\",ve.gx),c=ph(n,\"extrude\",ve.kml),d=ph(n,\"tessellate\",ve.kml),u=vv(s,a),m=qn(n,\"drawOrder\",ve.gx),p=e._ellipsoid,b=kU(r,p),f=o.polyline;if(u&&c){let x=new Ip;i.wall=x,x.positions=b;let _=o.polygon;l(_)&&(x.fill=_.fill,x.material=_.material),x.outline=!0,l(f)?(x.outlineColor=l(f.material)?f.material.color:O.WHITE,x.outlineWidth=f.width):l(_)&&(x.outlineColor=l(_.material)?_.material.color:O.WHITE)}else if(e._clampToGround&&!u&&d){let x=new ic;x.clampToGround=!0,i.polyline=x,x.positions=b,l(f)?(x.material=l(f.material)?f.material.color.getValue(Be.MINIMUM_VALUE):O.WHITE,x.width=g(f.width,1)):(x.material=O.WHITE,x.width=1),x.zIndex=m}else l(m)&&wt(\"kml-gx:drawOrder\",\"KML - gx:drawOrder is not supported in LineStrings when clampToGround is false\"),e._clampToGround&&!d&&wt(\"kml-line-tesselate\",\"Ignoring clampToGround for KML lines without the tessellate flag.\"),f=l(f)?f.clone():new ic,i.polyline=f,f.positions=_nt(b,s,a,p),(!d||u)&&(f.arcType=$t.NONE);return!0}function Snt(e,t,n,i,o){let r=Xi(n,\"outerBoundaryIs\",ve.kml),s=Xi(r,\"LinearRing\",ve.kml),a=Xi(s,\"coordinates\",ve.kml),c=e._ellipsoid,d=kU(a,c),u=ph(n,\"extrude\",ve.kml),m=In(n,\"altitudeMode\",ve.kml),p=In(n,\"altitudeMode\",ve.gx),b=vv(m,p),f=l(o.polygon)?o.polygon.clone():jQ(),x=o.polyline;if(l(x)&&(f.outlineColor=l(x.material)?x.material.color:O.WHITE,f.outlineWidth=x.width),i.polygon=f,b?(f.perPositionHeight=!0,f.extrudedHeight=u?0:void 0):e._clampToGround||(f.height=0),l(d)){let _=new Ra(d),C=fh(n,\"innerBoundaryIs\",ve.kml);for(let V=0;V<C.length;V++){s=fh(C[V],\"LinearRing\",ve.kml);for(let L=0;L<s.length;L++)a=Xi(s[L],\"coordinates\",ve.kml),d=kU(a,c),l(d)&&_.holes.push(new Ra(d))}f.hierarchy=_}return!0}function Cnt(e,t,n,i,o){let r=In(n,\"altitudeMode\",ve.kml),s=In(n,\"altitudeMode\",ve.gx),a=fh(n,\"coord\",ve.gx),c=fh(n,\"angles\",ve.gx),d=fh(n,\"when\",ve.kml),u=ph(n,\"extrude\",ve.kml),m=vv(r,s),p=e._ellipsoid;c.length>0&&wt(\"kml-gx:angles\",\"KML - gx:angles are not supported in gx:Tracks\");let b=Math.min(a.length,d.length),f=[],x=[];for(let C=0;C<b;C++){let V=BU(a[C].textContent,p);f.push(V),x.push(te.fromIso8601(d[C].textContent))}let _=new la;return _.addSamples(x,f),i.position=_,YU(e,i,o,O0e(r,s)),z0e(i,o),i.availability=new Wr,d.length>0&&i.availability.addInterval(new Sn({start:x[0],stop:x[x.length-1]})),m&&u&&$Q(t,i,o),!0}function A0e(e,t,n,i,o,r,s,a,c){let d=e[0],u=e[e.length-1],m=new la;m.addSamples(e,t),n.intervals.addInterval(new Sn({start:d,stop:u,isStartIncluded:c,isStopIncluded:c,data:xnt(m,s,a)})),i.addInterval(new Sn({start:d,stop:u,isStartIncluded:c,isStopIncluded:c})),o.intervals.addInterval(new Sn({start:d,stop:u,isStartIncluded:c,isStopIncluded:c,data:r}))}function Vnt(e,t,n,i,o){let r=ph(n,\"interpolate\",ve.gx),s=fh(n,\"Track\",ve.gx),a,c,d,u=!1,m=new P0,p=new Wr,b=new aa,f=e._ellipsoid;for(let x=0,_=s.length;x<_;x++){let C=s[x],V=fh(C,\"when\",ve.kml),L=fh(C,\"coord\",ve.gx),R=In(C,\"altitudeMode\",ve.kml),G=In(C,\"altitudeMode\",ve.gx),X=vv(R,G),v=ph(C,\"extrude\",ve.kml),W=Math.min(L.length,V.length),F=[];a=[];for(let A=0;A<W;A++){let y=BU(L[A].textContent,f);F.push(y),a.push(te.fromIso8601(V[A].textContent))}r&&(l(c)&&A0e([c,a[0]],[d,F[0]],b,p,m,!1,\"absolute\",void 0,!1),c=a[W-1],d=F[F.length-1]),A0e(a,F,b,p,m,X&&v,R,G,!0),u=u||X&&v}return i.availability=p,i.position=b,YU(e,i,o),z0e(i,o),u&&($Q(t,i,o),i.polyline.show=m),!0}var H0e={Point:Tnt,LineString:F0e,LinearRing:F0e,Polygon:Snt,Track:Cnt,MultiTrack:Vnt,MultiGeometry:Lnt,Model:Znt};function Lnt(e,t,n,i,o,r){let s=n.childNodes,a=!1;for(let c=0,d=s.length;c<d;c++){let u=s.item(c),m=H0e[u.localName];if(l(m)){let p=U0e(u,t,r);p.parent=i,p.name=i.name,p.availability=i.availability,p.description=i.description,p.kml=i.kml,m(e,t,u,p,o)&&(a=!0)}}return a}function Znt(e,t,n,i,o){return wt(\"kml-unsupportedGeometry\",`KML - Unsupported geometry: ${n.localName}`),!1}function Rnt(e,t){let n=Xi(e,\"ExtendedData\",ve.kml);if(!l(n))return;l(Xi(n,\"SchemaData\",ve.kml))&&wt(\"kml-schemaData\",\"KML - SchemaData is unsupported\"),l(Cs(n,\"xmlns:prefix\"))&&wt(\"kml-extendedData\",\"KML - ExtendedData with xmlns:prefix is unsupported\");let i={},o=fh(n,\"Data\",ve.kml);if(l(o)){let r=o.length;for(let s=0;s<r;s++){let a=o[s],c=Cs(a,\"name\");l(c)&&(i[c]={displayName:In(a,\"displayName\",ve.kml),value:In(a,\"value\",ve.kml)})}}t.kml.extendedData=i}var ho;typeof document<\"u\"&&(ho=document.createElement(\"div\"));function Gnt(e,t,n,i,o){let r,s,a,c=t.kml,d=c.extendedData,u=In(e,\"description\",ve.kml),m=g(t.balloonStyle,n.balloonStyle),p=O.WHITE,b=O.BLACK,f=u;l(m)&&(p=g(m.bgColor,O.WHITE),b=g(m.textColor,O.BLACK),f=g(m.text,u));let x;if(l(f)){if(f=f.replace(\"$[name]\",g(t.name,\"\")),f=f.replace(\"$[description]\",g(u,\"\")),f=f.replace(\"$[address]\",g(c.address,\"\")),f=f.replace(\"$[Snippet]\",g(c.snippet,\"\")),f=f.replace(\"$[id]\",t.id),f=f.replace(\"$[geDirections]\",\"\"),l(d)){let V=f.match(/\\$\\[.+?\\]/g);if(V!==null)for(r=0;r<V.length;r++){let L=V[r],R=L.substr(2,L.length-3),G=/\\/displayName$/.test(R);R=R.replace(/\\/displayName$/,\"\"),x=d[R],l(x)&&(x=G?x.displayName:x.value),l(x)&&(f=f.replace(L,g(x,\"\")))}}}else if(l(d)&&(a=Object.keys(d),a.length>0)){for(f='<table class=\"cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter\"><tbody>',r=0;r<a.length;r++)s=a[r],x=d[s],f+=`<tr><th>${g(x.displayName,s)}</th><td>${g(x.value,\"\")}</td></tr>`;f+=\"</tbody></table>\"}if(!l(f))return;f=lnt.link(f),ho.innerHTML=f;let _=ho.querySelectorAll(\"a\");for(r=0;r<_.length;r++)_[r].setAttribute(\"target\",\"_blank\");l(i)&&i.keys.length>1&&(Fd(ho,\"a\",\"href\",i),Fd(ho,\"link\",\"href\",i),Fd(ho,\"area\",\"href\",i),Fd(ho,\"img\",\"src\",i),Fd(ho,\"iframe\",\"src\",i),Fd(ho,\"video\",\"src\",i),Fd(ho,\"audio\",\"src\",i),Fd(ho,\"source\",\"src\",i),Fd(ho,\"track\",\"src\",i),Fd(ho,\"input\",\"src\",i),Fd(ho,\"embed\",\"src\",i),Fd(ho,\"script\",\"src\",i),Fd(ho,\"video\",\"poster\",i)),Ad(ho,\"a\",\"href\",o),Ad(ho,\"link\",\"href\",o),Ad(ho,\"area\",\"href\",o),Ad(ho,\"img\",\"src\",o),Ad(ho,\"iframe\",\"src\",o),Ad(ho,\"video\",\"src\",o),Ad(ho,\"audio\",\"src\",o),Ad(ho,\"source\",\"src\",o),Ad(ho,\"track\",\"src\",o),Ad(ho,\"input\",\"src\",o),Ad(ho,\"embed\",\"src\",o),Ad(ho,\"script\",\"src\",o),Ad(ho,\"video\",\"poster\",o);let C='<div class=\"cesium-infoBox-description-lighter\" style=\"';C+=\"overflow:auto;\",C+=\"word-wrap:break-word;\",C+=`background-color:${p.toCssColorString()};`,C+=`color:${b.toCssColorString()};`,C+='\">',C+=`${ho.innerHTML}</div>`,ho.innerHTML=\"\",t.description=C}function OU(e,t,n){let i=n.entityCollection,o=n.parentEntity,r=n.sourceResource,s=n.uriResolver,a=U0e(t,i,n.context),c=a.kml,d=ynt(e,t,n.styleCollection,r,s),u=In(t,\"name\",ve.kml);a.name=u,a.parent=o;let m=pnt(t);l(m)||(m=fnt(t)),a.availability=m,n4(a);function p(L){return L?L.show&&p(L.parent):!0}let b=ph(t,\"visibility\",ve.kml);a.show=p(o)&&g(b,!0);let f=Xi(t,\"author\",ve.atom),x=c.author;x.name=In(f,\"name\",ve.atom),x.uri=In(f,\"uri\",ve.atom),x.email=In(f,\"email\",ve.atom);let _=Xi(t,\"link\",ve.atom),C=c.link;C.href=Cs(_,\"href\"),C.hreflang=Cs(_,\"hreflang\"),C.rel=Cs(_,\"rel\"),C.type=Cs(_,\"type\"),C.title=Cs(_,\"title\"),C.length=Cs(_,\"length\"),c.address=In(t,\"address\",ve.kml),c.phoneNumber=In(t,\"phoneNumber\",ve.kml),c.snippet=In(t,\"Snippet\",ve.kml),Rnt(t,a),Gnt(t,a,d,s,r);let V=e._ellipsoid;return Q0e(t,a,V),J0e(t,a,V),l(Xi(t,\"Region\",ve.kml))&&wt(\"kml-region\",\"KML - Placemark Regions are unsupported\"),{entity:a,styleEntity:d}}function K0e(e,t,n,i){i.addNodes(t.childNodes,n),i.process()}function Ent(e,t,n,i){let o=OU(e,t,n),r=Oe(n);r.parentEntity=o.entity,K0e(e,t,r,i)}function Xnt(e,t,n,i){let o=OU(e,t,n),r=o.entity,s=o.styleEntity,a=!1,c=t.childNodes;for(let d=0,u=c.length;d<u&&!a;d++){let m=c.item(d),p=H0e[m.localName];l(p)&&(p(e,n.entityCollection,m,r,s,r.id),a=!0)}a||(r.merge(s),YU(e,r,s))}var Int={FlyTo:vnt,Wait:Pnt,SoundCue:BQ,AnimatedUpdate:BQ,TourControl:BQ};function Wnt(e,t,n,i){let o=In(t,\"name\",ve.kml),r=Cs(t,\"id\"),s=new Ev(o,r),a=Xi(t,\"Playlist\",ve.gx);if(a){let c=e._ellipsoid,d=a.childNodes;for(let u=0;u<d.length;u++){let m=d[u];if(m.localName){let p=Int[m.localName];p?p(s,m,c):console.log(`Unknown KML Tour playlist entry type ${m.localName}`)}}}e._kmlTours.push(s)}function BQ(e,t){wt(`KML Tour unsupported node ${t.localName}`)}function Pnt(e,t){let n=qn(t,\"duration\",ve.gx);e.addPlaylistEntry(new Wv(n))}function vnt(e,t,n){let i=qn(t,\"duration\",ve.gx),o=In(t,\"flyToMode\",ve.gx),r={kml:{}};Q0e(t,r,n),J0e(t,r,n);let s=r.kml.lookAt||r.kml.camera,a=new Iv(i,o,s);e.addPlaylistEntry(a)}function J0e(e,t,n){let i=Xi(e,\"Camera\",ve.kml);if(l(i)){let o=g(qn(i,\"longitude\",ve.kml),0),r=g(qn(i,\"latitude\",ve.kml),0),s=g(qn(i,\"altitude\",ve.kml),0),a=g(qn(i,\"heading\",ve.kml),0),c=g(qn(i,\"tilt\",ve.kml),0),d=g(qn(i,\"roll\",ve.kml),0),u=h.fromDegrees(o,r,s,n),m=ja.fromDegrees(a,c-90,d);t.kml.camera=new dv(u,m)}}function Q0e(e,t,n){let i=Xi(e,\"LookAt\",ve.kml);if(l(i)){let o=g(qn(i,\"longitude\",ve.kml),0),r=g(qn(i,\"latitude\",ve.kml),0),s=g(qn(i,\"altitude\",ve.kml),0),a=qn(i,\"heading\",ve.kml),c=qn(i,\"tilt\",ve.kml),d=g(qn(i,\"range\",ve.kml),0);c=P.toRadians(g(c,0)),a=P.toRadians(g(a,0));let u=new Ou(a,c-P.PI_OVER_TWO,d),m=h.fromDegrees(o,r,s,n);t.kml.lookAt=new Gv(m,u)}}function wnt(e,t,n,i){let o=n.screenOverlayContainer;if(!l(o))return;let r=n.sourceResource,s=n.uriResolver,a=Xi(t,\"Icon\",ve.kml),c=qQ(a,e,r,s,!1);if(!l(c))return;let d=document.createElement(\"img\");e._screenOverlays.push(d),d.src=c.url,d.onload=function(){let u=[\"position: absolute\"],m=Xi(t,\"screenXY\",ve.kml),p=Xi(t,\"overlayXY\",ve.kml),b=Xi(t,\"size\",ve.kml),f,x,_,C,V,L;l(b)&&(f=lg(b,\"x\"),x=lg(b,\"y\"),_=Cs(b,\"xunits\"),C=Cs(b,\"yunits\"),l(f)&&f!==-1&&f!==0&&(_===\"fraction\"?V=`width: ${Math.floor(f*100)}%`:_===\"pixels\"&&(V=`width: ${f}px`),u.push(V)),l(x)&&x!==-1&&x!==0&&(C===\"fraction\"?L=`height: ${Math.floor(x*100)}%`:C===\"pixels\"&&(L=`height: ${x}px`),u.push(L))),d.style=u.join(\";\");let R=0,G=d.height;l(p)&&(f=lg(p,\"x\"),x=lg(p,\"y\"),_=Cs(p,\"xunits\"),C=Cs(p,\"yunits\"),l(f)&&(_===\"fraction\"?R=f*d.width:(_===\"pixels\"||_===\"insetPixels\")&&(R=f)),l(x)&&(C===\"fraction\"?G=x*d.height:(C===\"pixels\"||C===\"insetPixels\")&&(G=x))),l(m)&&(f=lg(m,\"x\"),x=lg(m,\"y\"),_=Cs(m,\"xunits\"),C=Cs(m,\"yunits\"),l(f)&&(_===\"fraction\"?V=`left: calc(${Math.floor(f*100)}% - ${R}px)`:_===\"pixels\"?V=`left: ${f-R}px`:_===\"insetPixels\"&&(V=`right: ${f-R}px`),u.push(V)),l(x)&&(C===\"fraction\"?L=`bottom: calc(${Math.floor(x*100)}% - ${G}px)`:C===\"pixels\"?L=`bottom: ${x-G}px`:C===\"insetPixels\"&&(L=`top: ${x-G}px`),u.push(L))),d.style=u.join(\";\")},o.appendChild(d)}function Fnt(e,t,n,i){let r=OU(e,t,n).entity,s,a=!1,c=e._ellipsoid,d=kU(Xi(t,\"LatLonQuad\",ve.gx),c),u=qn(t,\"drawOrder\",ve.kml);if(l(d))s=jQ(),s.hierarchy=new Ra(d),s.zIndex=u,r.polygon=s,a=!0;else{s=new Gm,s.zIndex=u,r.rectangle=s;let f=Xi(t,\"LatLonBox\",ve.kml);if(l(f)){let x=qn(f,\"west\",ve.kml),_=qn(f,\"south\",ve.kml),C=qn(f,\"east\",ve.kml),V=qn(f,\"north\",ve.kml);l(x)&&(x=P.negativePiToPi(P.toRadians(x))),l(_)&&(_=P.clampToLatitudeRange(P.toRadians(_))),l(C)&&(C=P.negativePiToPi(P.toRadians(C))),l(V)&&(V=P.clampToLatitudeRange(P.toRadians(V))),s.coordinates=new le(x,_,C,V);let L=qn(f,\"rotation\",ve.kml);if(l(L)){let R=P.toRadians(L);s.rotation=R,s.stRotation=R}}}let m=Xi(t,\"Icon\",ve.kml),p=qQ(m,e,n.sourceResource,n.uriResolver,!0);if(l(p)){a&&wt(\"kml-gx:LatLonQuad\",\"KML - gx:LatLonQuad Icon does not support texture projection.\");let f=qn(m,\"x\",ve.gx),x=qn(m,\"y\",ve.gx),_=qn(m,\"w\",ve.gx),C=qn(m,\"h\",ve.gx);(l(f)||l(x)||l(_)||l(C))&&wt(\"kml-groundOverlay-xywh\",\"KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays\"),s.material=p,s.material.color=uT(t,\"color\",ve.kml),s.material.transparent=!0}else s.material=uT(t,\"color\",ve.kml);let b=In(t,\"altitudeMode\",ve.kml);l(b)?b===\"absolute\"?(s.height=qn(t,\"altitude\",ve.kml),s.zIndex=void 0):b!==\"clampToGround\"&&wt(\"kml-altitudeMode-unknown\",`KML - Unknown altitudeMode: ${b}`):(b=In(t,\"altitudeMode\",ve.gx),b===\"relativeToSeaFloor\"?(wt(\"kml-altitudeMode-relativeToSeaFloor\",\"KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute.\"),s.height=qn(t,\"altitude\",ve.kml),s.zIndex=void 0):b===\"clampToSeaFloor\"?wt(\"kml-altitudeMode-clampToSeaFloor\",\"KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround.\"):l(b)&&wt(\"kml-altitudeMode-unknown\",`KML - Unknown altitudeMode: ${b}`))}function j0e(e,t,n,i){e._unsupportedNode.raiseEvent(e,n.parentEntity,t,n.entityCollection,n.styleCollection,n.sourceResource,n.uriResolver),wt(`kml-unsupportedFeature-${t.nodeName}`,`KML - Unsupported feature: ${t.nodeName}`)}var dg={INTERVAL:0,EXPIRE:1,STOP:2};function DU(e){if(!l(e)||e.length===0)return\"\";let t=e[0];return(t===\"&\"||t===\"?\")&&(e=e.substring(1)),e}var Ant=new le,gV=new he,YQ=new D,Mnt=new h;function e4(e,t,n,i,o,r){function s(d){return d<-P.PI_OVER_TWO?-P.PI_OVER_TWO:d>P.PI_OVER_TWO?P.PI_OVER_TWO:d}function a(d){return d>P.PI?d-P.TWO_PI:d<-P.PI?d+P.TWO_PI:d}let c=jg(e.queryParameters);if(c=c.replace(/%5B/g,\"[\").replace(/%5D/g,\"]\"),l(t)&&t._mode!==ie.MORPHING){let d,u;if(o=g(o,Ant),l(n)&&(YQ.x=n.clientWidth*.5,YQ.y=n.clientHeight*.5,d=t.pickEllipsoid(YQ,r,Mnt)),l(d)?u=r.cartesianToCartographic(d,gV):(u=le.center(o,gV),d=r.cartographicToCartesian(u)),l(i)&&!P.equalsEpsilon(i,1,P.EPSILON9)){let C=o.width*i*.5,V=o.height*i*.5;o=new le(a(u.longitude-C),s(u.latitude-V),a(u.longitude+C),s(u.latitude+V))}c=c.replace(\"[bboxWest]\",P.toDegrees(o.west).toString()),c=c.replace(\"[bboxSouth]\",P.toDegrees(o.south).toString()),c=c.replace(\"[bboxEast]\",P.toDegrees(o.east).toString()),c=c.replace(\"[bboxNorth]\",P.toDegrees(o.north).toString());let m=P.toDegrees(u.longitude).toString(),p=P.toDegrees(u.latitude).toString();c=c.replace(\"[lookatLon]\",m),c=c.replace(\"[lookatLat]\",p),c=c.replace(\"[lookatTilt]\",P.toDegrees(t.pitch).toString()),c=c.replace(\"[lookatHeading]\",P.toDegrees(t.heading).toString()),c=c.replace(\"[lookatRange]\",h.distance(t.positionWC,d)),c=c.replace(\"[lookatTerrainLon]\",m),c=c.replace(\"[lookatTerrainLat]\",p),c=c.replace(\"[lookatTerrainAlt]\",u.height.toString()),r.cartesianToCartographic(t.positionWC,gV),c=c.replace(\"[cameraLon]\",P.toDegrees(gV.longitude).toString()),c=c.replace(\"[cameraLat]\",P.toDegrees(gV.latitude).toString()),c=c.replace(\"[cameraAlt]\",P.toDegrees(gV.height).toString());let b=t.frustum,f=b.aspectRatio,x=\"\",_=\"\";if(l(f)){let C=P.toDegrees(b.fov);f>1?(x=C,_=C/f):(_=C,x=C*f)}c=c.replace(\"[horizFov]\",x.toString()),c=c.replace(\"[vertFov]\",_.toString())}else c=c.replace(\"[bboxWest]\",\"-180\"),c=c.replace(\"[bboxSouth]\",\"-90\"),c=c.replace(\"[bboxEast]\",\"180\"),c=c.replace(\"[bboxNorth]\",\"90\"),c=c.replace(\"[lookatLon]\",\"\"),c=c.replace(\"[lookatLat]\",\"\"),c=c.replace(\"[lookatRange]\",\"\"),c=c.replace(\"[lookatTilt]\",\"\"),c=c.replace(\"[lookatHeading]\",\"\"),c=c.replace(\"[lookatTerrainLon]\",\"\"),c=c.replace(\"[lookatTerrainLat]\",\"\"),c=c.replace(\"[lookatTerrainAlt]\",\"\"),c=c.replace(\"[cameraLon]\",\"\"),c=c.replace(\"[cameraLat]\",\"\"),c=c.replace(\"[cameraAlt]\",\"\"),c=c.replace(\"[horizFov]\",\"\"),c=c.replace(\"[vertFov]\",\"\");l(n)?(c=c.replace(\"[horizPixels]\",n.clientWidth),c=c.replace(\"[vertPixels]\",n.clientHeight)):(c=c.replace(\"[horizPixels]\",\"\"),c=c.replace(\"[vertPixels]\",\"\")),c=c.replace(\"[terrainEnabled]\",\"1\"),c=c.replace(\"[clientVersion]\",\"1\"),c=c.replace(\"[kmlVersion]\",\"2.2\"),c=c.replace(\"[clientName]\",\"Cesium\"),c=c.replace(\"[language]\",\"English\"),e.setQueryParameters(nd(c))}function Nnt(e,t,n,i){let r=OU(e,t,n).entity,s=n.sourceResource,a=n.uriResolver,c=Xi(t,\"Link\",ve.kml);if(l(c)||(c=Xi(t,\"Url\",ve.kml)),l(c)){let d=In(c,\"href\",ve.kml),u,m;if(l(d)){let p=d;if(d=QQ(d,s,n.uriResolver),/^data:/.test(d.getUrlComponent()))/\\.kmz/i.test(s.getUrlComponent())||(p=s.getDerivedResource({url:p}));else{if(p=d.clone(),u=In(c,\"viewRefreshMode\",ve.kml),u===\"onRegion\"){wt(\"kml-refrehMode-onRegion\",\"KML - Unsupported viewRefreshMode: onRegion\");return}m=g(In(c,\"viewBoundScale\",ve.kml),1);let _=u===\"onStop\"?\"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]\":\"\",C=g(In(c,\"viewFormat\",ve.kml),_),V=In(c,\"httpQuery\",ve.kml);l(C)&&d.setQueryParameters(nd(DU(C))),l(V)&&d.setQueryParameters(nd(DU(V)));let L=e._ellipsoid;e4(d,e.camera,e.canvas,m,e._lastCameraView.bbox,L)}let b={sourceUri:p,uriResolver:a,context:r.id,screenOverlayContainer:n.screenOverlayContainer},f=new Us,x=t4(e,f,d,b).then(function(_){let C=e._entityCollection,V=f.values;C.suspendEvents();for(let G=0;G<V.length;G++){let X=V[G];l(X.parent)||(X.parent=r,n4(X)),C.add(X)}C.resumeEvents();let L=In(c,\"refreshMode\",ve.kml),R=g(qn(c,\"refreshInterval\",ve.kml),0);if(L===\"onInterval\"&&R>0||L===\"onExpire\"||u===\"onStop\"){let G=Xi(_,\"NetworkLinkControl\",ve.kml),X=l(G),v=te.now(),W={id:Bn(),href:d,cookie:{},lastUpdated:v,updating:!1,entity:r,viewBoundScale:m,needsUpdate:!1,cameraUpdateTime:v},F=0;if(X&&(W.cookie=nd(g(In(G,\"cookie\",ve.kml),\"\")),F=g(qn(G,\"minRefreshPeriod\",ve.kml),0)),L===\"onInterval\")X&&(R=Math.max(F,R)),W.refreshMode=dg.INTERVAL,W.time=R;else if(L===\"onExpire\"){let A;if(X&&(A=In(G,\"expires\",ve.kml)),l(A))try{let y=te.fromIso8601(A),Z=te.secondsDifference(y,v);Z>0&&Z<F&&te.addSeconds(v,F,y),W.refreshMode=dg.EXPIRE,W.time=y}catch{wt(\"kml-refreshMode-onInterval-onExpire\",\"KML - NetworkLinkControl expires is not a valid date\")}else wt(\"kml-refreshMode-onExpire\",\"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element\")}else l(e.camera)?(W.refreshMode=dg.STOP,W.time=g(qn(c,\"viewRefreshTime\",ve.kml),0)):wt(\"kml-refrehMode-onStop-noCamera\",\"A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.\");l(W.refreshMode)&&e._networkLinks.set(W.id,W)}}).catch(function(_){wt(`An error occured during loading ${d.url}`),e._error.raiseEvent(e,_)});i.addPromise(x)}}}function knt(e,t,n,i){let o=JQ[t.localName];return l(o)?o(e,t,n,i):j0e(e,t,n,i)}function HQ(e,t,n,i,o,r,s){t.removeAll();let a=n.documentElement,c=a.localName===\"Document\"?a:Xi(a,\"Document\",ve.kml),d=In(c,\"name\",ve.kml);l(d)||(d=G0(i.getUrlComponent())),l(e._name)||(e._name=d);let u=new Md._DeferredLoading(e),m=new Us(e);return Promise.all(Y0e(e,n,m,i,!1,o)).then(function(){let p=n.documentElement;if(p.localName===\"kml\"){let f=p.childNodes;for(let x=0;x<f.length;x++){let _=f[x];if(l(JQ[_.localName])){p=_;break}}}let b={parentEntity:void 0,entityCollection:t,styleCollection:m,sourceResource:i,uriResolver:o,context:s,screenOverlayContainer:r};return t.suspendEvents(),knt(e,p,b,u),t.resumeEvents(),u.wait().then(function(){return n.documentElement})})}function Unt(e,t,n,i,o){let r=on(\"ThirdParty/Workers/z-worker-pako.js\");dV({workerScripts:{deflate:[r,\"./pako_deflate.min.js\"],inflate:[r,\"./pako_inflate.min.js\"]}});let s=new PU(new O0(n));return Promise.resolve(s.getEntries()).then(function(a){let c=[],d={},u;for(let m=0;m<a.length;m++){let p=a[m];p.directory||(/\\.kml$/i.test(p.filename)&&(!l(u)||!/\\//i.test(p.filename))?(l(u)&&c.push(DQ(u,d)),u=p):c.push(DQ(p,d)))}return l(u)&&c.push(hnt(u,d)),Promise.all(c).then(function(){if(s.close(),!l(d.kml))throw new ue(\"KMZ file does not contain a KML document.\");return d.keys=Object.keys(d),HQ(e,t,d.kml,i,d,o)})})}function t4(e,t,n,i){i=g(i,g.EMPTY_OBJECT);let o=i.sourceUri,r=i.uriResolver,s=i.context,a=i.screenOverlayContainer,c=n;if(typeof n==\"string\"||n instanceof Xe){n=Xe.createIfNeeded(n),c=n.fetchBlob(),o=g(o,n.clone());let d=e._resourceCredits,u=n.credits;if(l(u)){let m=u.length;for(let p=0;p<m;p++)d.push(u[p])}}else o=g(o,Xe.DEFAULT.clone());return o=Xe.createIfNeeded(o),l(a)&&(a=Xn(a)),Promise.resolve(c).then(function(d){return d instanceof Blob?unt(d).then(function(u){return u?Unt(e,t,d,o,a):mnt(d).then(function(m){m=N0e(m),m=k0e(m);let p,b;try{p=KQ.parseFromString(m,\"application/xml\")}catch(f){b=f.toString()}if(l(b)||p.body||p.documentElement.tagName===\"parsererror\"){let f=l(b)?b:p.documentElement.firstChild.nodeValue;throw f||(f=p.body.innerText),new ue(f)}return HQ(e,t,p,o,r,a,s)})}):HQ(e,t,d,o,r,a,s)}).catch(function(d){return e._error.raiseEvent(e,d),console.log(d),Promise.reject(d)})}function Md(e){e=g(e,g.EMPTY_OBJECT);let t=e.camera,n=e.canvas;this._changed=new ge,this._error=new ge,this._loading=new ge,this._refresh=new ge,this._unsupportedNode=new ge,this._clock=void 0,this._entityCollection=new Us(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new k0,this._networkLinks=new Lt,this._entityCluster=new Sd,this.canvas=n,this.camera=t,this._lastCameraView={position:l(t)?h.clone(t.positionWC):void 0,direction:l(t)?h.clone(t.directionWC):void 0,up:l(t)?h.clone(t.upWC):void 0,bbox:l(t)?t.computeViewRectangle():le.clone(le.MAX_VALUE)},this._ellipsoid=g(e.ellipsoid,oe.WGS84);let i=e.credit;typeof i==\"string\"&&(i=new Zt(i)),this._credit=i,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}Md.load=function(e,t){return t=g(t,g.EMPTY_OBJECT),new Md(t).load(e,t)};Object.defineProperties(Md.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}});Md.prototype.load=function(e,t){t=g(t,g.EMPTY_OBJECT),Pr.setLoading(this,!0);let n=this._name;this._name=void 0,this._clampToGround=g(t.clampToGround,!1);let i=this;return t4(this,this._entityCollection,e,t).then(function(){let o,r=i._entityCollection.computeAvailability(),s=r.start,a=r.stop,c=te.equals(s,Be.MINIMUM_VALUE),d=te.equals(a,Be.MAXIMUM_VALUE);if(!c||!d){let m;c&&(m=new Date,m.setHours(0,0,0,0),s=te.fromDate(m)),d&&(m=new Date,m.setHours(24,0,0,0),a=te.fromDate(m)),o=new nh,o.startTime=s,o.stopTime=a,o.currentTime=te.clone(s),o.clockRange=vr.LOOP_STOP,o.clockStep=mo.SYSTEM_CLOCK_MULTIPLIER,o.multiplier=Math.round(Math.min(Math.max(te.secondsDifference(a,s)/60,1),31556900))}let u=!1;return o!==i._clock&&(i._clock=o,u=!0),n!==i._name&&(u=!0),u&&i._changed.raiseEvent(i),Pr.setLoading(i,!1),i}).catch(function(o){return Pr.setLoading(i,!1),i._error.raiseEvent(i,o),console.log(o),Promise.reject(o)})};Md.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};function n4(e){let t=e.parent;if(l(t)){let n=t.availability;if(l(n)){let i=e.availability;l(i)?i.intersect(n):e.availability=n}}}function Dnt(e,t,n,i,o){return function(r){if(!i.contains(t.id))return;let s=!1,a=Xi(r,\"NetworkLinkControl\",ve.kml),c=l(a),d=0;if(c){if(l(Xi(a,\"Update\",ve.kml))){wt(\"kml-networkLinkControl-update\",\"KML - NetworkLinkControl updates aren't supported.\"),t.updating=!1,i.remove(t.id);return}t.cookie=nd(g(In(a,\"cookie\",ve.kml),\"\")),d=g(qn(a,\"minRefreshPeriod\",ve.kml),0)}let u=te.now(),m=t.refreshMode;if(m===dg.INTERVAL)l(a)&&(t.time=Math.max(d,t.time));else if(m===dg.EXPIRE){let v;if(l(a)&&(v=In(a,\"expires\",ve.kml)),l(v))try{let W=te.fromIso8601(v),F=te.secondsDifference(W,u);F>0&&F<d&&te.addSeconds(u,d,W),t.time=W}catch{wt(\"kml-networkLinkControl-expires\",\"KML - NetworkLinkControl expires is not a valid date\"),s=!0}else wt(\"kml-refreshMode-onExpire\",\"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 66,
    "total_chunks": 194,
    "chunk_size": 24192,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.685Z"
  },
  "content": "version 1 is supported. Version ${c} is not.`);o+=yX,o+=yX;let d=a.getUint32(o,!0);o+=yX;let u=n.queryParameters.compositeIndex;l(u)?u=`${u}_`:u=\"\";let m=[];m.length=d;for(let f=0;f<d;++f){let x=Wm(s,o),_=a.getUint32(o+yX*2,!0),C=r[x],V=`${u}${f}`,L=n.getDerivedResource({queryParameters:{compositeIndex:V}});if(l(C))m[f]=Promise.resolve(C(e,t,L,i,o));else throw new ue(`Unknown tile content type, ${x}, inside Composite tile`);o+=_}let p=await Promise.all(m);return new hu(e,t,n,p)};hu.prototype.hasProperty=function(e,t){return!1};hu.prototype.getFeature=function(e){};hu.prototype.applyDebugSettings=function(e,t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyDebugSettings(e,t)};hu.prototype.applyStyle=function(e){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].applyStyle(e)};hu.prototype.update=function(e,t){let n=this._contents,i=n.length,o=!0;for(let r=0;r<i;++r)n[r].update(e,t),o=o&&n[r].ready;!this._ready&&o&&(this._ready=!0)};hu.prototype.pick=function(e,t,n){if(!this._ready)return;let i,o=Number.POSITIVE_INFINITY,r=this._contents,s=r.length;for(let a=0;a<s;++a){let c=r[a].pick(e,t,n);if(!l(c))continue;let d=h.distance(e.origin,c);d<o&&(i=c,o=d)}if(l(i))return n};hu.prototype.isDestroyed=function(){return!1};hu.prototype.destroy=function(){let e=this._contents,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return me(this)};var gX=hu;var $in=T(S(),1);var Vtn=T(S(),1);function tve(e,t,n){return JSON.parse(Zl(e,t,n))}var Go=tve;var Xnn=T(S(),1);var Atn=T(S(),1);function oc(e){this._id=Bn();let t=e.featuresLength;this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[];let n,i;if(t>0){let o=Math.min(t,Yt.maximumTextureSize),r=Math.ceil(t/Yt.maximumTextureSize),s=1/o,a=s*.5,c=1/r,d=c*.5;n=new D(o,r),i=new se(s,a,c,d)}this._translucentFeaturesLength=0,this._featuresLength=t,this._textureDimensions=n,this._textureStep=i,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}Object.defineProperties(oc.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return l(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),l(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}});oc.DEFAULT_COLOR_VALUE=O.WHITE;oc.DEFAULT_SHOW_VALUE=!0;function wie(e){let t=e._textureDimensions;return t.x*t.y*4}function Fie(e){if(!l(e._batchValues)){let t=wie(e),n=new Uint8Array(t).fill(255);e._batchValues=n}return e._batchValues}function Aie(e){if(!l(e._showAlphaProperties)){let t=2*e._featuresLength,n=new Uint8Array(t).fill(255);e._showAlphaProperties=n}return e._showAlphaProperties}oc.prototype.setShow=function(e,t){if(t&&!l(this._showAlphaProperties))return;let n=Aie(this),i=e*2,o=t?255:0;if(n[i]!==o){n[i]=o;let r=Fie(this),s=e*4+3;r[s]=t?n[i+1]:0,this._batchValuesDirty=!0}};oc.prototype.setAllShow=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setShow(n,e)};oc.prototype.getShow=function(e){if(!l(this._showAlphaProperties))return!0;let t=e*2;return this._showAlphaProperties[t]===255};var nve=new Array(4);oc.prototype.setColor=function(e,t){if(O.equals(t,oc.DEFAULT_COLOR_VALUE)&&!l(this._batchValues))return;let n=t.toBytes(nve),i=n[3],o=Fie(this),r=e*4,s=Aie(this),a=e*2;if(o[r]!==n[0]||o[r+1]!==n[1]||o[r+2]!==n[2]||s[a+1]!==i){o[r]=n[0],o[r+1]=n[1],o[r+2]=n[2];let c=s[a+1]!==255,d=s[a]!==0;o[r+3]=d?i:0,s[a+1]=i;let u=i!==255;u&&!c?++this._translucentFeaturesLength:!u&&c&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,l(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}};oc.prototype.setAllColor=function(e){let t=this._featuresLength;for(let n=0;n<t;++n)this.setColor(n,e)};oc.prototype.getColor=function(e,t){if(!l(this._batchValues))return O.clone(oc.DEFAULT_COLOR_VALUE,t);let n=this._batchValues,i=e*4,o=this._showAlphaProperties,r=e*2;return O.fromBytes(n[i],n[i+1],n[i+2],o[r+1],t)};oc.prototype.getPickColor=function(e){return this._pickIds[e]};function Mie(e,t,n){let i=e._textureDimensions;return new Ft({context:t,pixelFormat:at.RGBA,pixelDatatype:Qe.UNSIGNED_BYTE,source:{width:i.x,height:i.y,arrayBufferView:n},flipY:!1,sampler:mn.NEAREST})}function ive(e,t){let n=e._featuresLength;if(!l(e._pickTexture)&&n>0){let i=e._pickIds,o=wie(e),r=new Uint8Array(o),s=e._owner,a=e._statistics;for(let c=0;c<n;++c){let d=t.createPickId(s.getFeature(c));i.push(d);let u=d.color,m=c*4;r[m]=O.floatToByte(u.red),r[m+1]=O.floatToByte(u.green),r[m+2]=O.floatToByte(u.blue),r[m+3]=O.floatToByte(u.alpha)}e._pickTexture=Mie(e,t,r),l(a)&&(a.batchTableByteLength+=e._pickTexture.sizeInBytes)}}function ove(e){let t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}oc.prototype.update=function(e,t){let n=t.context;this._defaultTexture=n.defaultTexture;let i=t.passes;(i.pick||i.postProcess)&&ive(this,n),this._batchValuesDirty&&(this._batchValuesDirty=!1,l(this._batchTexture)||(this._batchTexture=Mie(this,n,this._batchValues),l(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),ove(this))};oc.prototype.isDestroyed=function(){return!1};oc.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let e=this._pickIds,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return me(this)};var Yc=oc;var nnn=T(S(),1);var ztn=T(S(),1);var rve={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sve={SCALAR:void 0,VEC2:D,VEC3:h,VEC4:se,MAT2:qi,MAT3:$,MAT4:M};function ave(e){let t=e.componentType,n;typeof t==\"string\"?n=Q.fromName(t):n=t;let i=rve[e.type],o=sve[e.type];return{componentsPerAttribute:i,classType:o,createArrayBufferView:function(r,s,a){return Q.createArrayBufferView(n,r,s,i*a)}}}var hd=ave;function vp(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,cve(this,e.extension,e.binaryBody)}Object.defineProperties(vp.prototype,{byteLength:{get:function(){return this._byteLength}}});function cve(e,t,n){let i,o,r,s=t.instancesLength,a=t.classes,c=t.classIds,d=t.parentCounts,u=t.parentIds,m=s,p=0;l(c.byteOffset)&&(c.componentType=g(c.componentType,Q.UNSIGNED_SHORT),c.type=tn.SCALAR,r=hd(c),c=r.createArrayBufferView(n.buffer,n.byteOffset+c.byteOffset,s),p+=c.byteLength);let b;if(l(d)){for(l(d.byteOffset)&&(d.componentType=g(d.componentType,Q.UNSIGNED_SHORT),d.type=tn.SCALAR,r=hd(d),d=r.createArrayBufferView(n.buffer,n.byteOffset+d.byteOffset,s),p+=d.byteLength),b=new Uint16Array(s),m=0,i=0;i<s;++i)b[i]=m,m+=d[i];p+=b.byteLength}l(u)&&l(u.byteOffset)&&(u.componentType=g(u.componentType,Q.UNSIGNED_SHORT),u.type=tn.SCALAR,r=hd(u),u=r.createArrayBufferView(n.buffer,n.byteOffset+u.byteOffset,m),p+=u.byteLength);let f=a.length;for(i=0;i<f;++i){let C=a[i].length,V=a[i].instances,L=lve(C,V,n);p+=dve(L),a[i].instances=Ct(L,V)}let x=new Array(f).fill(0),_=new Uint16Array(s);for(i=0;i<s;++i)o=c[i],_[i]=x[o],++x[o];p+=_.byteLength,e._classes=a,e._classIds=c,e._classIndexes=_,e._parentCounts=d,e._parentIndexes=b,e._parentIds=u,e._byteLength=p}function lve(e,t,n){let i;for(let o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r.byteOffset;if(l(s)){let a=r.componentType,c=r.type;if(!l(a))throw new ue(\"componentType is required.\");if(!l(c))throw new ue(\"type is required.\");if(!l(n))throw new ue(`Property ${o} requires a batch table binary.`);let d=hd(r),u=d.componentsPerAttribute,m=d.classType,p=d.createArrayBufferView(n.buffer,n.byteOffset+s,e);l(i)||(i={}),i[o]={typedArray:p,componentCount:u,type:m}}}return i}function dve(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}var uve=[],mve=[],hve=0;function fve(e,t,n){let i=e._classIds,o=e._parentCounts,r=e._parentIds,s=e._parentIndexes,a=i.length,c=uve;c.length=Math.max(c.length,a);let d=++hve,u=mve;for(u.length=0,u.push(t);u.length>0;){if(t=u.pop(),c[t]===d)continue;c[t]=d;let m=n(e,t);if(l(m))return m;let p=o[t],b=s[t];for(let f=0;f<p;++f){let x=r[b+f];x!==t&&u.push(x)}}}function pve(e,t,n){let i=!0;for(;i;){let o=n(e,t);if(l(o))return o;let r=e._parentIds[t];i=r!==t,t=r}}function xX(e,t,n){let i=e._parentCounts,o=e._parentIds;if(l(o)){if(l(i))return fve(e,t,n)}else return n(e,t);return pve(e,t,n)}vp.prototype.hasProperty=function(e,t){let n=xX(this,e,function(i,o){let r=i._classIds[o],s=i._classes[r].instances;if(l(s[t]))return!0});return l(n)};vp.prototype.propertyExists=function(e){let t=this._classes,n=t.length;for(let i=0;i<n;++i){let o=t[i].instances;if(l(o[e]))return!0}return!1};vp.prototype.getPropertyIds=function(e,t){return t=l(t)?t:[],t.length=0,xX(this,e,function(n,i){let o=n._classIds[i],r=n._classes[o].instances;for(let s in r)r.hasOwnProperty(s)&&t.indexOf(s)===-1&&t.push(s)}),t};vp.prototype.getProperty=function(e,t){return xX(this,e,function(n,i){let o=n._classIds[i],r=n._classes[o],s=n._classIndexes[i],a=r.instances[t];if(l(a))return l(a.typedArray)?bve(a,s):Oe(a[s],!0)})};function bve(e,t){let n=e.typedArray,i=e.componentCount;return i===1?n[t]:e.type.unpack(n,t*i)}vp.prototype.setProperty=function(e,t,n){let i=xX(this,e,function(o,r){let s=o._classIds[r],a=o._classes[s],c=o._classIndexes[r],d=a.instances[t];if(l(d))return l(d.typedArray)?yve(d,c,n):d[c]=Oe(n,!0),!0});return l(i)};function yve(e,t,n){let i=e.typedArray,o=e.componentCount;o===1?i[t]=n:e.type.pack(n,i,t*o)}vp.prototype.isClass=function(e,t){let n=xX(this,e,function(i,o){let r=i._classIds[o];if(i._classes[r].name===t)return!0});return l(n)};vp.prototype.getClassName=function(e){let t=this._classIds[e];return this._classes[t].name};var Nx=vp;var onn=T(S(),1),gve={HIGHLIGHT:0,REPLACE:1,MIX:2},Rl=Object.freeze(gve);var HO=Yc.DEFAULT_COLOR_VALUE,KO=Yc.DEFAULT_SHOW_VALUE;function uo(e,t,n,i,o){this.featuresLength=t;let r;l(n)&&(r=n.extensions),this._extensions=g(r,{});let s=xve(n);this._properties=s,this._batchTableHierarchy=_ve(this,n,i);let a=kie(t,s,i);this._binaryPropertiesByteLength=Tve(a),this._batchTableBinaryProperties=a,this._content=e,this._batchTexture=new Yc({featuresLength:t,colorChangedCallback:o,owner:e,statistics:e.tileset.statistics})}uo._deprecationWarning=Is;Object.defineProperties(uo.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return l(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}});function xve(e){let t={};if(!l(e))return t;for(let n in e)e.hasOwnProperty(n)&&n!==\"HIERARCHY\"&&n!==\"extensions\"&&n!==\"extras\"&&(t[n]=Oe(e[n],!0));return t}function _ve(e,t,n){if(!l(t))return;let i=e._extensions[\"3DTILES_batch_table_hierarchy\"],o=t.HIERARCHY;if(l(o)&&(uo._deprecationWarning(\"batchTableHierarchyExtension\",\"The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead.\"),e._extensions[\"3DTILES_batch_table_hierarchy\"]=o,i=o),!!l(i))return new Nx({extension:i,binaryBody:n})}function kie(e,t,n){let i;for(let o in t)if(t.hasOwnProperty(o)){let r=t[o],s=r.byteOffset;if(l(s)){let a=r.componentType,c=r.type;if(!l(a))throw new ue(\"componentType is required.\");if(!l(c))throw new ue(\"type is required.\");if(!l(n))throw new ue(`Property ${o} requires a batch table binary.`);let d=hd(r),u=d.componentsPerAttribute,m=d.classType,p=d.createArrayBufferView(n.buffer,n.byteOffset+s,e);l(i)||(i={}),i[o]={typedArray:p,componentCount:u,type:m}}}return i}function Tve(e){if(!l(e))return 0;let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n].typedArray.byteLength);return t}uo.getBinaryProperties=function(e,t,n){return kie(e,t,n)};uo.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)};uo.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)};uo.prototype.getShow=function(e){return this._batchTexture.getShow(e)};uo.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)};uo.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)};uo.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)};uo.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};var Sve=new O;uo.prototype.applyStyle=function(e){if(!l(e)){this.setAllColor(HO),this.setAllShow(KO);return}let t=this._content,n=this.featuresLength;for(let i=0;i<n;++i){let o=t.getFeature(i),r=l(e.color)?g(e.color.evaluateColor(o,Sve),HO):HO,s=l(e.show)?g(e.show.evaluate(o),KO):KO;this.setColor(i,r),this.setShow(i,s)}};function Cve(e,t){let n=e.typedArray,i=e.componentCount;return i===1?n[t]:e.type.unpack(n,t*i)}function Vve(e,t,n){let i=e.typedArray,o=e.componentCount;o===1?i[t]=n:e.type.pack(n,i,t*o)}uo.prototype.isClass=function(e,t){let n=this._batchTableHierarchy;return l(n)?n.isClass(e,t):!1};uo.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t};uo.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(l(t))return t.getClassName(e)};uo.prototype.hasProperty=function(e,t){return l(this._properties[t])||l(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)};uo.prototype.hasPropertyBySemantic=function(){return!1};uo.prototype.getPropertyIds=function(e,t){t=l(t)?t:[],t.length=0;let n=Object.keys(this._properties);return t.push.apply(t,n),l(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,n)),t};uo.prototype.getPropertyBySemantic=function(e,t){};uo.prototype.getProperty=function(e,t){if(l(this._batchTableBinaryProperties)){let i=this._batchTableBinaryProperties[t];if(l(i))return Cve(i,e)}let n=this._properties[t];if(l(n))return Oe(n[e],!0);if(l(this._batchTableHierarchy)){let i=this._batchTableHierarchy.getProperty(e,t);if(l(i))return i}};uo.prototype.setProperty=function(e,t,n){let i=this.featuresLength;if(l(this._batchTableBinaryProperties)){let r=this._batchTableBinaryProperties[t];if(l(r)){Vve(r,e,n);return}}if(l(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))return;let o=this._properties[t];l(o)||(this._properties[t]=new Array(i),o=this._properties[t]),o[e]=Oe(n,!0)};function Lve(e){return e._batchTexture.textureDimensions.y===1?`uniform vec4 tile_textureStep; vec2 computeSt(float batchId) { float stepX = tile_textureStep.x; float centerX = tile_textureStep.y; return vec2(centerX + (batchId * stepX), 0.5); } `:`uniform vec4 tile_textureStep; uniform vec2 tile_textureDimensions; vec2 computeSt(float batchId) { float stepX = tile_textureStep.x; float centerX = tile_textureStep.y; float stepY = tile_textureStep.z; float centerY = tile_textureStep.w; float xId = mod(batchId, tile_textureDimensions.x); float yId = floor(batchId / tile_textureDimensions.x); return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); } `}uo.prototype.getVertexShaderCallback=function(e,t,n){if(this.featuresLength===0)return;let i=this;return function(o){let r=Uie(o,n,!1),s;return Yt.maximumVertexTextureImageUnits>0?(s=\"\",e&&(s+=`uniform bool tile_translucentCommand; `),s+=`uniform sampler2D tile_batchTexture; out vec4 tile_featureColor; out vec2 tile_featureSt; void main() { vec2 st = computeSt(${t}); vec4 featureProperties = texture(tile_batchTexture, st); tile_color(featureProperties); float show = ceil(featureProperties.a); gl_Position *= show; `,e&&(s+=` bool isStyleTranslucent = (featureProperties.a != 1.0); if (czm_pass == czm_passTranslucent) { if (!isStyleTranslucent && !tile_translucentCommand) { gl_Position *= 0.0; } } else { if (isStyleTranslucent) { gl_Position *= 0.0; } } `),s+=` tile_featureColor = featureProperties; tile_featureSt = st; }`):s=`out vec2 tile_featureSt; void main() { tile_color(vec4(1.0)); tile_featureSt = computeSt(${t}); }`,`${r} ${Lve(i)}${s}`}};function Nie(e,t){return e=Ue.replaceMain(e,\"tile_main\"),t?`${e}uniform float tile_colorBlend; void tile_color(vec4 tile_featureColor) { tile_main(); tile_featureColor = czm_gammaCorrect(tile_featureColor); out_FragColor.a *= tile_featureColor.a; float highlight = ceil(tile_colorBlend); out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); } `:`${e}void tile_color(vec4 tile_featureColor) { tile_main(); } `}function Zve(e,t){let n=`texture(${t}`,i=0,o=e.indexOf(n,i),r;for(;o>-1;){let s=0;for(let d=o;d<e.length;++d){let u=e.charAt(d);if(u===\"(\")++s;else if(u===\")\"&&(--s,s===0)){r=d+1;break}}let c=`tile_diffuse_final(${e.slice(o,r)}, tile_diffuse)`;e=e.slice(0,o)+c+e.slice(r),i=o+c.length,o=e.indexOf(n,i)}return e}function Uie(e,t,n){if(!l(t))return Nie(e,n);let i=new RegExp(`(uniform|attribute|in)\\\\s+(vec[34]|sampler2D)\\\\s+${t};`),o=e.match(i);if(!l(o))return Nie(e,n);let r=o[0],s=o[2];e=Ue.replaceMain(e,\"tile_main\"),e=e.replace(r,\"\");let a=`bool isWhite(vec3 color) { return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); } vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) { vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; return vec4(diffuse.rgb, sourceDiffuse.a); } `,c=` tile_featureColor = czm_gammaCorrect(tile_featureColor); out_FragColor.a *= tile_featureColor.a; float highlight = ceil(tile_colorBlend); out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); `,d;if(s===\"vec3\"||s===\"vec4\"){let u=s===\"vec3\"?`vec4(${t}, 1.0)`:t,m=s===\"vec3\"?\"tile_diffuse.xyz\":\"tile_diffuse\";i=new RegExp(t,\"g\"),e=e.replace(i,m),d=` vec4 source = ${u}; tile_diffuse = tile_diffuse_final(source, tile_featureColor); tile_main(); `}else s===\"sampler2D\"&&(e=Zve(e,t),d=` tile_diffuse = tile_featureColor; tile_main(); `);return e=`uniform float tile_colorBlend; vec4 tile_diffuse = vec4(1.0); ${a}${r} ${e} void tile_color(vec4 tile_featureColor) { ${d}`,n&&(e+=c),e+=`} `,e}uo.prototype.getFragmentShaderCallback=function(e,t,n){if(this.featuresLength!==0)return function(i){return i=Uie(i,t,!0),Yt.maximumVertexTextureImageUnits>0?(i+=`uniform sampler2D tile_pickTexture; in vec2 tile_featureSt; in vec4 tile_featureColor; void main() { tile_color(tile_featureColor); `,n&&(i+=` out_FragColor.rgb *= out_FragColor.a; `),i+=\"}\"):(e&&(i+=`uniform bool tile_translucentCommand; `),i+=`uniform sampler2D tile_pickTexture; uniform sampler2D tile_batchTexture; in vec2 tile_featureSt; void main() { vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); if (featureProperties.a == 0.0) { discard; } `,e&&(i+=` bool isStyleTranslucent = (featureProperties.a != 1.0); if (czm_pass == czm_passTranslucent) { if (!isStyleTranslucent && !tile_translucentCommand) { discard; } } else { if (isStyleTranslucent) { discard; } } `),i+=` tile_color(featureProperties); `,n&&(i+=` out_FragColor.rgb *= out_FragColor.a; `),i+=`} `),i}};uo.prototype.getClassificationFragmentShaderCallback=function(){if(this.featuresLength!==0)return function(e){return e=Ue.replaceMain(e,\"tile_main\"),Yt.maximumVertexTextureImageUnits>0?e+=`uniform sampler2D tile_pickTexture; in vec2 tile_featureSt; in vec4 tile_featureColor; void main() { tile_main(); out_FragColor = tile_featureColor; out_FragColor.rgb *= out_FragColor.a; }`:e+=`uniform sampler2D tile_batchTexture; uniform sampler2D tile_pickTexture; in vec2 tile_featureSt; void main() { tile_main(); vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); if (featureProperties.a == 0.0) { discard; } out_FragColor = featureProperties; out_FragColor.rgb *= out_FragColor.a; } `,e}};function Rve(e){let t=e._content.tileset,n=t.colorBlendMode,i=t.colorBlendAmount;if(n===Rl.HIGHLIGHT)return 0;if(n===Rl.REPLACE)return 1;if(n===Rl.MIX)return P.clamp(i,P.EPSILON4,1)}uo.prototype.getUniformMapCallback=function(){if(this.featuresLength===0)return;let e=this;return function(t){return Ct(t,{tile_batchTexture:function(){return g(e._batchTexture.batchTexture,e._batchTexture.defaultTexture)},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return Rve(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}})}};uo.prototype.getPickId=function(){return\"texture(tile_pickTexture, tile_featureSt)\"};var Db={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};uo.prototype.addDerivedCommands=function(e,t){let n=e.commandList,i=n.length,o=this._content._tile,r=o._finalResolution,s=o.tileset,a=s.isSkippingLevelOfDetail&&s.hasMixedContent&&e.context.stencilBuffer,c=Gve(this);for(let d=t;d<i;++d){let u=n[d];if(u.pass===Ze.COMPUTE)continue;let m=u.derivedCommands.tileset;(!l(m)||u.dirty)&&(m={},u.derivedCommands.tileset=m,m.originalCommand=Eve(u),u.dirty=!1);let p=m.originalCommand;c!==Db.ALL_OPAQUE&&u.pass!==Ze.TRANSLUCENT&&(l(m.translucent)||(m.translucent=Xve(p))),c!==Db.ALL_TRANSLUCENT&&u.pass!==Ze.TRANSLUCENT&&(l(m.opaque)||(m.opaque=Ive(p)),a&&(r||(l(m.zback)||(m.zback=Pve(e.context,p)),s._backfaceCommands.push(m.zback)),(!l(m.stencil)||o._selectionDepth!==wve(m.stencil))&&(u.renderState.depthMask?m.stencil=vve(p,o._selectionDepth):m.stencil=m.opaque)));let b=a?m.stencil:m.opaque,f=m.translucent;u.pass!==Ze.TRANSLUCENT?(c===Db.ALL_OPAQUE&&(n[d]=b),c===Db.ALL_TRANSLUCENT&&(n[d]=f),c===Db.OPAQUE_AND_TRANSLUCENT&&(n[d]=b,n.push(f))):n[d]=p}};function Gve(e){let t=e._batchTexture.translucentFeaturesLength;return t===0?Db.ALL_OPAQUE:t===e.featuresLength?Db.ALL_TRANSLUCENT:Db.OPAQUE_AND_TRANSLUCENT}function Eve(e){let t=je.shallowClone(e),n=t.pass===Ze.TRANSLUCENT;return t.uniformMap=l(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return n},t}function Xve(e){let t=je.shallowClone(e);return t.pass=Ze.TRANSLUCENT,t.renderState=Fve(e.renderState),t}function Ive(e){let t=je.shallowClone(e);return t.renderState=Ave(e.renderState),t}function Wve(e,t){let n=e.shaderCache.getDerivedShaderProgram(t,\"zBackfaceLogDepth\");if(!l(n)){let i=t.fragmentShaderSource.clone();i.defines=l(i.defines)?i.defines.slice(0):[],i.defines.push(\"POLYGON_OFFSET\"),n=e.shaderCache.createDerivedShaderProgram(t,\"zBackfaceLogDepth\",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:i,attributeLocations:t._attributeLocations})}return n}function Pve(e,t){let n=je.shallowClone(t),i=Oe(n.renderState,!0);i.cull.enabled=!0,i.cull.face=mi.FRONT,i.colorMask={red:!1,green:!1,blue:!1,alpha:!1},i.polygonOffset={enabled:!0,factor:5,units:5},i.stencilTest=Mt.setCesium3DTileBit(),i.stencilMask=Mt.CESIUM_3D_TILE_MASK,n.renderState=Ne.fromCache(i),n.castShadows=!1,n.receiveShadows=!1,n.uniformMap=Oe(t.uniformMap);let o=new D(5,5);return n.uniformMap.u_polygonOffset=function(){return o},n.shaderProgram=Wve(e,t.shaderProgram),n}function vve(e,t){let n=je.shallowClone(e),i=Oe(n.renderState,!0);return i.stencilTest.enabled=!0,i.stencilTest.mask=Mt.SKIP_LOD_MASK,i.stencilTest.reference=Mt.CESIUM_3D_TILE_MASK|t<<Mt.SKIP_LOD_BIT_SHIFT,i.stencilTest.frontFunction=vn.GREATER_OR_EQUAL,i.stencilTest.frontOperation.zPass=dt.REPLACE,i.stencilTest.backFunction=vn.GREATER_OR_EQUAL,i.stencilTest.backOperation.zPass=dt.REPLACE,i.stencilMask=Mt.CESIUM_3D_TILE_MASK|Mt.SKIP_LOD_MASK,n.renderState=Ne.fromCache(i),n}function wve(e){return(e.renderState.stencilTest.reference&Mt.SKIP_LOD_MASK)>>>Mt.SKIP_LOD_BIT_SHIFT}function Fve(e){let t=Oe(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=un.ALPHA_BLEND,t.stencilTest=Mt.setCesium3DTileBit(),t.stencilMask=Mt.CESIUM_3D_TILE_MASK,Ne.fromCache(t)}function Ave(e){let t=Oe(e,!0);return t.stencilTest=Mt.setCesium3DTileBit(),t.stencilMask=Mt.CESIUM_3D_TILE_MASK,Ne.fromCache(t)}uo.prototype.update=function(e,t){this._batchTexture.update(e,t)};uo.prototype.isDestroyed=function(){return!1};uo.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),me(this)};var"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 104,
    "total_chunks": 194,
    "chunk_size": 47646,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.709Z"
  },
  "content": "o(){n.raiseEvent(e)}let r=[];t.removeAll();let s=i.length;for(let a=0;a<s;a++){let c=i.get(a);l(c.data)&&r.indexOf(c.data)===-1&&t.add(c.data.definitionChanged,o)}}function v_(){this._eventHelper=new Xr,this._definitionChanged=new ge,this._intervals=new Wr,this._intervals.changedEvent.addEventListener(v_.prototype._intervalsChanged,this)}Object.defineProperties(v_.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});v_.prototype.getValue=function(e,t){let n=this._intervals.findDataForIntervalContainingDate(e);if(l(n))return n.getValue(e,t)};v_.prototype.equals=function(e){return this===e||e instanceof v_&&this._intervals.equals(e._intervals,K.equals)};v_.prototype._intervalsChanged=function(){oQe(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var hc=v_;function Py(){this._definitionChanged=new ge,this._composite=new hc,this._composite.definitionChanged.addEventListener(Py.prototype._raiseDefinitionChanged,this)}Object.defineProperties(Py.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});Py.prototype.getType=function(e){let t=this._composite._intervals.findDataForIntervalContainingDate(e);if(l(t))return t.getType(e)};Py.prototype.getValue=function(e,t){let n=this._composite._intervals.findDataForIntervalContainingDate(e);if(l(n))return n.getValue(e,t)};Py.prototype.equals=function(e){return this===e||e instanceof Py&&this._composite.equals(e._composite,K.equals)};Py.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var u1=Py;var uDn=T(S(),1);function vy(e){this._referenceFrame=g(e,no.FIXED),this._definitionChanged=new ge,this._composite=new hc,this._composite.definitionChanged.addEventListener(vy.prototype._raiseDefinitionChanged,this)}Object.defineProperties(vy.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}});vy.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,no.FIXED,t)};vy.prototype.getValueInReferenceFrame=function(e,t,n){let i=this._composite._intervals.findDataForIntervalContainingDate(e);if(l(i))return i.getValueInReferenceFrame(e,t,n)};vy.prototype.equals=function(e){return this===e||e instanceof vy&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,K.equals)};vy.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var aa=vy;var aBn=T(S(),1);var s3n=T(S(),1);var hDn=T(S(),1),rQe={ROUNDED:0,MITERED:1,BEVELED:2},Gi=Object.freeze(rQe);var MDn=T(S(),1);var GDn=T(S(),1);var ca=[new h,new h],sQe=new h,aQe=new h,cQe=new h,lQe=new h,dQe=new h,uQe=new h,mQe=new h,hQe=new h,fQe=new h,m1=new h,JN=new h,O2={},cK=new he;function pQe(e,t){let n=new Array(e.length);for(let i=0;i<e.length;i++){let o=e[i];cK=t.cartesianToCartographic(o,cK),n[i]=cK.height,e[i]=t.scaleToGeodeticSurface(o,o)}return n}function lK(e,t,n,i){let o=e[0],r=e[1],s=h.angleBetween(o,r),a=Math.ceil(s/i),c=new Array(a),d;if(t===n){for(d=0;d<a;d++)c[d]=t;return c.push(n),c}let m=(n-t)/a;for(d=1;d<a;d++){let p=t+d*m;c[d]=p}return c[0]=t,c.push(n),c}var QN=new h,jN=new h;function bQe(e,t,n,i){let o=new Dr(n,i),r=o.projectPointOntoPlane(h.add(n,e,QN),QN),s=o.projectPointOntoPlane(h.add(n,t,jN),jN),a=D.angleBetween(r,s);return s.x*r.y-s.y*r.x>=0?-a:a}var yQe=new h(-1,0,0),w_=new M,gQe=new M,dK=new $,xQe=$.IDENTITY.clone(),_Qe=new h,TQe=new se,kle=new h;function S0(e,t,n,i,o,r,s,a){let c=_Qe,d=TQe;w_=Wt.eastNorthUpToFixedFrame(e,o,w_),c=M.multiplyByPointAsVector(w_,yQe,c),c=h.normalize(c,c);let u=bQe(c,t,e,o);dK=$.fromRotationZ(u,dK),kle.z=r,w_=M.multiplyTransformation(w_,M.fromRotationTranslation(dK,kle,gQe),w_);let m=xQe;m[0]=s;for(let p=0;p<a;p++)for(let b=0;b<n.length;b+=3)d=h.fromArray(n,b,d),d=$.multiplyByVector(m,d,d),d=M.multiplyByPoint(w_,d,d),i.push(d.x,d.y,d.z);return i}var SQe=new h;function uK(e,t,n,i,o,r,s){for(let a=0;a<e.length;a+=3){let c=h.fromArray(e,a,SQe);i=S0(c,t,n,i,o,r[a/3],s,1)}return i}function CQe(e,t){let n=e.length,i=new Array(n*6),o=0,r=t.x+t.width/2,s=t.y+t.height/2,a=e[0];i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s;for(let c=1;c<n;c++){a=e[c];let d=a.x-r,u=a.y-s;i[o++]=d,i[o++]=0,i[o++]=u,i[o++]=d,i[o++]=0,i[o++]=u}return a=e[0],i[o++]=a.x-r,i[o++]=0,i[o++]=a.y-s,i}function Ule(e,t){let n=e.length,i=new Array(n*3),o=0,r=t.x+t.width/2,s=t.y+t.height/2;for(let a=0;a<n;a++)i[o++]=e[a].x-r,i[o++]=0,i[o++]=e[a].y-s;return i}var Dle=new Fe,Ble=new h,Yle=new $;function Ole(e,t,n,i,o,r,s,a,c,d){let u=h.angleBetween(h.subtract(t,e,m1),h.subtract(n,e,JN)),m=i===Gi.BEVELED?0:Math.ceil(u/P.toRadians(5)),p;o?p=$.fromQuaternion(Fe.fromAxisAngle(h.negate(e,m1),u/(m+1),Dle),Yle):p=$.fromQuaternion(Fe.fromAxisAngle(e,u/(m+1),Dle),Yle);let b,f;if(t=h.clone(t,Ble),m>0){let x=d?2:1;for(let _=0;_<m;_++)t=$.multiplyByVector(p,t,t),b=h.subtract(t,e,m1),b=h.normalize(b,b),o||(b=h.negate(b,b)),f=r.scaleToGeodeticSurface(t,JN),s=S0(f,b,a,s,r,c,1,x)}else b=h.subtract(t,e,m1),b=h.normalize(b,b),o||(b=h.negate(b,b)),f=r.scaleToGeodeticSurface(t,JN),s=S0(f,b,a,s,r,c,1,1),n=h.clone(n,Ble),b=h.subtract(n,e,m1),b=h.normalize(b,b),o||(b=h.negate(b,b)),f=r.scaleToGeodeticSurface(n,JN),s=S0(f,b,a,s,r,c,1,1);return s}O2.removeDuplicatesFromShape=function(e){let t=e.length,n=[];for(let i=t-1,o=0;o<t;i=o++){let r=e[i],s=e[o];D.equals(r,s)||n.push(s)}return n};O2.angleIsGreaterThanPi=function(e,t,n,i){let o=new Dr(n,i),r=o.projectPointOntoPlane(h.add(n,e,QN),QN),s=o.projectPointOntoPlane(h.add(n,t,jN),jN);return s.x*r.y-s.y*r.x>=0};var VQe=new h,LQe=new h;O2.computePositions=function(e,t,n,i,o){let r=i._ellipsoid,s=pQe(e,r),a=i._granularity,c=i._cornerType,d=o?CQe(t,n):Ule(t,n),u=o?Ule(t,n):void 0,m=n.height/2,p=n.width/2,b=e.length,f=[],x=o?[]:void 0,_=sQe,C=aQe,V=cQe,L=lQe,R=dQe,G=uQe,X=mQe,v=hQe,W=fQe,F=e[0],A=e[1];L=r.geodeticSurfaceNormal(F,L),_=h.subtract(A,F,_),_=h.normalize(_,_),v=h.cross(L,_,v),v=h.normalize(v,v);let y=s[0],Z=s[1];o&&(x=S0(F,v,u,x,r,y+m,1,1)),W=h.clone(F,W),F=A,C=h.negate(_,C);let E,I;for(let B=1;B<b-1;B++){let U=o?2:1;if(A=e[B+1],F.equals(A)){wt(\"Positions are too close and are considered equivalent with rounding error.\");continue}_=h.subtract(A,F,_),_=h.normalize(_,_),V=h.add(_,C,V),V=h.normalize(V,V),L=r.geodeticSurfaceNormal(F,L);let Y=h.multiplyByScalar(L,h.dot(_,L),VQe);h.subtract(_,Y,Y),h.normalize(Y,Y);let N=h.multiplyByScalar(L,h.dot(C,L),LQe);if(h.subtract(C,N,N),h.normalize(N,N),!P.equalsEpsilon(Math.abs(h.dot(Y,N)),1,P.EPSILON7)){V=h.cross(V,L,V),V=h.cross(L,V,V),V=h.normalize(V,V);let z=1/Math.max(.25,h.magnitude(h.cross(V,C,m1))),ee=O2.angleIsGreaterThanPi(_,C,F,r);ee?(R=h.add(F,h.multiplyByScalar(V,z*p,V),R),G=h.add(R,h.multiplyByScalar(v,p,G),G),ca[0]=h.clone(W,ca[0]),ca[1]=h.clone(G,ca[1]),E=lK(ca,y+m,Z+m,a),I=Ri.generateArc({positions:ca,granularity:a,ellipsoid:r}),f=uK(I,v,d,f,r,E,1),v=h.cross(L,_,v),v=h.normalize(v,v),X=h.add(R,h.multiplyByScalar(v,p,X),X),c===Gi.ROUNDED||c===Gi.BEVELED?Ole(R,G,X,c,ee,r,f,d,Z+m,o):(V=h.negate(V,V),f=S0(F,V,d,f,r,Z+m,z,U)),W=h.clone(X,W)):(R=h.add(F,h.multiplyByScalar(V,z*p,V),R),G=h.add(R,h.multiplyByScalar(v,-p,G),G),ca[0]=h.clone(W,ca[0]),ca[1]=h.clone(G,ca[1]),E=lK(ca,y+m,Z+m,a),I=Ri.generateArc({positions:ca,granularity:a,ellipsoid:r}),f=uK(I,v,d,f,r,E,1),v=h.cross(L,_,v),v=h.normalize(v,v),X=h.add(R,h.multiplyByScalar(v,-p,X),X),c===Gi.ROUNDED||c===Gi.BEVELED?Ole(R,G,X,c,ee,r,f,d,Z+m,o):f=S0(F,V,d,f,r,Z+m,z,U),W=h.clone(X,W)),C=h.negate(_,C)}else f=S0(W,v,d,f,r,y+m,1,1),W=F;y=Z,Z=s[B+1],F=A}ca[0]=h.clone(W,ca[0]),ca[1]=h.clone(F,ca[1]),E=lK(ca,y+m,Z+m,a),I=Ri.generateArc({positions:ca,granularity:a,ellipsoid:r}),f=uK(I,v,d,f,r,E,1),o&&(x=S0(F,v,u,x,r,Z+m,1,1)),b=f.length;let w=o?b+x.length:b,k=new Float64Array(w);return k.set(f),o&&k.set(x,b),k};var jm=O2;var hK={},h1=new h,Qle=new h,ZQe=new h,zle=new h,Jc=[new h,new h],jle=new h,qle=new h,$le=new h,RQe=new h,GQe=new h,EQe=new h,XQe=new h,IQe=new h,WQe=new h,PQe=new h,Hle=new Fe,Kle=new $;function qN(e,t,n,i,o){let r=h.angleBetween(h.subtract(t,e,h1),h.subtract(n,e,Qle)),s=i===Gi.BEVELED?1:Math.ceil(r/P.toRadians(5))+1,a=s*3,c=new Array(a);c[a-3]=n.x,c[a-2]=n.y,c[a-1]=n.z;let d;o?d=$.fromQuaternion(Fe.fromAxisAngle(h.negate(e,h1),r/s,Hle),Kle):d=$.fromQuaternion(Fe.fromAxisAngle(e,r/s,Hle),Kle);let u=0;t=h.clone(t,h1);for(let m=0;m<s;m++)t=$.multiplyByVector(d,t,t),c[u++]=t.x,c[u++]=t.y,c[u++]=t.z;return c}function vQe(e){let t=jle,n=qle,i=$le,o=e[1];n=h.fromArray(e[1],o.length-3,n),i=h.fromArray(e[0],0,i),t=h.midpoint(n,i,t);let r=qN(t,n,i,Gi.ROUNDED,!1),s=e.length-1,a=e[s-1];o=e[s],n=h.fromArray(a,a.length-3,n),i=h.fromArray(o,0,i),t=h.midpoint(n,i,t);let c=qN(t,n,i,Gi.ROUNDED,!1);return[r,c]}function Jle(e,t,n,i){let o=h1;return i?o=h.add(e,t,o):(t=h.negate(t,t),o=h.add(e,t,o)),[o.x,o.y,o.z,n.x,n.y,n.z]}function mK(e,t,n,i){let o=new Array(e.length),r=new Array(e.length),s=h.multiplyByScalar(t,n,h1),a=h.negate(s,Qle),c=0,d=e.length-1;for(let u=0;u<e.length;u+=3){let m=h.fromArray(e,u,ZQe),p=h.add(m,a,zle);o[c++]=p.x,o[c++]=p.y,o[c++]=p.z;let b=h.add(m,s,zle);r[d--]=b.z,r[d--]=b.y,r[d--]=b.x}return i.push(o,r),i}hK.addAttribute=function(e,t,n,i){let o=t.x,r=t.y,s=t.z;l(n)&&(e[n]=o,e[n+1]=r,e[n+2]=s),l(i)&&(e[i]=s,e[i-1]=r,e[i-2]=o)};var wQe=new h,FQe=new h;hK.computePositions=function(e){let t=e.granularity,n=e.positions,i=e.ellipsoid,o=e.width/2,r=e.cornerType,s=e.saveAttributes,a=jle,c=qle,d=$le,u=RQe,m=GQe,p=EQe,b=XQe,f=IQe,x=WQe,_=PQe,C=[],V=s?[]:void 0,L=s?[]:void 0,R=n[0],G=n[1];c=h.normalize(h.subtract(G,R,c),c),a=i.geodeticSurfaceNormal(R,a),u=h.normalize(h.cross(a,c,u),u),s&&(V.push(u.x,u.y,u.z),L.push(a.x,a.y,a.z)),b=h.clone(R,b),R=G,d=h.negate(c,d);let X,v=[],W,F=n.length;for(W=1;W<F-1;W++){a=i.geodeticSurfaceNormal(R,a),G=n[W+1],c=h.normalize(h.subtract(G,R,c),c),m=h.normalize(h.add(c,d,m),m);let y=h.multiplyByScalar(a,h.dot(c,a),wQe);h.subtract(c,y,y),h.normalize(y,y);let Z=h.multiplyByScalar(a,h.dot(d,a),FQe);if(h.subtract(d,Z,Z),h.normalize(Z,Z),!P.equalsEpsilon(Math.abs(h.dot(y,Z)),1,P.EPSILON7)){m=h.cross(m,a,m),m=h.cross(a,m,m),m=h.normalize(m,m);let I=o/Math.max(.25,h.magnitude(h.cross(m,d,h1))),w=jm.angleIsGreaterThanPi(c,d,R,i);m=h.multiplyByScalar(m,I,m),w?(f=h.add(R,m,f),_=h.add(f,h.multiplyByScalar(u,o,_),_),x=h.add(f,h.multiplyByScalar(u,o*2,x),x),Jc[0]=h.clone(b,Jc[0]),Jc[1]=h.clone(_,Jc[1]),X=Ri.generateArc({positions:Jc,granularity:t,ellipsoid:i}),C=mK(X,u,o,C),s&&(V.push(u.x,u.y,u.z),L.push(a.x,a.y,a.z)),p=h.clone(x,p),u=h.normalize(h.cross(a,c,u),u),x=h.add(f,h.multiplyByScalar(u,o*2,x),x),b=h.add(f,h.multiplyByScalar(u,o,b),b),r===Gi.ROUNDED||r===Gi.BEVELED?v.push({leftPositions:qN(f,p,x,r,w)}):v.push({leftPositions:Jle(R,h.negate(m,m),x,w)})):(x=h.add(R,m,x),_=h.add(x,h.negate(h.multiplyByScalar(u,o,_),_),_),f=h.add(x,h.negate(h.multiplyByScalar(u,o*2,f),f),f),Jc[0]=h.clone(b,Jc[0]),Jc[1]=h.clone(_,Jc[1]),X=Ri.generateArc({positions:Jc,granularity:t,ellipsoid:i}),C=mK(X,u,o,C),s&&(V.push(u.x,u.y,u.z),L.push(a.x,a.y,a.z)),p=h.clone(f,p),u=h.normalize(h.cross(a,c,u),u),f=h.add(x,h.negate(h.multiplyByScalar(u,o*2,f),f),f),b=h.add(x,h.negate(h.multiplyByScalar(u,o,b),b),b),r===Gi.ROUNDED||r===Gi.BEVELED?v.push({rightPositions:qN(x,p,f,r,w)}):v.push({rightPositions:Jle(R,m,f,w)})),d=h.negate(c,d)}R=G}a=i.geodeticSurfaceNormal(R,a),Jc[0]=h.clone(b,Jc[0]),Jc[1]=h.clone(R,Jc[1]),X=Ri.generateArc({positions:Jc,granularity:t,ellipsoid:i}),C=mK(X,u,o,C),s&&(V.push(u.x,u.y,u.z),L.push(a.x,a.y,a.z));let A;return r===Gi.ROUNDED&&(A=vQe(C)),{positions:C,corners:v,lefts:V,normals:L,endPositions:A}};var Ai=hK;var nde=new h,ide=new h,$N=new h,ek=new h,AQe=new h,ode=new h,wy=new h,f1=new h;function rde(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}function qm(e,t,n,i,o,r){let s=e.normals,a=e.tangents,c=e.bitangents,d=h.normalize(h.cross(n,t,wy),wy);r.normal&&Ai.addAttribute(s,t,i,o),r.tangent&&Ai.addAttribute(a,d,i,o),r.bitangent&&Ai.addAttribute(c,n,i,o)}function sde(e,t,n){let i=e.positions,o=e.corners,r=e.endPositions,s=e.lefts,a=e.normals,c=new hn,d,u=0,m=0,p,b=0,f;for(p=0;p<i.length;p+=2)f=i[p].length-3,u+=f,b+=f*2,m+=i[p+1].length-3;for(u+=3,m+=3,p=0;p<o.length;p++){d=o[p];let q=o[p].leftPositions;l(q)?(f=q.length,u+=f,b+=f):(f=o[p].rightPositions.length,m+=f,b+=f)}let x=l(r),_;x&&(_=r[0].length-3,u+=_,m+=_,_/=3,b+=_*6);let C=u+m,V=new Float64Array(C),L=t.normal?new Float32Array(C):void 0,R=t.tangent?new Float32Array(C):void 0,G=t.bitangent?new Float32Array(C):void 0,X={normals:L,tangents:R,bitangents:G},v=0,W=C-1,F,A,y,Z,E=nde,I=ide,w,k,B=_/2,U=Ae.createTypedArray(C/3,b),Y=0;if(x){k=$N,w=ek;let q=r[0];for(E=h.fromArray(a,0,E),I=h.fromArray(s,0,I),p=0;p<B;p++)k=h.fromArray(q,(B-1-p)*3,k),w=h.fromArray(q,(B+p)*3,w),Ai.addAttribute(V,w,v),Ai.addAttribute(V,k,void 0,W),qm(X,E,I,v,W,t),A=v/3,Z=A+1,F=(W-2)/3,y=F-1,U[Y++]=F,U[Y++]=A,U[Y++]=y,U[Y++]=y,U[Y++]=A,U[Y++]=Z,v+=3,W-=3}let N=0,J=0,z=i[N++],ee=i[N++];V.set(z,v),V.set(ee,W-ee.length+1),I=h.fromArray(s,J,I);let H,j;for(f=ee.length-3,p=0;p<f;p+=3)H=n.geodeticSurfaceNormal(h.fromArray(z,p,wy),wy),j=n.geodeticSurfaceNormal(h.fromArray(ee,f-p,f1),f1),E=h.normalize(h.add(H,j,E),E),qm(X,E,I,v,W,t),A=v/3,Z=A+1,F=(W-2)/3,y=F-1,U[Y++]=F,U[Y++]=A,U[Y++]=y,U[Y++]=y,U[Y++]=A,U[Y++]=Z,v+=3,W-=3;for(H=n.geodeticSurfaceNormal(h.fromArray(z,f,wy),wy),j=n.geodeticSurfaceNormal(h.fromArray(ee,f,f1),f1),E=h.normalize(h.add(H,j,E),E),J+=3,p=0;p<o.length;p++){let q;d=o[p];let pe=d.leftPositions,_e=d.rightPositions,ae,ye,Te=ode,Le=$N,Re=ek;if(E=h.fromArray(a,J,E),l(pe)){for(qm(X,E,I,void 0,W,t),W-=3,ae=Z,ye=y,q=0;q<pe.length/3;q++)Te=h.fromArray(pe,q*3,Te),U[Y++]=ae,U[Y++]=ye-q-1,U[Y++]=ye-q,Ai.addAttribute(V,Te,void 0,W),Le=h.fromArray(V,(ye-q-1)*3,Le),Re=h.fromArray(V,ae*3,Re),I=h.normalize(h.subtract(Le,Re,I),I),qm(X,E,I,void 0,W,t),W-=3;Te=h.fromArray(V,ae*3,Te),Le=h.subtract(h.fromArray(V,ye*3,Le),Te,Le),Re=h.subtract(h.fromArray(V,(ye-q)*3,Re),Te,Re),I=h.normalize(h.add(Le,Re,I),I),qm(X,E,I,v,void 0,t),v+=3}else{for(qm(X,E,I,v,void 0,t),v+=3,ae=y,ye=Z,q=0;q<_e.length/3;q++)Te=h.fromArray(_e,q*3,Te),U[Y++]=ae,U[Y++]=ye+q,U[Y++]=ye+q+1,Ai.addAttribute(V,Te,v),Le=h.fromArray(V,ae*3,Le),Re=h.fromArray(V,(ye+q)*3,Re),I=h.normalize(h.subtract(Le,Re,I),I),qm(X,E,I,v,void 0,t),v+=3;Te=h.fromArray(V,ae*3,Te),Le=h.subtract(h.fromArray(V,(ye+q)*3,Le),Te,Le),Re=h.subtract(h.fromArray(V,ye*3,Re),Te,Re),I=h.normalize(h.negate(h.add(Re,Le,I),I),I),qm(X,E,I,void 0,W,t),W-=3}for(z=i[N++],ee=i[N++],z.splice(0,3),ee.splice(ee.length-3,3),V.set(z,v),V.set(ee,W-ee.length+1),f=ee.length-3,J+=3,I=h.fromArray(s,J,I),q=0;q<ee.length;q+=3)H=n.geodeticSurfaceNormal(h.fromArray(z,q,wy),wy),j=n.geodeticSurfaceNormal(h.fromArray(ee,f-q,f1),f1),E=h.normalize(h.add(H,j,E),E),qm(X,E,I,v,W,t),Z=v/3,A=Z-1,y=(W-2)/3,F=y+1,U[Y++]=F,U[Y++]=A,U[Y++]=y,U[Y++]=y,U[Y++]=A,U[Y++]=Z,v+=3,W-=3;v-=3,W+=3}if(E=h.fromArray(a,a.length-3,E),qm(X,E,I,v,W,t),x){v+=3,W-=3,k=$N,w=ek;let q=r[1];for(p=0;p<B;p++)k=h.fromArray(q,(_-p-1)*3,k),w=h.fromArray(q,p*3,w),Ai.addAttribute(V,k,void 0,W),Ai.addAttribute(V,w,v),qm(X,E,I,v,W,t),Z=v/3,A=Z-1,y=(W-2)/3,F=y+1,U[Y++]=F,U[Y++]=A,U[Y++]=y,U[Y++]=y,U[Y++]=A,U[Y++]=Z,v+=3,W-=3}if(c.position=new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:V}),t.st){let q=new Float32Array(C/3*2),pe,_e,ae=0;if(x){u/=3,m/=3;let ye=Math.PI/(_+1);_e=1/(u-_+1),pe=1/(m-_+1);let Te,Le=_/2;for(p=Le+1;p<_+1;p++)Te=P.PI_OVER_TWO+ye*p,q[ae++]=pe*(1+Math.cos(Te)),q[ae++]=.5*(1+Math.sin(Te));for(p=1;p<m-_+1;p++)q[ae++]=p*pe,q[ae++]=0;for(p=_;p>Le;p--)Te=P.PI_OVER_TWO-p*ye,q[ae++]=1-pe*(1+Math.cos(Te)),q[ae++]=.5*(1+Math.sin(Te));for(p=Le;p>0;p--)Te=P.PI_OVER_TWO-ye*p,q[ae++]=1-_e*(1+Math.cos(Te)),q[ae++]=.5*(1+Math.sin(Te));for(p=u-_;p>0;p--)q[ae++]=p*_e,q[ae++]=1;for(p=1;p<Le+1;p++)Te=P.PI_OVER_TWO+ye*p,q[ae++]=_e*(1+Math.cos(Te)),q[ae++]=.5*(1+Math.sin(Te))}else{for(u/=3,m/=3,_e=1/(u-1),pe=1/(m-1),p=0;p<m;p++)q[ae++]=p*pe,q[ae++]=0;for(p=u;p>0;p--)q[ae++]=(p-1)*_e,q[ae++]=1}c.st=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:2,values:q})}return t.normal&&(c.normal=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:X.normals})),t.tangent&&(c.tangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:X.tangents})),t.bitangent&&(c.bitangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:X.bitangents})),{attributes:c,indices:U}}function MQe(e,t){if(!t.normal&&!t.tangent&&!t.bitangent&&!t.st)return e;let n=e.position.values,i,o;(t.normal||t.bitangent)&&(i=e.normal.values,o=e.bitangent.values);let r=e.position.values.length/18,s=r*3,a=r*2,c=s*2,d;if(t.normal||t.bitangent||t.tangent){let u=t.normal?new Float32Array(s*6):void 0,m=t.tangent?new Float32Array(s*6):void 0,p=t.bitangent?new Float32Array(s*6):void 0,b=nde,f=ide,x=$N,_=ek,C=AQe,V=ode,L=c;for(d=0;d<s;d+=3){let R=L+c;b=h.fromArray(n,d,b),f=h.fromArray(n,d+s,f),x=h.fromArray(n,(d+3)%s,x),f=h.subtract(f,b,f),x=h.subtract(x,b,x),_=h.normalize(h.cross(f,x,_),_),t.normal&&(Ai.addAttribute(u,_,R),Ai.addAttribute(u,_,R+3),Ai.addAttribute(u,_,L),Ai.addAttribute(u,_,L+3)),(t.tangent||t.bitangent)&&(V=h.fromArray(i,d,V),t.bitangent&&(Ai.addAttribute(p,V,R),Ai.addAttribute(p,V,R+3),Ai.addAttribute(p,V,L),Ai.addAttribute(p,V,L+3)),t.tangent&&(C=h.normalize(h.cross(V,_,C),C),Ai.addAttribute(m,C,R),Ai.addAttribute(m,C,R+3),Ai.addAttribute(m,C,L),Ai.addAttribute(m,C,L+3))),L+=6}if(t.normal){for(u.set(i),d=0;d<s;d+=3)u[d+s]=-i[d],u[d+s+1]=-i[d+1],u[d+s+2]=-i[d+2];e.normal.values=u}else e.normal=void 0;if(t.bitangent?(p.set(o),p.set(o,s),e.bitangent.values=p):e.bitangent=void 0,t.tangent){let R=e.tangent.values;m.set(R),m.set(R,s),e.tangent.values=m}}if(t.st){let u=e.st.values,m=new Float32Array(a*6);m.set(u),m.set(u,a);let p=a*2;for(let b=0;b<2;b++){for(m[p++]=u[0],m[p++]=u[1],d=2;d<a;d+=2){let f=u[d],x=u[d+1];m[p++]=f,m[p++]=x,m[p++]=f,m[p++]=x}m[p++]=u[0],m[p++]=u[1]}e.st.values=m}return e}function fK(e,t,n){n[t++]=e[0],n[t++]=e[1],n[t++]=e[2];for(let i=3;i<e.length;i+=3){let o=e[i],r=e[i+1],s=e[i+2];n[t++]=o,n[t++]=r,n[t++]=s,n[t++]=o,n[t++]=r,n[t++]=s}return n[t++]=e[0],n[t++]=e[1],n[t++]=e[2],n}function NQe(e,t){let n=new Pe({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),i=e.ellipsoid,o=Ai.computePositions(e),r=sde(o,n,i),s=e.height,a=e.extrudedHeight,c=r.attributes,d=r.indices,u=c.position.values,m=u.length,p=new Float64Array(m*6),b=new Float64Array(m);b.set(u);let f=new Float64Array(m*4);u=si.scaleToGeodeticHeight(u,s,i),f=fK(u,0,f),b=si.scaleToGeodeticHeight(b,a,i),f=fK(b,m*2,f),p.set(u),p.set(b,m),p.set(f,m*2),c.position.values=p,c=MQe(c,t);let x,_=m/3;if(e.shadowVolume){let F=c.normal.values;m=F.length;let A=new Float32Array(m*6);for(x=0;x<m;x++)F[x]=-F[x];A.set(F,m),A=fK(F,m*4,A),c.extrudeDirection=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:A}),t.normal||(c.normal=void 0)}if(l(e.offsetAttribute)){let F=new Uint8Array(_*6);if(e.offsetAttribute===cn.TOP)F=F.fill(1,0,_).fill(1,_*2,_*4);else{let A=e.offsetAttribute===cn.NONE?0:1;F=F.fill(A)}c.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:F})}let C=d.length,V=_+_,L=Ae.createTypedArray(p.length/3,C*2+V*3);L.set(d);let R=C;for(x=0;x<C;x+=3){let F=d[x],A=d[x+1],y=d[x+2];L[R++]=y+_,L[R++]=A+_,L[R++]=F+_}let G,X,v,W;for(x=0;x<V;x+=2)G=x+V,X=G+V,v=G+1,W=X+1,L[R++]=G,L[R++]=X,L[R++]=v,L[R++]=v,L[R++]=X,L[R++]=W;return{attributes:c,indices:L}}var ede=new h,z2=new h,wu=new he;function tde(e,t,n,i,o,r){let s=h.subtract(t,e,ede);h.normalize(s,s);let a=n.geodeticSurfaceNormal(e,z2),c=h.cross(s,a,ede);h.multiplyByScalar(c,i,c);let d=o.latitude,u=o.longitude,m=r.latitude,p=r.longitude;h.add(e,c,z2),n.cartesianToCartographic(z2,wu);let b=wu.latitude,f=wu.longitude;d=Math.min(d,b),u=Math.min(u,f),m=Math.max(m,b),p=Math.max(p,f),h.subtract(e,c,z2),n.cartesianToCartographic(z2,wu),b=wu.latitude,f=wu.longitude,d=Math.min(d,b),u=Math.min(u,f),m=Math.max(m,b),p=Math.max(p,f),o.latitude=d,o.longitude=u,r.latitude=m,r.longitude=p}var vu=new h,H2=new h,Fl=new he,Al=new he;function ade(e,t,n,i,o){e=rde(e,t);let r=yo(e,h.equalsEpsilon),s=r.length;if(s<2||n<=0)return new le;let a=n*.5;Fl.latitude=Number.POSITIVE_INFINITY,Fl.longitude=Number.POSITIVE_INFINITY,Al.latitude=Number.NEGATIVE_INFINITY,Al.longitude=Number.NEGATIVE_INFINITY;let c,d;if(i===Gi.ROUNDED){let p=r[0];h.subtract(p,r[1],vu),h.normalize(vu,vu),h.multiplyByScalar(vu,a,vu),h.add(p,vu,H2),t.cartesianToCartographic(H2,wu),c=wu.latitude,d=wu.longitude,Fl.latitude=Math.min(Fl.latitude,c),Fl.longitude=Math.min(Fl.longitude,d),Al.latitude=Math.max(Al.latitude,c),Al.longitude=Math.max(Al.longitude,d)}for(let p=0;p<s-1;++p)tde(r[p],r[p+1],t,a,Fl,Al);let u=r[s-1];h.subtract(u,r[s-2],vu),h.normalize(vu,vu),h.multiplyByScalar(vu,a,vu),h.add(u,vu,H2),tde(u,H2,t,a,Fl,Al),i===Gi.ROUNDED&&(t.cartesianToCartographic(H2,wu),c=wu.latitude,d=wu.longitude,Fl.latitude=Math.min(Fl.latitude,c),Fl.longitude=Math.min(Fl.longitude,d),Al.latitude=Math.max(Al.latitude,c),Al.longitude=Math.max(Al.longitude,d));let m=l(o)?o:new le;return m.north=Al.latitude,m.south=Fl.latitude,m.east=Al.longitude,m.west=Fl.longitude,m}function V0(e){e=g(e,g.EMPTY_OBJECT);let t=e.positions,n=e.width,i=g(e.height,0),o=g(e.extrudedHeight,i);this._positions=t,this._ellipsoid=oe.clone(g(e.ellipsoid,oe.WGS84)),this._vertexFormat=Pe.clone(g(e.vertexFormat,Pe.DEFAULT)),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=g(e.cornerType,Gi.ROUNDED),this._granularity=g(e.granularity,P.RADIANS_PER_DEGREE),this._shadowVolume=g(e.shadowVolume,!1),this._workerName=\"createCorridorGeometry\",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*h.packedLength+oe.packedLength+Pe.packedLength+7}V0.pack=function(e,t,n){n=g(n,0);let i=e._positions,o=i.length;t[n++]=o;for(let r=0;r<o;++r,n+=h.packedLength)h.pack(i[r],t,n);return oe.pack(e._ellipsoid,t,n),n+=oe.packedLength,Pe.pack(e._vertexFormat,t,n),n+=Pe.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n++]=e._shadowVolume?1:0,t[n]=g(e._offsetAttribute,-1),t};var cde=oe.clone(oe.UNIT_SPHERE),lde=new Pe,C0={positions:void 0,ellipsoid:cde,vertexFormat:lde,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};V0.unpack=function(e,t,n){t=g(t,0);let i=e[t++],o=new Array(i);for(let f=0;f<i;++f,t+=h.packedLength)o[f]=h.unpack(e,t);let r=oe.unpack(e,t,cde);t+=oe.packedLength;let s=Pe.unpack(e,t,lde);t+=Pe.packedLength;let a=e[t++],c=e[t++],d=e[t++],u=e[t++],m=e[t++],p=e[t++]===1,b=e[t];return l(n)?(n._positions=o,n._ellipsoid=oe.clone(r,n._ellipsoid),n._vertexFormat=Pe.clone(s,n._vertexFormat),n._width=a,n._height=c,n._extrudedHeight=d,n._cornerType=u,n._granularity=m,n._shadowVolume=p,n._offsetAttribute=b===-1?void 0:b,n):(C0.positions=o,C0.width=a,C0.height=c,C0.extrudedHeight=d,C0.cornerType=u,C0.granularity=m,C0.shadowVolume=p,C0.offsetAttribute=b===-1?void 0:b,new V0(C0))};V0.computeRectangle=function(e,t){e=g(e,g.EMPTY_OBJECT);let n=e.positions,i=e.width,o=g(e.ellipsoid,oe.WGS84),r=g(e.cornerType,Gi.ROUNDED);return ade(n,o,i,r,t)};V0.createGeometry=function(e){let t=e._positions,n=e._width,i=e._ellipsoid;t=rde(t,i);let o=yo(t,h.equalsEpsilon);if(o.length<2||n<=0)return;let r=e._height,s=e._extrudedHeight,a=!P.equalsEpsilon(r,s,0,P.EPSILON2),c=e._vertexFormat,d={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0},u;if(a)d.height=r,d.extrudedHeight=s,d.shadowVolume=e._shadowVolume,d.offsetAttribute=e._offsetAttribute,u=NQe(d,c);else{let b=Ai.computePositions(d);if(u=sde(b,c,i),u.attributes.position.values=si.scaleToGeodeticHeight(u.attributes.position.values,r,i),l(e._offsetAttribute)){let f=e._offsetAttribute===cn.NONE?0:1,x=u.attributes.position.values.length,_=new Uint8Array(x/3).fill(f);u.attributes.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}}let m=u.attributes,p=ce.fromVertices(m.position.values,void 0,3);return c.position||(u.attributes.position.values=void 0),new ut({attributes:m,indices:u.indices,primitiveType:we.TRIANGLES,boundingSphere:p,offsetAttribute:e._offsetAttribute})};V0.createShadowVolume=function(e,t,n){let i=e._granularity,o=e._ellipsoid,r=t(i,o),s=n(i,o);return new V0({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:o,granularity:i,extrudedHeight:r,height:s,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(V0.prototype,{rectangle:{get:function(){return l(this._rectangle)||(this._rectangle=ade(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var F_=V0;var L3n=T(S(),1);var dde=new h,ude=new h,kQe=new h;function UQe(e,t){for(let n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}function mde(e,t){let n=[],i=e.positions,o=e.corners,r=e.endPositions,s=new hn,a,c=0,d=0,u,m=0,p;for(u=0;u<i.length;u+=2)p=i[u].length-3,c+=p,m+=p/3*4,d+=i[u+1].length-3;for(c+=3,d+=3,u=0;u<o.length;u++){a=o[u];let w=o[u].leftPositions;l(w)?(p=w.length,c+=p,m+=p/3*2):(p=o[u].rightPositions.length,d+=p,m+=p/3*2)}let b=l(r),f;b&&(f=r[0].length-3,c+=f,d+=f,f/=3,m+=f*4);let x=c+d,_=new Float64Array(x),C=0,V=x-1,L,R,G,X,v,W,F=f/2,A=Ae.createTypedArray(x/3,m+4),y=0;if(A[y++]=C/3,A[y++]=(V-2)/3,b){n.push(C/3),W=dde,v=ude;let w=r[0];for(u=0;u<F;u++)W=h.fromArray(w,(F-1-u)*3,W),v=h.fromArray(w,(F+u)*3,v),Ai.addAttribute(_,v,C),Ai.addAttribute(_,W,void 0,V),R=C/3,X=R+1,L=(V-2)/3,G=L-1,A[y++]=L,A[y++]=G,A[y++]=R,A[y++]=X,C+=3,V-=3}let Z=0,E=i[Z++],I=i[Z++];for(_.set(E,C),_.set(I,V-I.length+1),p=I.length-3,n.push(C/3,(V-2)/3),u=0;u<p;u+=3)R=C/3,X=R+1,L=(V-2)/3,G=L-1,A[y++]=L,A[y++]=G,A[y++]=R,A[y++]=X,C+=3,V-=3;for(u=0;u<o.length;u++){let w;a=o[u];let k=a.leftPositions,B=a.rightPositions,U,Y=kQe;if(l(k)){for(V-=3,U=G,n.push(X),w=0;w<k.length/3;w++)Y=h.fromArray(k,w*3,Y),A[y++]=U-w-1,A[y++]=U-w,Ai.addAttribute(_,Y,void 0,V),V-=3;n.push(U-Math.floor(k.length/6)),t===Gi.BEVELED&&n.push((V-2)/3+1),C+=3}else{for(C+=3,U=X,n.push(G),w=0;w<B.length/3;w++)Y=h.fromArray(B,w*3,Y),A[y++]=U+w,A[y++]=U+w+1,Ai.addAttribute(_,Y,C),C+=3;n.push(U+Math.floor(B.length/6)),t===Gi.BEVELED&&n.push(C/3-1),V-=3}for(E=i[Z++],I=i[Z++],E.splice(0,3),I.splice(I.length-3,3),_.set(E,C),_.set(I,V-I.length+1),p=I.length-3,w=0;w<I.length;w+=3)X=C/3,R=X-1,G=(V-2)/3,L=G+1,A[y++]=L,A[y++]=G,A[y++]=R,A[y++]=X,C+=3,V-=3;C-=3,V+=3,n.push(C/3,(V-2)/3)}if(b){C+=3,V-=3,W=dde,v=ude;let w=r[1];for(u=0;u<F;u++)W=h.fromArray(w,(f-u-1)*3,W),v=h.fromArray(w,u*3,v),Ai.addAttribute(_,W,void 0,V),Ai.addAttribute(_,v,C),X=C/3,R=X-1,G=(V-2)/3,L=G+1,A[y++]=L,A[y++]=G,A[y++]=R,A[y++]=X,C+=3,V-=3;n.push(C/3)}else n.push(C/3,(V-2)/3);return A[y++]=C/3,A[y++]=(V-2)/3,s.position=new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:_}),{attributes:s,indices:A,wallIndices:n}}function DQe(e){let t=e.ellipsoid,n=Ai.computePositions(e),i=mde(n,e.cornerType),o=i.wallIndices,r=e.height,s=e.extrudedHeight,a=i.attributes,c=i.indices,d=a.position.values,u=d.length,m=new Float64Array(u);m.set(d);let p=new Float64Array(u*2);if(d=si.scaleToGeodeticHeight(d,r,t),m=si.scaleToGeodeticHeight(m,s,t),p.set(d),p.set(m,u),a.position.values=p,u/=3,l(e.offsetAttribute)){let L=new Uint8Array(u*2);if(e.offsetAttribute===cn.TOP)L=L.fill(1,0,u);else{let R=e.offsetAttribute===cn.NONE?0:1;L=L.fill(R)}a.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}let b,f=c.length,x=Ae.createTypedArray(p.length/3,(f+o.length)*2);x.set(c);let _=f;for(b=0;b<f;b+=2){let L=c[b],R=c[b+1];x[_++]=L+u,x[_++]=R+u}let C,V;for(b=0;b<o.length;b++)C=o[b],V=C+u,x[_++]=C,x[_++]=V;return{attributes:a,indices:x}}function K2(e){e=g(e,g.EMPTY_OBJECT);let t=e.positions,n=e.width,i=g(e.height,0),o=g(e.extrudedHeight,i);this._positions=t,this._ellipsoid=oe.clone(g(e.ellipsoid,oe.WGS84)),this._width=n,this._height=Math.max(i,o),this._extrudedHeight=Math.min(i,o),this._cornerType=g(e.cornerType,Gi.ROUNDED),this._granularity=g(e.granularity,P.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName=\"createCorridorOutlineGeometry\",this.packedLength=1+t.length*h.packedLength+oe.packedLength+6}K2.pack=function(e,t,n){n=g(n,0);let i=e._positions,o=i.length;t[n++]=o;for(let r=0;r<o;++r,n+=h.packedLength)h.pack(i[r],t,n);return oe.pack(e._ellipsoid,t,n),n+=oe.packedLength,t[n++]=e._width,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._cornerType,t[n++]=e._granularity,t[n]=g(e._offsetAttribute,-1),t};var hde=oe.clone(oe.UNIT_SPHERE),Fy={positions:void 0,ellipsoid:hde,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};K2.unpack=function(e,t,n){t=g(t,0);let i=e[t++],o=new Array(i);for(let p=0;p<i;++p,t+=h.packedLength)o[p]=h.unpack(e,t);let r=oe.unpack(e,t,hde);t+=oe.packedLength;let s=e[t++],a=e[t++],c=e[t++],d=e[t++],u=e[t++],m=e[t];return l(n)?(n._positions=o,n._ellipsoid=oe.clone(r,n._ellipsoid),n._width=s,n._height=a,n._extrudedHeight=c,n._cornerType=d,n._granularity=u,n._offsetAttribute=m===-1?void 0:m,n):(Fy.positions=o,Fy.width=s,Fy.height=a,Fy.extrudedHeight=c,Fy.cornerType=d,Fy.granularity=u,Fy.offsetAttribute=m===-1?void 0:m,new K2(Fy))};K2.createGeometry=function(e){let t=e._positions,n=e._width,i=e._ellipsoid;t=UQe(t,i);let o=yo(t,h.equalsEpsilon);if(o.length<2||n<=0)return;let r=e._height,s=e._extrudedHeight,a=!P.equalsEpsilon(r,s,0,P.EPSILON2),c={ellipsoid:i,positions:o,width:n,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},d;if(a)c.height=r,c.extrudedHeight=s,c.offsetAttribute=e._offsetAttribute,d=DQe(c);else{let p=Ai.computePositions(c);if(d=mde(p,c.cornerType),d.attributes.position.values=si.scaleToGeodeticHeight(d.attributes.position.values,r,i),l(e._offsetAttribute)){let b=d.attributes.position.values.length,f=e._offsetAttribute===cn.NONE?0:1,x=new Uint8Array(b/3).fill(f);d.attributes.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:x})}}let u=d.attributes,m=ce.fromVertices(u.position.values,void 0,3);return new ut({attributes:u,indices:d.indices,primitiveType:we.LINES,boundingSphere:m,offsetAttribute:e._offsetAttribute})};var J2=K2;var M3n=T(S(),1);var BQe=new Jn(0);function Qc(e){ii.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}l(Object.create)&&(Qc.prototype=Object.create(ii.prototype),Qc.prototype.constructor=Qc);Object.defineProperties(Qc.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Qc.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!l(t.height)&&!l(t.extrudedHeight)&&Mc.isSupported(this._scene)};Qc.prototype._getIsClosed=function(e){let t=e.height,n=e.extrudedHeight;return t===0||l(n)&&n!==t};Qc.prototype._computeCenter=fe.throwInstantiationError;Qc.prototype._onEntityPropertyChanged=function(e,t,n,i){if(ii.prototype._onEntityPropertyChanged.call(this,e,t,n,i),this._observedPropertyNames.indexOf(t)===-1)return;let o=this._entity[this._geometryPropertyName];if(!l(o))return;l(o.zIndex)&&(l(o.height)||l(o.extrudedHeight))&&wt(wt.geometryZIndex),this._zIndex=g(o.zIndex,BQe),l(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let r=o.heightReference,s=o.extrudedHeightReference;if(l(r)||l(s)){let a=new Em(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new wx(this._scene,a,r,s)}};Qc.prototype.destroy=function(){l(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),ii.prototype.destroy.call(this)};Qc.getGeometryHeight=function(e,t){if(!l(e)){t!==Je.NONE&&wt(wt.geometryHeightReference);return}return cu(t)?0:e};Qc.getGeometryExtrudedHeight=function(e,t){if(!l(e)){t!==Je.NONE&&wt(wt.geometryExtrudedHeightReference);return}return cu(t)?Qc.CLAMP_TO_GROUND:e};Qc.CLAMP_TO_GROUND=\"clamp\";Qc.computeGeometryOffsetAttribute=function(e,t,n,i){(!l(e)||!l(t))&&(t=Je.NONE),(!l(n)||!l(i))&&(i=Je.NONE);let o=0;if(t!==Je.NONE&&o++,i===Je.RELATIVE_TO_GROUND&&o++,o===2)return cn.ALL;if(o===1)return cn.TOP};var On=Qc;var fde=new O,pde=h.ZERO,bde=new h,yde=new le;function YQe(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function $m(e,t){On.call(this,{entity:e,scene:t,geometryOptions:new YQe(e),geometryPropertyName:\"corridor\",observedPropertyNames:[\"availability\",\"corridor\"]}),this._onEntityPropertyChanged(e,\"corridor\",e.corridor,void 0)}l(Object.create)&&($m.prototype=Object.create(On.prototype),$m.prototype.constructor=$m);$m.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i={show:new xn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof kt){let o;l(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(o=this._materialProperty.color.getValue(e,fde)),l(o)||(o=O.WHITE),i.color=Ot.fromColor(o)}return l(this._options.offsetAttribute)&&(i.offset=Ji.fromCartesian3(K.getValueOrDefault(this._terrainOffsetProperty,e,pde,bde))),new Vt({id:t,geometry:new F_(this._options),attributes:i})};$m.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=K.getValueOrDefault(this._outlineColorProperty,e,O.BLACK,fde),o={show:new xn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:Ot.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return l(this._options.offsetAttribute)&&(o.offset=Ji.fromCartesian3(K.getValueOrDefault(this._terrainOffsetProperty,e,pde,bde))),new Vt({id:t,geometry:new J2(this._options),attributes:o})};$m.prototype._computeCenter=function(e,t){let n=K.getValueOrUndefined(this._entity.corridor.positions,e);if(!(!l(n)||n.length===0))return h.clone(n[Math.floor(n.length/2)],t)};$m.prototype._isHidden=function(e,t){return!l(t.positions)||!l(t.width)||ii.prototype._isHidden.call(this,e,t)};$m.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!K.isConstant(t.height)||!K.isConstant(t.extrudedHeight)||!K.isConstant(t.granularity)||!K.isConstant(t.width)||!K.isConstant(t.outlineWidth)||!K.isConstant(t.cornerType)||!K.isConstant(t.zIndex)||this._onTerrain&&!K.isConstant(this._materialProperty)&&!(this._materialProperty instanceof kt)};$m.prototype._setStaticOptions=function(e,t){let n=K.getValueOrUndefined(t.height,Be.MINIMUM_VALUE),i=K.getValueOrDefault(t.heightReference,Be.MINIMUM_VALUE,Je.NONE),o=K.getValueOrUndefined(t.extrudedHeight,Be.MINIMUM_VALUE),r=K.getValueOrDefault(t.extrudedHeightReference,Be.MINIMUM_VALUE,Je.NONE);l(o)&&!l(n)&&(n=0);let s=this._options;s.vertexFormat=this._materialProperty instanceof kt?ln.VERTEX_FORMAT:so.MaterialSupport.TEXTURED.vertexFormat,s.positions=t.positions.getValue(Be.MINIMUM_VALUE,s.positions),s.width=t.width.getValue(Be.MINIMUM_VALUE),s.granularity=K.getValueOrUndefined(t.granularity,Be.MINIMUM_VALUE),s.cornerType=K.getValueOrUndefined(t.cornerType,Be.MINIMUM_VALUE),s.offsetAttribute=On.computeGeometryOffsetAttribute(n,i,o,r),s.height=On.getGeometryHeight(n,i),o=On.getGeometryExtrudedHeight(o,r),o===On.CLAMP_TO_GROUND&&(o=ai.getMinimumMaximumHeights(F_.computeRectangle(s,yde)).minimumTerrainHeight),s.extrudedHeight=o};$m.DynamicGeometryUpdater=p1;function p1(e,t,n){ni.call(this,e,t,n)}l(Object.create)&&(p1.prototype=Object.create(ni.prototype),p1.prototype.constructor=p1);p1.prototype._isHidden=function(e,t,n){let i=this._options;return!l(i.positions)||!l(i.width)||ni.prototype._isHidden.call(this,e,t,n)};p1.prototype._setOptions=function(e,t,n){let i=this._options,o=K.getValueOrUndefined(t.height,n),r=K.getValueOrDefault(t.heightReference,n,Je.NONE),s=K.getValueOrUndefined(t.extrudedHeight,n),a=K.getValueOrDefault(t.extrudedHeightReference,n,Je.NONE);l(s)&&!l(o)&&(o=0),i.positions=K.getValueOrUndefined(t.positions,n),i.width=K.getValueOrUndefined(t.width,n),i.granularity=K.getValueOrUndefined(t.granularity,n),i.cornerType=K.getValueOrUndefined(t.cornerType,n),i.offsetAttribute=On.computeGeometryOffsetAttribute(o,r,s,a),i.height=On.getGeometryHeight(o,r),s=On.getGeometryExtrudedHeight(s,a),s===On.CLAMP_TO_GROUND&&(s=ai.getMinimumMaximumHeights(F_.computeRectangle(i,yde)).minimumTerrainHeight),i.extrudedHeight=s};var Q2=$m;var FYn=T(S(),1);var dBn=T(S(),1);function tk(){fe.throwInstantiationError()}Object.defineProperties(tk.prototype,{name:{get:fe.throwInstantiationError},clock:{get:fe.throwInstantiationError},entities:{get:fe.throwInstantiationError},isLoading:{get:fe.throwInstantiationError},changedEvent:{get:fe.throwInstantiationError},errorEvent:{get:fe.throwInstantiationError},loadingEvent:{get:fe.throwInstantiationError},show:{get:fe.throwInstantiationError},clustering:{get:fe.throwInstantiationError}});tk.prototype.update=function(e){fe.throwInstantiationError()};tk.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var Pr=tk;var XYn=T(S(),1);var gBn=T(S(),1);function gf(e,t){this._ellipsoid=e,this._cameraPosition=new h,this._cameraPositionInScaledSpace=new h,this._distanceToLimbInScaledSpaceSquared=0,l(t)&&(this.cameraPosition=t)}Object.defineProperties(gf.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),i=h.magnitudeSquared(n)-1;h.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=n,this._distanceToLimbInScaledSpaceSquared=i}}});var gde=new h;gf.prototype.isPointVisible=function(e){let n=this._ellipsoid.transformPositionToScaledSpace(e,gde);return bK(n,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};gf.prototype.isScaledSpacePointVisible=function(e){return bK(e,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var OQe=new h;gf.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(e,t){let n=this._ellipsoid,i,o;return l(t)&&t<0&&n.minimumRadius>-t?(o=OQe,o.x=this._cameraPosition.x/(n.radii.x+t),o.y=this._cameraPosition.y/(n.radii.y+t),o.z=this._cameraPosition.z/(n.radii.z+t),i=o.x*o.x+o.y*o.y+o.z*o.z-1):(o=this._cameraPositionInScaledSpace,i=this._distanceToLimbInScaledSpaceSquared),bK(e,o,i)};gf.prototype.computeHorizonCullingPoint=function(e,t,n){return Tde(this._ellipsoid,e,t,n)};var xde=oe.clone(oe.UNIT_SPHERE);gf.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(e,t,n,i){let o=_de(this._ellipsoid,n,xde);return Tde(o,e,t,i)};gf.prototype.computeHorizonCullingPointFromVertices=function(e,t,n,i,o){return Sde(this._ellipsoid,e,t,n,i,o)};gf.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(e,t,n,i,o,r){let s=_de(this._ellipsoid,o,xde);return Sde(s,e,t,n,i,r)};var zQe=[];gf.prototype.computeHorizonCullingPointFromRectangle=function(e,t,n){let i=le.subsample(e,t,0,zQe),o=ce.fromPoints(i);if(!(h.magnitude(o.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(o.center,i,n)};var HQe=new h;function _de(e,t,n){if(l(t)&&t<0&&e.minimumRadius>-t){let i=h.fromElements(e.radii.x+t,e.radii.y+t,e.radii.z+t,HQe);e=oe.fromCartesian3(i,n)}return e}function Tde(e,t,n,i){l(i)||(i=new h);let o=Lde(e,t),r=0;for(let s=0,a=n.length;s<a;++s){let c=n[s],d=Cde(e,c,o);if(d<0)return;r=Math.max(r,d)}return Vde(o,r,i)}var nk=new h;function Sde(e,t,n,i,o,r){l(r)||(r=new h),i=g(i,3),o=g(o,h.ZERO);let s=Lde(e,t),a=0;for(let c=0,d=n.length;c<d;c+=i){nk.x=n[c]+o.x,nk.y=n[c+1]+o.y,nk.z=n[c+2]+o.z;let u=Cde(e,nk,s);if(u<0)return;a=Math.max(a,u)}return Vde(s,a,r)}function bK(e,t,n){let i=t,o=n,r=h.subtract(e,i,gde),s=-h.dot(r,i);return!(o<0?s>0:s>o&&s*s/h.magnitudeSquared(r)>o)}var KQe=new h,JQe=new h;function Cde(e,t,n){let i=e.transformPositionToScaledSpace(t,KQe),o=h.magnitudeSquared(i),r=Math.sqrt(o),s=h.divideByScalar(i,r,JQe);o=Math.max(1,o),r=Math.max(1,r);let a=h.dot(s,n),c=h.magnitude(h.cross(s,n,s)),d=1/r,u=Math.sqrt(o-1)*d;return 1/(a*d-c*u)}function Vde(e,t,n){if(!(t<=0||t===1/0||t!==t))return h.multiplyByScalar(e,t,n)}var pK=new h;function Lde(e,t){return h.equals(t,h.ZERO)?t:(e.transformPositionToScaledSpace(t,pK),h.normalize(pK,pK))}var L0=gf;var PBn=T(S(),1);function gr(e,t){e=g(e,g.EMPTY_OBJECT);let n=e.translucencyByDistance,i=e.scaleByDistance,o=e.distanceDisplayCondition;l(n)&&(n=At.clone(n)),l(i)&&(i=At.clone(i)),l(o)&&(o=It.clone(o)),this._show=g(e.show,!0),this._position=h.clone(g(e.position,h.ZERO)),this._actualPosition=h.clone(this._position),this._color=O.clone(g(e.color,O.WHITE)),this._outlineColor=O.clone(g(e.outlineColor,O.TRANSPARENT)),this._outlineWidth=g(e.outlineWidth,0),this._pixelSize=g(e.pixelSize,10),this._scaleByDistance=i,this._translucencyByDistance=n,this._distanceDisplayCondition=o,this._disableDepthTestDistance=g(e.disableDepthTestDistance,0),this._id=e.id,this._collection=g(e.collection,t),this._depthFailTranslucency=void 0,this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1}var Zde=gr.SHOW_INDEX=0,Ede=gr.POSITION_INDEX=1,QQe=gr.COLOR_INDEX=2,jQe=gr.OUTLINE_COLOR_INDEX=3,qQe=gr.OUTLINE_WIDTH_INDEX=4,$Qe=gr.PIXEL_SIZE_INDEX=5,e4e=gr.SCALE_BY_DISTANCE_INDEX=6,t4e=gr.TRANSLUCENCY_BY_DISTANCE_INDEX=7,n4e=gr.DISTANCE_DISPLAY_CONDITION_INDEX=8,i4e=gr.DISABLE_DEPTH_DISTANCE_INDEX=9,o4e=gr.DEPTH_FAIL_TRANSLUCENCY=10;gr.NUMBER_OF_PROPERTIES=11;function Td(e,t){let n=e._pointPrimitiveCollection;l(n)&&(n._updatePointPrimitive(e,t),e._dirty=!0)}Object.defineProperties(gr.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,Td(this,Zde))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),h.clone(e,this._actualPosition),Td(this,Ede))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;At.equals(t,e)||(this._scaleByDistance=At.clone(e,t),Td(this,e4e))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;At.equals(t,e)||(this._translucencyByDistance=At.clone(e,t),Td(this,t4e))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,Td(this,$Qe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;O.equals(t,e)||(O.clone(e,t),Td(this,QQe))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;O.equals(t,e)||(O.clone(e,t),Td(this,jQe))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,Td(this,qQe))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){It.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=It.clone(e,this._distanceDisplayCondition),Td(this,n4e))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,Td(this,i4e))}},id:{get:function(){return this._id},set:function(e){this._id=e,l(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,Td(this,Zde))}},depthFailTranslucency:{get:function(){return this._depthFailTranslucency},set:function(e){l(e)&&(bi.typeOf.number(\"value\",e),e<0&&(e=0),e>1&&(e=1)),this._depthFailTranslucency!==e&&(this._depthFailTranslucency=e,Td(this,o4e))}}});gr.prototype.getPickId=function(e){return l(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId};gr.prototype._getActualPosition=function(){return this._actualPosition};gr.prototype._setActualPosition=function(e){h.clone(e,this._actualPosition),Td(this,Ede)};var Rde=new se;gr._computeActualPosition=function(e,t,n){return t.mode===ie.SCENE3D?e:(M.multiplyByPoint(n,e,Rde),Zi.computeActualWgs84Position(t,Rde))};var Gde=new se;gr._computeScreenSpacePosition=function(e,t,n,i){let o=M.multiplyByVector(e,se.fromElements(t.x,t.y,t.z,1,Gde),Gde);return Zi.wgs84ToWindowCoordinates(n,o,i)};gr.prototype.computeScreenSpacePosition=function(e,t){let n=this._pointPrimitiveCollection;l(t)||(t=new D);let i=n.modelMatrix,o=gr._computeScreenSpacePosition(i,this._actualPosition,e,t);if(l(o))return o.y=e.canvas.clientHeight-o.y,o};gr.getScreenSpaceBoundingBox=function(e,t,n){let i=e.pixelSize,o=i*.5,r=t.x-o,s=t.y-o,a=i,c=i;return l(n)||(n=new ze),n.x=r,n.y=s,n.width=a,n.height=c,n};gr.prototype.equals=function(e){return this===e||l(e)&&this._id===e._id&&h.equals(this._position,e._position)&&O.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&O.equals(this._outlineColor,e._outlineColor)&&At.equals(this._scaleByDistance,e._scaleByDistance)&&At.equals(this._translucencyByDistance,e._translucencyByDistance)&&It.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance};gr.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var _s=gr;var dYn=T(S(),1);var wBn=T(S(),1),Z0=`in vec4 v_color; in vec4 v_outlineColor; in float v_innerPercent; in float v_pixelDistance; in vec4 v_pickColor; void main() { // The distance in UV space from this fragment to the center of the point, at most 0.5. float distanceToCenter = length(gl_PointCoord - vec2(0.5)); // The max distance stops one pixel shy of the edge to leave space for anti-aliasing. float maxDistance = max(0.0, 0.5 - v_pixelDistance); float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter); float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter); vec4 color = mix(v_outlineColor, v_color, innerAlpha); color.a *= wholeAlpha; // Fully transparent parts of the billboard are not pickable. #if !defined(OPAQUE) && !defined(TRANSLUCENT) if (color.a < 0.005) // matches 0/255 and 1/255 { discard; } #else // The billboard is rendered twice. The opaque pass discards translucent fragments // and the translucent pass discards opaque fragments. #ifdef OPAQUE if (color.a < 0.995) // matches < 254/255 { discard; } #else if (color.a"
}
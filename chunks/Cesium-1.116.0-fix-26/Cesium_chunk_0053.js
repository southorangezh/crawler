{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 53,
    "total_chunks": 194,
    "chunk_size": 38552,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.678Z"
  },
  "content": "M,x5=new $;Ac.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(M.equals(t,M.IDENTITY))return e;let n=e.geometry.attributes;sO(t,n.position),sO(t,n.prevPosition),sO(t,n.nextPosition),(l(n.normal)||l(n.tangent)||l(n.bitangent))&&(M.inverse(t,g5),M.transpose(g5,g5),M.getMatrix3(g5,x5),aO(x5,n.normal),aO(x5,n.tangent),aO(x5,n.bitangent));let i=e.geometry.boundingSphere;return l(i)&&(e.geometry.boundingSphere=ce.transform(i,t,i)),e.modelMatrix=M.clone(M.IDENTITY),e};function gIe(e,t){let n=e.length,i={},o=e[0][t].attributes,r;for(r in o)if(o.hasOwnProperty(r)&&l(o[r])&&l(o[r].values)){let s=o[r],a=s.values.length,c=!0;for(let d=1;d<n;++d){let u=e[d][t].attributes[r];if(!l(u)||s.componentDatatype!==u.componentDatatype||s.componentsPerAttribute!==u.componentsPerAttribute||s.normalize!==u.normalize){c=!1;break}a+=u.values.length}c&&(i[r]=new Ee({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:Q.createTypedArray(s.componentDatatype,a)}))}return i}var xIe=new h;function cO(e,t){let n=e.length,i,o,r,s,a=e[0].modelMatrix,c=l(e[0][t].indices),d=e[0][t].primitiveType,u=gIe(e,t),m,p,b;for(i in u)if(u.hasOwnProperty(i))for(m=u[i].values,s=0,o=0;o<n;++o)for(p=e[o][t].attributes[i].values,b=p.length,r=0;r<b;++r)m[s++]=p[r];let f;if(c){let V=0;for(o=0;o<n;++o)V+=e[o][t].indices.length;let L=ut.computeNumberOfVertices(new ut({attributes:u,primitiveType:we.POINTS})),R=Ae.createTypedArray(L,V),G=0,X=0;for(o=0;o<n;++o){let v=e[o][t].indices,W=v.length;for(s=0;s<W;++s)R[G++]=X+v[s];X+=ut.computeNumberOfVertices(e[o][t])}f=R}let x=new h,_=0,C;for(o=0;o<n;++o){if(C=e[o][t].boundingSphere,!l(C)){x=void 0;break}h.add(C.center,x,x)}if(l(x))for(h.divideByScalar(x,n,x),o=0;o<n;++o){C=e[o][t].boundingSphere;let V=h.magnitude(h.subtract(C.center,x,xIe))+C.radius;V>_&&(_=V)}return new ut({attributes:u,indices:f,primitiveType:d,boundingSphere:l(x)?new ce(x,_):void 0})}Ac.combineInstances=function(e){let t=[],n=[],i=e.length;for(let r=0;r<i;++r){let s=e[r];l(s.geometry)?t.push(s):l(s.westHemisphereGeometry)&&l(s.eastHemisphereGeometry)&&n.push(s)}let o=[];return t.length>0&&o.push(cO(t,\"geometry\")),n.length>0&&(o.push(cO(n,\"westHemisphereGeometry\")),o.push(cO(n,\"eastHemisphereGeometry\"))),o};var lu=new h,PE=new h,HS=new h,KS=new h;Ac.computeNormal=function(e){let t=e.indices,n=e.attributes,i=n.position.values,o=n.position.values.length/3,r=t.length,s=new Array(o),a=new Array(r/3),c=new Array(r),d;for(d=0;d<o;d++)s[d]={indexOffset:0,count:0,currentCount:0};let u=0;for(d=0;d<r;d+=3){let f=t[d],x=t[d+1],_=t[d+2],C=f*3,V=x*3,L=_*3;PE.x=i[C],PE.y=i[C+1],PE.z=i[C+2],HS.x=i[V],HS.y=i[V+1],HS.z=i[V+2],KS.x=i[L],KS.y=i[L+1],KS.z=i[L+2],s[f].count++,s[x].count++,s[_].count++,h.subtract(HS,PE,HS),h.subtract(KS,PE,KS),a[u]=h.cross(HS,KS,new h),u++}let m=0;for(d=0;d<o;d++)s[d].indexOffset+=m,m+=s[d].count;u=0;let p;for(d=0;d<r;d+=3){p=s[t[d]];let f=p.indexOffset+p.currentCount;c[f]=u,p.currentCount++,p=s[t[d+1]],f=p.indexOffset+p.currentCount,c[f]=u,p.currentCount++,p=s[t[d+2]],f=p.indexOffset+p.currentCount,c[f]=u,p.currentCount++,u++}let b=new Float32Array(o*3);for(d=0;d<o;d++){let f=d*3;if(p=s[d],h.clone(h.ZERO,lu),p.count>0){for(u=0;u<p.count;u++)h.add(lu,a[c[p.indexOffset+u]],lu);h.equalsEpsilon(h.ZERO,lu,P.EPSILON10)&&h.clone(a[c[p.indexOffset]],lu)}h.equalsEpsilon(h.ZERO,lu,P.EPSILON10)&&(lu.z=1),h.normalize(lu,lu),b[f]=lu.x,b[f+1]=lu.y,b[f+2]=lu.z}return e.attributes.normal=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:b}),e};var _Ie=new h,Ote=new h,TIe=new h;Ac.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,i=e.attributes.position.values,o=e.attributes.normal.values,r=e.attributes.st.values,s=e.attributes.position.values.length/3,a=n.length,c=new Array(s*3),d;for(d=0;d<c.length;d++)c[d]=0;let u,m,p;for(d=0;d<a;d+=3){let x=n[d],_=n[d+1],C=n[d+2];u=x*3,m=_*3,p=C*3;let V=x*2,L=_*2,R=C*2,G=i[u],X=i[u+1],v=i[u+2],W=r[V],F=r[V+1],A=r[L+1]-F,y=r[R+1]-F,Z=1/((r[L]-W)*y-(r[R]-W)*A),E=(y*(i[m]-G)-A*(i[p]-G))*Z,I=(y*(i[m+1]-X)-A*(i[p+1]-X))*Z,w=(y*(i[m+2]-v)-A*(i[p+2]-v))*Z;c[u]+=E,c[u+1]+=I,c[u+2]+=w,c[m]+=E,c[m+1]+=I,c[m+2]+=w,c[p]+=E,c[p+1]+=I,c[p+2]+=w}let b=new Float32Array(s*3),f=new Float32Array(s*3);for(d=0;d<s;d++){u=d*3,m=u+1,p=u+2;let x=h.fromArray(o,u,_Ie),_=h.fromArray(c,u,TIe),C=h.dot(x,_);h.multiplyByScalar(x,C,Ote),h.normalize(h.subtract(_,Ote,_),_),b[u]=_.x,b[m]=_.y,b[p]=_.z,h.normalize(h.cross(x,_,_),_),f[u]=_.x,f[m]=_.y,f[p]=_.z}return e.attributes.tangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:b}),e.attributes.bitangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:f}),e};var vE=new D,Cm=new h,zte=new h,Hte=new h,_5=new D;Ac.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,i;if(l(t)){let X=t.values;i=X.length/3;let v=new Float32Array(i*2),W=0;for(n=0;n<i;++n){if(h.fromArray(X,n*3,Cm),h.equals(Cm,h.ZERO)){W+=2;continue}_5=wn.octEncodeInRange(Cm,65535,_5),v[W++]=_5.x,v[W++]=_5.y}return e.attributes.compressedAttributes=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:2,values:v}),delete e.attributes.extrudeDirection,e}let o=e.attributes.normal,r=e.attributes.st,s=l(o),a=l(r);if(!s&&!a)return e;let c=e.attributes.tangent,d=e.attributes.bitangent,u=l(c),m=l(d),p,b,f,x;s&&(p=o.values),a&&(b=r.values),u&&(f=c.values),m&&(x=d.values),i=(s?p.length:b.length)/(s?3:2);let V=i,L=a&&s?2:1;L+=u||m?1:0,V*=L;let R=new Float32Array(V),G=0;for(n=0;n<i;++n){a&&(D.fromArray(b,n*2,vE),R[G++]=wn.compressTextureCoordinates(vE));let X=n*3;s&&l(f)&&l(x)?(h.fromArray(p,X,Cm),h.fromArray(f,X,zte),h.fromArray(x,X,Hte),wn.octPack(Cm,zte,Hte,vE),R[G++]=vE.x,R[G++]=vE.y):(s&&(h.fromArray(p,X,Cm),R[G++]=wn.octEncodeFloat(Cm)),u&&(h.fromArray(f,X,Cm),R[G++]=wn.octEncodeFloat(Cm)),m&&(h.fromArray(x,X,Cm),R[G++]=wn.octEncodeFloat(Cm)))}return e.attributes.compressedAttributes=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:L,values:R}),s&&delete e.attributes.normal,a&&delete e.attributes.st,m&&delete e.attributes.bitangent,u&&delete e.attributes.tangent,e};function SIe(e){if(l(e.indices))return e;let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function CIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let i=3;for(let o=3;o<t;++o)n[i++]=o-1,n[i++]=0,n[i++]=o;return e.indices=n,e.primitiveType=we.TRIANGLES,e}function VIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let i=6;for(let o=3;o<t-1;o+=2)n[i++]=o,n[i++]=o-1,n[i++]=o+1,o+2<t&&(n[i++]=o,n[i++]=o+1,n[i++]=o+2);return e.indices=n,e.primitiveType=we.TRIANGLES,e}function LIe(e){if(l(e.indices))return e;let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function ZIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return e.indices=n,e.primitiveType=we.LINES,e}function RIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return n[i++]=t-1,n[i]=0,e.indices=n,e.primitiveType=we.LINES,e}function GIe(e){switch(e.primitiveType){case we.TRIANGLE_FAN:return CIe(e);case we.TRIANGLE_STRIP:return VIe(e);case we.TRIANGLES:return SIe(e);case we.LINE_STRIP:return ZIe(e);case we.LINE_LOOP:return RIe(e);case we.LINES:return LIe(e)}return e}function Fb(e,t){Math.abs(e.y)<P.EPSILON6&&(t?e.y=-P.EPSILON6:e.y=P.EPSILON6)}function EIe(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){Fb(e,e.y<0),Fb(t,t.y<0),Fb(n,n.y<0);return}let i=Math.abs(e.y),o=Math.abs(t.y),r=Math.abs(n.y),s;i>o?i>r?s=P.sign(e.y):s=P.sign(n.y):o>r?s=P.sign(t.y):s=P.sign(n.y);let a=s<0;Fb(e,a),Fb(t,a),Fb(n,a)}var Kte=new h;function du(e,t,n,i){h.add(e,h.multiplyByScalar(h.subtract(t,e,Kte),e.y/(e.y-t.y),Kte),n),h.clone(n,i),Fb(n,!0),Fb(i,!1)}var fx=new h,px=new h,bx=new h,yx=new h,lO={positions:new Array(7),indices:new Array(3*3)};function XIe(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;EIe(e,t,n);let i=e.y<0,o=t.y<0,r=n.y<0,s=0;s+=i?1:0,s+=o?1:0,s+=r?1:0;let a=lO.indices;s===1?(a[1]=3,a[2]=4,a[5]=6,a[7]=6,a[8]=5,i?(du(e,t,fx,bx),du(e,n,px,yx),a[0]=0,a[3]=1,a[4]=2,a[6]=1):o?(du(t,n,fx,bx),du(t,e,px,yx),a[0]=1,a[3]=2,a[4]=0,a[6]=2):r&&(du(n,e,fx,bx),du(n,t,px,yx),a[0]=2,a[3]=0,a[4]=1,a[6]=0)):s===2&&(a[2]=4,a[4]=4,a[5]=3,a[7]=5,a[8]=6,i?o?r||(du(n,e,fx,bx),du(n,t,px,yx),a[0]=0,a[1]=1,a[3]=0,a[6]=2):(du(t,n,fx,bx),du(t,e,px,yx),a[0]=2,a[1]=0,a[3]=2,a[6]=1):(du(e,t,fx,bx),du(e,n,px,yx),a[0]=1,a[1]=2,a[3]=1,a[6]=0));let c=lO.positions;return c[0]=e,c[1]=t,c[2]=n,c.length=3,(s===1||s===2)&&(c[3]=fx,c[4]=px,c[5]=bx,c[6]=yx,c.length=7),lO}function Jte(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let o in n)if(n.hasOwnProperty(o)&&l(n[o])&&l(n[o].values)){let r=n[o];r.values=Q.createTypedArray(r.componentDatatype,r.values)}let i=ut.computeNumberOfVertices(e);return e.indices=Ae.createTypedArray(i,e.indices),t&&(e.boundingSphere=ce.fromVertices(n.position.values)),e}function QS(e){let t=e.attributes,n={};for(let i in t)if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){let o=t[i];n[i]=new Ee({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return new ut({attributes:n,indices:[],primitiveType:e.primitiveType})}function hO(e,t,n){let i=l(e.geometry.boundingSphere);t=Jte(t,i),n=Jte(n,i),l(n)&&!l(t)?e.geometry=n:!l(n)&&l(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function fO(e,t){let n=new e,i=new e,o=new e;return function(r,s,a,c,d,u,m,p){let b=e.fromArray(d,r*t,n),f=e.fromArray(d,s*t,i),x=e.fromArray(d,a*t,o);e.multiplyByScalar(b,c.x,b),e.multiplyByScalar(f,c.y,f),e.multiplyByScalar(x,c.z,x);let _=e.add(b,f,b);e.add(_,x,_),p&&e.normalize(_,_),e.pack(_,u,m*t)}}var IIe=fO(se,4),C5=fO(h,3),tne=fO(D,2),WIe=function(e,t,n,i,o,r,s){let a=o[e]*i.x,c=o[t]*i.y,d=o[n]*i.z;r[s]=a+c+d>P.EPSILON6?1:0},wE=new h,dO=new h,uO=new h,PIe=new h;function T5(e,t,n,i,o,r,s,a,c,d,u,m,p,b,f,x){if(!l(r)&&!l(s)&&!l(a)&&!l(c)&&!l(d)&&b===0)return;let _=h.fromArray(o,e*3,wE),C=h.fromArray(o,t*3,dO),V=h.fromArray(o,n*3,uO),L=hx(i,_,C,V,PIe);if(l(L)){if(l(r)&&C5(e,t,n,L,r,m.normal.values,x,!0),l(d)){let R=h.fromArray(d,e*3,wE),G=h.fromArray(d,t*3,dO),X=h.fromArray(d,n*3,uO);h.multiplyByScalar(R,L.x,R),h.multiplyByScalar(G,L.y,G),h.multiplyByScalar(X,L.z,X);let v;!h.equals(R,h.ZERO)||!h.equals(G,h.ZERO)||!h.equals(X,h.ZERO)?(v=h.add(R,G,R),h.add(v,X,v),h.normalize(v,v)):(v=wE,v.x=0,v.y=0,v.z=0),h.pack(v,m.extrudeDirection.values,x*3)}if(l(u)&&WIe(e,t,n,L,u,m.applyOffset.values,x),l(s)&&C5(e,t,n,L,s,m.tangent.values,x,!0),l(a)&&C5(e,t,n,L,a,m.bitangent.values,x,!0),l(c)&&tne(e,t,n,L,c,m.st.values,x),b>0)for(let R=0;R<b;R++){let G=p[R];vIe(e,t,n,L,x,f[G],m[G])}}}function vIe(e,t,n,i,o,r,s){let a=r.componentsPerAttribute,c=r.values,d=s.values;switch(a){case 4:IIe(e,t,n,i,c,d,o,!1);break;case 3:C5(e,t,n,i,c,d,o,!1);break;case 2:tne(e,t,n,i,c,d,o,!1);break;default:d[o]=c[e]*i.x+c[t]*i.y+c[n]*i.z}}function $h(e,t,n,i,o,r){let s=e.position.values.length/3;if(o!==-1){let a=i[o],c=n[a];return c===-1?(n[a]=s,e.position.values.push(r.x,r.y,r.z),t.push(s),s):(t.push(c),c)}return e.position.values.push(r.x,r.y,r.z),t.push(s),s}var wIe={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function Qte(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=l(n.normal)?n.normal.values:void 0,r=l(n.bitangent)?n.bitangent.values:void 0,s=l(n.tangent)?n.tangent.values:void 0,a=l(n.st)?n.st.values:void 0,c=l(n.extrudeDirection)?n.extrudeDirection.values:void 0,d=l(n.applyOffset)?n.applyOffset.values:void 0,u=t.indices,m=[];for(let v in n)n.hasOwnProperty(v)&&!wIe[v]&&l(n[v])&&m.push(v);let p=m.length,b=QS(t),f=QS(t),x,_,C,V,L,R=[];R.length=i.length/3;let G=[];for(G.length=i.length/3,L=0;L<R.length;++L)R[L]=-1,G[L]=-1;let X=u.length;for(L=0;L<X;L+=3){let v=u[L],W=u[L+1],F=u[L+2],A=h.fromArray(i,v*3),y=h.fromArray(i,W*3),Z=h.fromArray(i,F*3),E=XIe(A,y,Z);if(l(E)&&E.positions.length>3){let I=E.positions,w=E.indices,k=w.length;for(let B=0;B<k;++B){let U=w[B],Y=I[U];Y.y<0?(x=f.attributes,_=f.indices,C=R):(x=b.attributes,_=b.indices,C=G),V=$h(x,_,C,u,U<3?L+U:-1,Y),T5(v,W,F,Y,i,o,s,r,a,c,d,x,m,p,n,V)}}else l(E)&&(A=E.positions[0],y=E.positions[1],Z=E.positions[2]),A.y<0?(x=f.attributes,_=f.indices,C=R):(x=b.attributes,_=b.indices,C=G),V=$h(x,_,C,u,L,A),T5(v,W,F,A,i,o,s,r,a,c,d,x,m,p,n,V),V=$h(x,_,C,u,L+1,y),T5(v,W,F,y,i,o,s,r,a,c,d,x,m,p,n,V),V=$h(x,_,C,u,L+2,Z),T5(v,W,F,Z,i,o,s,r,a,c,d,x,m,p,n,V)}hO(e,f,b)}var nne=an.fromPointNormal(h.ZERO,h.UNIT_Y),FIe=new h,AIe=new h;function JS(e,t,n,i,o,r,s){if(!l(s))return;let a=h.fromArray(i,e*3,wE);h.equalsEpsilon(a,n,P.EPSILON10)?r.applyOffset.values[o]=s[e]:r.applyOffset.values[o]=s[t]}function jte(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=l(n.applyOffset)?n.applyOffset.values:void 0,r=t.indices,s=QS(t),a=QS(t),c,d=r.length,u=[];u.length=i.length/3;let m=[];for(m.length=i.length/3,c=0;c<u.length;++c)u[c]=-1,m[c]=-1;for(c=0;c<d;c+=2){let p=r[c],b=r[c+1],f=h.fromArray(i,p*3,wE),x=h.fromArray(i,b*3,dO),_;Math.abs(f.y)<P.EPSILON6&&(f.y<0?f.y=-P.EPSILON6:f.y=P.EPSILON6),Math.abs(x.y)<P.EPSILON6&&(x.y<0?x.y=-P.EPSILON6:x.y=P.EPSILON6);let C=s.attributes,V=s.indices,L=m,R=a.attributes,G=a.indices,X=u,v=jn.lineSegmentPlane(f,x,nne,uO);if(l(v)){let W=h.multiplyByScalar(h.UNIT_Y,5*P.EPSILON9,FIe);f.y<0&&(h.negate(W,W),C=a.attributes,V=a.indices,L=u,R=s.attributes,G=s.indices,X=m);let F=h.add(v,W,AIe);_=$h(C,V,L,r,c,f),JS(p,b,f,i,_,C,o),_=$h(C,V,L,r,-1,F),JS(p,b,F,i,_,C,o),h.negate(W,W),h.add(v,W,F),_=$h(R,G,X,r,-1,F),JS(p,b,F,i,_,R,o),_=$h(R,G,X,r,c+1,x),JS(p,b,x,i,_,R,o)}else{let W,F,A;f.y<0?(W=a.attributes,F=a.indices,A=u):(W=s.attributes,F=s.indices,A=m),_=$h(W,F,A,r,c,f),JS(p,b,f,i,_,W,o),_=$h(W,F,A,r,c+1,x),JS(p,b,x,i,_,W,o)}}hO(e,a,s)}var qte=new D,MIe=new D,ine=new h,one=new h,mO=new h,NIe=new h,kIe=new h,UIe=new h,$te=new se;function ene(e){let t=e.attributes,n=t.position.values,i=t.prevPosition.values,o=t.nextPosition.values,r=n.length;for(let s=0;s<r;s+=3){let a=h.unpack(n,s,ine);if(a.x>0)continue;let c=h.unpack(i,s,one);(a.y<0&&c.y>0||a.y>0&&c.y<0)&&(s-3>0?(i[s]=n[s-3],i[s+1]=n[s-2],i[s+2]=n[s-1]):h.pack(a,i,s));let d=h.unpack(o,s,mO);(a.y<0&&d.y>0||a.y>0&&d.y<0)&&(s+3<r?(o[s]=n[s+3],o[s+1]=n[s+4],o[s+2]=n[s+5]):h.pack(a,o,s))}}var DIe=5*P.EPSILON9,S5=P.EPSILON6;function BIe(e){let t=e.geometry,n=t.attributes,i=n.position.values,o=n.prevPosition.values,r=n.nextPosition.values,s=n.expandAndWidth.values,a=l(n.st)?n.st.values:void 0,c=l(n.color)?n.color.values:void 0,d=QS(t),u=QS(t),m,p,b,f=!1,x=i.length/3;for(m=0;m<x;m+=4){let _=m,C=m+2,V=h.fromArray(i,_*3,ine),L=h.fromArray(i,C*3,one);if(Math.abs(V.y)<S5)for(V.y=S5*(L.y<0?-1:1),i[m*3+1]=V.y,i[(m+1)*3+1]=V.y,p=_*3;p<_*3+4*3;p+=3)o[p]=i[m*3],o[p+1]=i[m*3+1],o[p+2]=i[m*3+2];if(Math.abs(L.y)<S5)for(L.y=S5*(V.y<0?-1:1),i[(m+2)*3+1]=L.y,i[(m+3)*3+1]=L.y,p=_*3;p<_*3+4*3;p+=3)r[p]=i[(m+2)*3],r[p+1]=i[(m+2)*3+1],r[p+2]=i[(m+2)*3+2];let R=d.attributes,G=d.indices,X=u.attributes,v=u.indices,W=jn.lineSegmentPlane(V,L,nne,NIe);if(l(W)){f=!0;let F=h.multiplyByScalar(h.UNIT_Y,DIe,kIe);V.y<0&&(h.negate(F,F),R=u.attributes,G=u.indices,X=d.attributes,v=d.indices);let A=h.add(W,F,UIe);R.position.values.push(V.x,V.y,V.z,V.x,V.y,V.z),R.position.values.push(A.x,A.y,A.z),R.position.values.push(A.x,A.y,A.z),R.prevPosition.values.push(o[_*3],o[_*3+1],o[_*3+2]),R.prevPosition.values.push(o[_*3+3],o[_*3+4],o[_*3+5]),R.prevPosition.values.push(V.x,V.y,V.z,V.x,V.y,V.z),R.nextPosition.values.push(A.x,A.y,A.z),R.nextPosition.values.push(A.x,A.y,A.z),R.nextPosition.values.push(A.x,A.y,A.z),R.nextPosition.values.push(A.x,A.y,A.z),h.negate(F,F),h.add(W,F,A),X.position.values.push(A.x,A.y,A.z),X.position.values.push(A.x,A.y,A.z),X.position.values.push(L.x,L.y,L.z,L.x,L.y,L.z),X.prevPosition.values.push(A.x,A.y,A.z),X.prevPosition.values.push(A.x,A.y,A.z),X.prevPosition.values.push(A.x,A.y,A.z),X.prevPosition.values.push(A.x,A.y,A.z),X.nextPosition.values.push(L.x,L.y,L.z,L.x,L.y,L.z),X.nextPosition.values.push(r[C*3],r[C*3+1],r[C*3+2]),X.nextPosition.values.push(r[C*3+3],r[C*3+4],r[C*3+5]);let y=D.fromArray(s,_*2,qte),Z=Math.abs(y.y);R.expandAndWidth.values.push(-1,Z,1,Z),R.expandAndWidth.values.push(-1,-Z,1,-Z),X.expandAndWidth.values.push(-1,Z,1,Z),X.expandAndWidth.values.push(-1,-Z,1,-Z);let E=h.magnitudeSquared(h.subtract(W,V,mO));if(E/=h.magnitudeSquared(h.subtract(L,V,mO)),l(c)){let I=se.fromArray(c,_*4,$te),w=se.fromArray(c,C*4,$te),k=P.lerp(I.x,w.x,E),B=P.lerp(I.y,w.y,E),U=P.lerp(I.z,w.z,E),Y=P.lerp(I.w,w.w,E);for(p=_*4;p<_*4+2*4;++p)R.color.values.push(c[p]);for(R.color.values.push(k,B,U,Y),R.color.values.push(k,B,U,Y),X.color.values.push(k,B,U,Y),X.color.values.push(k,B,U,Y),p=C*4;p<C*4+2*4;++p)X.color.values.push(c[p])}if(l(a)){let I=D.fromArray(a,_*2,qte),w=D.fromArray(a,(m+3)*2,MIe),k=P.lerp(I.x,w.x,E);for(p=_*2;p<_*2+2*2;++p)R.st.values.push(a[p]);for(R.st.values.push(k,I.y),R.st.values.push(k,w.y),X.st.values.push(k,I.y),X.st.values.push(k,w.y),p=C*2;p<C*2+2*2;++p)X.st.values.push(a[p])}b=R.position.values.length/3-4,G.push(b,b+2,b+1),G.push(b+1,b+2,b+3),b=X.position.values.length/3-4,v.push(b,b+2,b+1),v.push(b+1,b+2,b+3)}else{let F,A;for(V.y<0?(F=u.attributes,A=u.indices):(F=d.attributes,A=d.indices),F.position.values.push(V.x,V.y,V.z),F.position.values.push(V.x,V.y,V.z),F.position.values.push(L.x,L.y,L.z),F.position.values.push(L.x,L.y,L.z),p=m*3;p<m*3+4*3;++p)F.prevPosition.values.push(o[p]),F.nextPosition.values.push(r[p]);for(p=m*2;p<m*2+4*2;++p)F.expandAndWidth.values.push(s[p]),l(a)&&F.st.values.push(a[p]);if(l(c))for(p=m*4;p<m*4+4*4;++p)F.color.values.push(c[p]);b=F.position.values.length/3-4,A.push(b,b+2,b+1),A.push(b+1,b+2,b+3)}}f&&(ene(u),ene(d)),hO(e,u,d)}Ac.splitLongitude=function(e){let t=e.geometry,n=t.boundingSphere;if(l(n)&&(n.center.x-n.radius>0||ce.intersectPlane(n,an.ORIGIN_ZX_PLANE)!==nn.INTERSECTING))return e;if(t.geometryType!==ou.NONE)switch(t.geometryType){case ou.POLYLINES:BIe(e);break;case ou.TRIANGLES:Qte(e);break;case ou.LINES:jte(e);break}else GIe(t),t.primitiveType===we.TRIANGLES?Qte(e):t.primitiveType===we.LINES&&jte(e);return e};var An=Ac;var zHt=T(S(),1);function Sl(e){this._ellipsoid=g(e,oe.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(Sl.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});Sl.mercatorAngleToGeodeticLatitude=function(e){return P.PI_OVER_TWO-2*Math.atan(Math.exp(-e))};Sl.geodeticLatitudeToMercatorAngle=function(e){e>Sl.MaximumLatitude?e=Sl.MaximumLatitude:e<-Sl.MaximumLatitude&&(e=-Sl.MaximumLatitude);let t=Math.sin(e);return .5*Math.log((1+t)/(1-t))};Sl.MaximumLatitude=Sl.mercatorAngleToGeodeticLatitude(Math.PI);Sl.prototype.project=function(e,t){let n=this._semimajorAxis,i=e.longitude*n,o=Sl.geodeticLatitudeToMercatorAngle(e.latitude)*n,r=e.height;return l(t)?(t.x=i,t.y=o,t.z=r,t):new h(i,o,r)};Sl.prototype.unproject=function(e,t){let n=this._oneOverSemimajorAxis,i=e.x*n,o=Sl.mercatorAngleToGeodeticLatitude(e.y*n),r=e.z;return l(t)?(t.longitude=i,t.latitude=o,t.height=r,t):new he(i,o,r)};var Li=Sl;function YIe(e,t,n){let i=!n,o=e.length,r;if(!i&&o>1){let s=e[0].modelMatrix;for(r=1;r<o;++r)if(!M.equals(s,e[r].modelMatrix)){i=!0;break}}if(i)for(r=0;r<o;++r)l(e[r].geometry)&&An.transformToWorldCoordinates(e[r]);else M.multiplyTransformation(t,e[0].modelMatrix,t)}function pO(e,t){let n=e.attributes,i=n.position,o=i.values.length/i.componentsPerAttribute;n.batchId=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:1,values:new Float32Array(o)});let r=n.batchId.values;for(let s=0;s<o;++s)r[s]=t}function OIe(e){let t=e.length;for(let n=0;n<t;++n){let i=e[n];l(i.geometry)?pO(i.geometry,n):l(i.westHemisphereGeometry)&&l(i.eastHemisphereGeometry)&&(pO(i.westHemisphereGeometry,n),pO(i.eastHemisphereGeometry,n))}}function zIe(e){let t=e.instances,n=e.projection,i=e.elementIndexUintSupported,o=e.scene3DOnly,r=e.vertexCacheOptimize,s=e.compressVertices,a=e.modelMatrix,c,d,u,m=t.length;for(c=0;c<m;++c)if(l(t[c].geometry)){u=t[c].geometry.primitiveType;break}if(YIe(t,a,o),!o)for(c=0;c<m;++c)l(t[c].geometry)&&An.splitLongitude(t[c]);if(OIe(t),r)for(c=0;c<m;++c){let b=t[c];l(b.geometry)?(An.reorderForPostVertexCache(b.geometry),An.reorderForPreVertexCache(b.geometry)):l(b.westHemisphereGeometry)&&l(b.eastHemisphereGeometry)&&(An.reorderForPostVertexCache(b.westHemisphereGeometry),An.reorderForPreVertexCache(b.westHemisphereGeometry),An.reorderForPostVertexCache(b.eastHemisphereGeometry),An.reorderForPreVertexCache(b.eastHemisphereGeometry))}let p=An.combineInstances(t);for(m=p.length,c=0;c<m;++c){d=p[c];let b=d.attributes;if(o)for(let f in b)b.hasOwnProperty(f)&&b[f].componentDatatype===Q.DOUBLE&&An.encodeAttribute(d,f,`${f}3DHigh`,`${f}3DLow`);else for(let f in b)if(b.hasOwnProperty(f)&&b[f].componentDatatype===Q.DOUBLE){let x=`${f}3D`,_=`${f}2D`;An.projectTo2D(d,f,x,_,n),l(d.boundingSphere)&&f===\"position\"&&(d.boundingSphereCV=ce.fromVertices(d.attributes.position2D.values)),An.encodeAttribute(d,x,`${x}High`,`${x}Low`),An.encodeAttribute(d,_,`${_}High`,`${_}Low`)}s&&An.compressVertices(d)}if(!i){let b=[];for(m=p.length,c=0;c<m;++c)d=p[c],b=b.concat(An.fitToUnsignedShortIndices(d));p=b}return p}function bO(e,t,n,i){let o,r,s,a=i.length-1;if(a>=0){let d=i[a];o=d.offset+d.count,s=d.index,r=n[s].indices.length}else o=0,s=0,r=n[s].indices.length;let c=e.length;for(let d=0;d<c;++d){let m=e[d][t];if(!l(m))continue;let p=m.indices.length;o+p>r&&(o=0,r=n[++s].indices.length),i.push({index:s,offset:o,count:p}),o+=p}}function HIe(e,t){let n=[];return bO(e,\"geometry\",t,n),bO(e,\"westHemisphereGeometry\",t,n),bO(e,\"eastHemisphereGeometry\",t,n),n}var Sp={};Sp.combineGeometry=function(e){let t,n,i=e.instances,o=i.length,r,s,a=!1;o>0&&(t=zIe(e),t.length>0&&(n=An.createAttributeLocations(t[0]),e.createPickOffsets&&(r=HIe(i,t))),l(i[0].attributes)&&l(i[0].attributes.offset)&&(s=new Array(o),a=!0));let c=new Array(o),d=new Array(o);for(let u=0;u<o;++u){let m=i[u],p=m.geometry;l(p)&&(c[u]=p.boundingSphere,d[u]=p.boundingSphereCV,a&&(s[u]=m.geometry.offsetAttribute));let b=m.eastHemisphereGeometry,f=m.westHemisphereGeometry;l(b)&&l(f)&&(l(b.boundingSphere)&&l(f.boundingSphere)&&(c[u]=ce.union(b.boundingSphere,f.boundingSphere)),l(b.boundingSphereCV)&&l(f.boundingSphereCV)&&(d[u]=ce.union(b.boundingSphereCV,f.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:r,offsetInstanceExtend:s,boundingSpheres:c,boundingSpheresCV:d}};function KIe(e,t){let n=e.attributes;for(let i in n)if(n.hasOwnProperty(i)){let o=n[i];l(o)&&l(o.values)&&t.push(o.values.buffer)}l(e.indices)&&t.push(e.indices.buffer)}function JIe(e,t){let n=e.length;for(let i=0;i<n;++i)KIe(e[i],t)}function QIe(e){let t=1,n=e.length;for(let i=0;i<n;i++){let o=e[i];if(++t,!l(o))continue;let r=o.attributes;t+=7+2*ce.packedLength+(l(o.indices)?o.indices.length:0);for(let s in r)if(r.hasOwnProperty(s)&&l(r[s])){let a=r[s];t+=5+a.values.length}}return t}Sp.packCreateGeometryResults=function(e,t){let n=new Float64Array(QIe(e)),i=[],o={},r=e.length,s=0;n[s++]=r;for(let a=0;a<r;a++){let c=e[a],d=l(c);if(n[s++]=d?1:0,!d)continue;n[s++]=c.primitiveType,n[s++]=c.geometryType,n[s++]=g(c.offsetAttribute,-1);let u=l(c.boundingSphere)?1:0;n[s++]=u,u&&ce.pack(c.boundingSphere,n,s),s+=ce.packedLength;let m=l(c.boundingSphereCV)?1:0;n[s++]=m,m&&ce.pack(c.boundingSphereCV,n,s),s+=ce.packedLength;let p=c.attributes,b=[];for(let x in p)p.hasOwnProperty(x)&&l(p[x])&&(b.push(x),l(o[x])||(o[x]=i.length,i.push(x)));n[s++]=b.length;for(let x=0;x<b.length;x++){let _=b[x],C=p[_];n[s++]=o[_],n[s++]=C.componentDatatype,n[s++]=C.componentsPerAttribute,n[s++]=C.normalize?1:0,n[s++]=C.values.length,n.set(C.values,s),s+=C.values.length}let f=l(c.indices)?c.indices.length:0;n[s++]=f,f>0&&(n.set(c.indices,s),s+=f)}return t.push(n.buffer),{stringTable:i,packedData:n}};Sp.unpackCreateGeometryResults=function(e){let t=e.stringTable,n=e.packedData,i,o=new Array(n[0]),r=0,s=1;for(;s<n.length;){if(!(n[s++]===1)){o[r++]=void 0;continue}let c=n[s++],d=n[s++],u=n[s++];u===-1&&(u=void 0);let m,p;n[s++]===1&&(m=ce.unpack(n,s)),s+=ce.packedLength,n[s++]===1&&(p=ce.unpack(n,s)),s+=ce.packedLength;let x,_,C,V=new hn,L=n[s++];for(i=0;i<L;i++){let G=t[n[s++]],X=n[s++];C=n[s++];let v=n[s++]!==0;x=n[s++],_=Q.createTypedArray(X,x);for(let W=0;W<x;W++)_[W]=n[s++];V[G]=new Ee({componentDatatype:X,componentsPerAttribute:C,normalize:v,values:_})}let R;if(x=n[s++],x>0){let G=_.length/C;for(R=Ae.createTypedArray(G,x),i=0;i<x;i++)R[i]=n[s++]}o[r++]=new ut({primitiveType:c,geometryType:d,boundingSphere:m,boundingSphereCV:p,indices:R,attributes:V,offsetAttribute:u})}return o};function jIe(e,t){let n=e.length,i=new Float64Array(1+n*19),o=0;i[o++]=n;for(let r=0;r<n;r++){let s=e[r];if(M.pack(s.modelMatrix,i,o),o+=M.packedLength,l(s.attributes)&&l(s.attributes.offset)){let a=s.attributes.offset.value;i[o]=a[0],i[o+1]=a[1],i[o+2]=a[2]}o+=3}return t.push(i.buffer),i}function qIe(e){let t=e,n=new Array(t[0]),i=0,o=1;for(;o<t.length;){let r=M.unpack(t,o),s;o+=M.packedLength,l(t[o])&&(s={offset:new Ji(t[o],t[o+1],t[o+2])}),o+=3,n[i++]={modelMatrix:r,attributes:s}}return n}Sp.packCombineGeometryParameters=function(e,t){let n=e.createGeometryResults,i=n.length;for(let o=0;o<i;o++)t.push(n[o].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:jIe(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof Ci,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}};Sp.unpackCombineGeometryParameters=function(e){let t=qIe(e.packedInstances),n=e.createGeometryResults,i=n.length,o=0;for(let a=0;a<i;a++){let c=Sp.unpackCreateGeometryResults(n[a]),d=c.length;for(let u=0;u<d;u++){let m=c[u],p=t[o];p.geometry=m,++o}}let r=oe.clone(e.ellipsoid),s=e.isGeographic?new Ci(r):new Li(r);return{instances:t,ellipsoid:r,projection:s,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:M.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}};function rne(e){let t=e.length,n=1+(ce.packedLength+1)*t,i=new Float32Array(n),o=0;i[o++]=t;for(let r=0;r<t;++r){let s=e[r];l(s)?(i[o++]=1,ce.pack(e[r],i,o)):i[o++]=0,o+=ce.packedLength}return i}function sne(e){let t=new Array(e[0]),n=0,i=1;for(;i<e.length;)e[i++]===1&&(t[n]=ce.unpack(e,i)),++n,i+=ce.packedLength;return t}Sp.packCombineGeometryResults=function(e,t){l(e.geometries)&&JIe(e.geometries,t);let n=rne(e.boundingSpheres),i=rne(e.boundingSpheresCV);return t.push(n.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:i}};Sp.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:sne(e.boundingSpheres),boundingSpheresCV:sne(e.boundingSpheresCV)}};var gx=Sp;var dKt=T(S(),1),$Ie={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},br=Object.freeze($Ie);var mKt=T(S(),1),cd={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};cd.NUMBER_OF_SHADOW_MODES=4;cd.castShadows=function(e){return e===cd.ENABLED||e===cd.CAST_ONLY};cd.receiveShadows=function(e){return e===cd.ENABLED||e===cd.RECEIVE_ONLY};cd.fromCastReceive=function(e,t){return e&&t?cd.ENABLED:e?cd.CAST_ONLY:t?cd.RECEIVE_ONLY:cd.DISABLED};var _n=Object.freeze(cd);function yr(e){e=g(e,g.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=M.clone(g(e.modelMatrix,M.IDENTITY)),this._modelMatrix=new M,this.show=g(e.show,!0),this._vertexCacheOptimize=g(e.vertexCacheOptimize,!1),this._interleave=g(e.interleave,!1),this._releaseGeometryInstances=g(e.releaseGeometryInstances,!0),this._allowPicking=g(e.allowPicking,!0),this._asynchronous=g(e.asynchronous,!0),this._compressVertices=g(e.compressVertices,!0),this.cull=g(e.cull,!0),this.debugShowBoundingVolume=g(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=g(e.shadows,_n.DISABLED),this._translucent=void 0,this._state=br.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=new Map,this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(yr.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}}});function eWe(e){let t=e.length,n=[],i=e[0].attributes,o;for(o in i)if(i.hasOwnProperty(o)&&l(i[o])){let r=i[o],s=!0;for(let a=1;a<t;++a){let c=e[a].attributes[o];if(!l(c)||r.componentDatatype!==c.componentDatatype||r.componentsPerAttribute!==c.componentsPerAttribute||r.normalize!==c.normalize){s=!1;break}}s&&n.push(o)}return n}var tWe=new D,nWe=new h,pne=new se;function bne(e){let t=e.length;if(t===1)return e[0];if(t===2)return D.unpack(e,0,tWe);if(t===3)return h.unpack(e,0,nWe);if(t===4)return se.unpack(e,0,pne)}function iWe(e,t){let n=e.geometryInstances,i=Array.isArray(n)?n:[n],o=i.length;if(o===0)return;let r=eWe(i),s=r.length,a=[],c={},d={},u,p=i[0].attributes,b,f,x;for(b=0;b<s;++b)f=r[b],x=p[f],c[f]=b,a.push({functionName:`czm_batchTable_${f}`,componentDatatype:x.componentDatatype,componentsPerAttribute:x.componentsPerAttribute,normalize:x.normalize});r.indexOf(\"distanceDisplayCondition\")!==-1&&(a.push({functionName:\"czm_batchTable_boundingSphereCenter3DHigh\",componentDatatype:Q.FLOAT,componentsPerAttribute:3},{functionName:\"czm_batchTable_boundingSphereCenter3DLow\",componentDatatype:Q.FLOAT,componentsPerAttribute:3},{functionName:\"czm_batchTable_boundingSphereCenter2DHigh\",componentDatatype:Q.FLOAT,componentsPerAttribute:3},{functionName:\"czm_batchTable_boundingSphereCenter2DLow\",componentDatatype:Q.FLOAT,componentsPerAttribute:3},{functionName:\"czm_batchTable_boundingSphereRadius\",componentDatatype:Q.FLOAT,componentsPerAttribute:1}),d.center3DHigh=a.length-5,d.center3DLow=a.length-4,d.center2DHigh=a.length-3,d.center2DLow=a.length-2,d.radius=a.length-1),r.indexOf(\"offset\")!==-1&&(a.push({functionName:\"czm_batchTable_offset2D\",componentDatatype:Q.FLOAT,componentsPerAttribute:3}),u=a.length-1),a.push({functionName:\"czm_batchTable_pickColor\",componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let _=a.length,C=new mx(t,a,o);for(b=0;b<o;++b){let V=i[b];p=V.attributes;for(let v=0;v<s;++v){f=r[v],x=p[f];let W=bne(x.value),F=c[f];C.setBatchedAttribute(b,F,W)}let L={primitive:g(V.pickPrimitive,e)};l(V.id)&&(L.id=V.id);let R=t.createPickId(L);e._pickIds.push(R);let G=R.color,X=pne;X.x=O.floatToByte(G.red),X.y=O.floatToByte(G.green),X.z=O.floatToByte(G.blue),X.w=O.floatToByte(G.alpha),C.setBatchedAttribute(b,_-1,X)}e._batchTable=C,e._batchTableAttributeIndices=c,e._batchTableBoundingSphereAttributeIndices=d,e._batchTableOffsetAttribute2DIndex=u}function oWe(e){let t;return Array.isArray(e.values)?t=e.values.slice(0):t=new e.values.constructor(e.values),new Ee({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function rWe(e){let t=e.attributes,n=new hn;for(let o in t)t.hasOwnProperty(o)&&l(t[o])&&(n[o]=oWe(t[o]));let i;if(l(e.indices)){let o=e.indices;Array.isArray(o)?i=o.slice(0):i=new o.constructor(o)}return new ut({attributes:n,indices:i,primitiveType:e.primitiveType,boundingSphere:ce.clone(e.boundingSphere)})}function sWe(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:M.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var aWe=/in\\s+vec(?:3|4)\\s+(.*)3DHigh;/g;yr._modifyShaderPosition=function(e,t,n){let i,o=\"\",r=\"\",s=\"\";for(;(i=aWe.exec(t))!==null;){let a=i[1],c=`vec4 czm_compute${a[0].toUpperCase()}${a.substr(1)}()`;c!==\"vec4 czm_computePosition()\"&&(o+=`${c}; `),l(e.rtcCenter)?(t=t.replace(/in\\s+vec(?:3|4)\\s+position3DHigh;/g,\"\"),t=t.replace(/in\\s+vec(?:3|4)\\s+position3DLow;/g,\"\"),o+=`uniform mat4 u_modifiedModelView; `,r+=`in vec4 position; `,s+=`${c} { return u_modifiedModelView * position; } `,t=t.replace(/czm_modelViewRelativeToEye\\s+\\*\\s+/g,\"\"),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,\"czm_projection\")):n?s+=`${c} { return czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow); } `:(r+=`in vec3 ${a}2DHigh; in vec3 ${a}2DLow; `,s+=`${c} { vec4 p; if (czm_morphTime == 1.0) { p = czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow); } else if (czm_morphTime == 0.0) { p = czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy); } else { p = czm_columbusViewMorph( czm_translateRelativeToEye(${a}2DHigh.zxy, ${a}2DLow.zxy), czm_translateRelativeToEye(${a}3DHigh, ${a}3DLow), czm_morphTime); } return p; } `)}return[o,r,t,s].join(` `)};yr._appendShowToShader=function(e,t){return l(e._batchTableAttributeIndices.show)?`${Ue.replaceMain(t,\"czm_non_show_main\")} void main() { czm_non_show_main(); gl_Position *= czm_batchTable_show(batchId); }`:t};yr._updateColorAttribute=function(e,t,n){if(!l(e._batchTableAttributeIndices.color)&&!l(e._batchTableAttributeIndices.depthFailColor)||t.search(/in\\s+vec4\\s+color;/g)===-1)return t;let i=t;return i=i.replace(/in\\s+vec4\\s+color;/g,\"\"),n?i=i.replace(/(\\b)color(\\b)/g,\"$1czm_batchTable_depthFailColor(batchId)$2\"):i=i.replace(/(\\b)color(\\b)/g,\"$1czm_batchTable_color(batchId)$2\"),i};function ane(e){return`${Ue.replaceMain(e,\"czm_non_pick_main\")} out vec4 v_pickColor; void main() { czm_non_pick_main(); v_pickColor = czm_batchTable_pickColor(batchId); }`}function cne(e){return`in vec4 v_pickColor; ${e}`}yr._updatePickColorAttribute=function(e){let t=e.replace(/in\\s+vec4\\s+pickColor;/g,\"\");return t=t.replace(/(\\b)pickColor(\\b)/g,\"$1czm_batchTable_pickColor(batchId)$2\"),t};yr._appendOffsetToShader=function(e,t){if(!l(e._batchTableAttributeIndices.offset))return t;let n=`in float batchId; `;n+=\"in float applyOffset;\";let i=t.replace(/in\\s+float\\s+batchId;/g,n),o=`vec4 $1 = czm_computePosition(); `;return o+=` if (czm_sceneMode == czm_sceneMode3D) `,o+=` { `,o+=\" $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);\",o+=` } `,o+=` else `,o+=` { `,o+=\" $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);\",o+=` } `,i=i.replace(/vec4\\s+([A-Za-z0-9_]+)\\s+=\\s+czm_computePosition\\(\\);/g,o),i};yr._appendDistanceDisplayConditionToShader=function(e,t,n){if(!l(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let i=Ue.replaceMain(t,\"czm_non_distanceDisplayCondition_main\"),o=`void main() { czm_non_distanceDisplayCondition_main(); vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId); vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId); vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId); float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId); `;return n?o+=` vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow); `:o+=` vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId); vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId); vec4 centerRTE; if (czm_morphTime == 1.0) { centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow); } else if (czm_morphTime == 0.0) { centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy); } else { centerRTE = czm_columbusViewMorph( czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy), czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow), czm_morphTime); } `,o+=` float radiusSq = boundingSphereRadius * boundingSphereRadius; float distanceSq; if (czm_sceneMode == czm_sceneMode2D) { distanceSq = czm_eyeHeight2D.y - radiusSq; } else { distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; } distanceSq = max(distanceSq, 0.0); float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; gl_Position *="
}
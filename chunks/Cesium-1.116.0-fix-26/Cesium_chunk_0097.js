{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 97,
    "total_chunks": 194,
    "chunk_size": 38117,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.703Z"
  },
  "content": "position2DHigh; in vec3 position2DLow; in vec3 prevPosition3DHigh; in vec3 prevPosition3DLow; in vec3 prevPosition2DHigh; in vec3 prevPosition2DLow; in vec3 nextPosition3DHigh; in vec3 nextPosition3DLow; in vec3 nextPosition2DHigh; in vec3 nextPosition2DLow; in vec4 texCoordExpandAndBatchIndex; out vec2 v_st; out float v_width; out vec4 v_pickColor; out float v_polylineAngle; // @uranus change \\u65B0\\u589E\\u53D8\\u91CF\\u7528\\u6765\\u8BA1\\u7B97\\u8FB9\\u7F18\\u6297\\u952F\\u9F7F out float v_aa_width; out float v_aa_out; void main() { float texCoord = texCoordExpandAndBatchIndex.x; float expandDir = texCoordExpandAndBatchIndex.y; bool usePrev = texCoordExpandAndBatchIndex.z < 0.0; float batchTableIndex = texCoordExpandAndBatchIndex.w; // @uranus change: \\u8BA1\\u7B97\\u5916\\u6269\\u53D8\\u91CF v_aa_out = 1.0 / czm_pixelRatio; // \\u7EBF\\u6BB5\\u9876\\u70B9\\u5916\\u6269\\u4E24\\u4E2A\\u50CF\\u7D20 float width_out = v_aa_out * 2.0; // @uranus change end vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex); // @uranus change \\u5BBD\\u5EA6\\u5916\\u6269 float width = widthAndShow.x + 0.5 + width_out; float show = widthAndShow.y; if (width < 1.0) { show = 0.0; } vec4 pickColor = batchTable_getPickColor(batchTableIndex); vec4 p, prev, next; if (czm_morphTime == 1.0) { p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz); prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz); next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz); } else if (czm_morphTime == 0.0) { p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy); prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy); next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy); } else { p = czm_columbusViewMorph( czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy), czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz), czm_morphTime); prev = czm_columbusViewMorph( czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy), czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz), czm_morphTime); next = czm_columbusViewMorph( czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy), czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz), czm_morphTime); } #ifdef DISTANCE_DISPLAY_CONDITION vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex); vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex); vec3 centerLow = centerLowAndRadius.xyz; float radius = centerLowAndRadius.w; vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex); float lengthSq; if (czm_sceneMode == czm_sceneMode2D) { lengthSq = czm_eyeHeight2D.y; } else { vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz); lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius); } float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; if (lengthSq < nearSq || lengthSq > farSq) { show = 0.0; } #endif float polylineAngle; vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, polylineAngle); gl_Position = czm_viewportOrthographic * positionWC * show; v_st.s = texCoord; v_st.t = czm_writeNonPerspective(clamp(expandDir, 0.0, 1.0), gl_Position.w); // @uranus change: \\u8BA1\\u7B97\\u5916\\u6269\\u53D8\\u91CF v_width = width - width_out; v_aa_width = width; // @uranus change end v_pickColor = pickColor; v_polylineAngle = polylineAngle; } `;var WWn=T(S(),1);var _Wn=T(S(),1);var Kc={};Kc.numberOfPoints=function(e,t,n){let i=h.distance(e,t);return Math.ceil(i/n)};Kc.numberOfPointsRhumbLine=function(e,t,n){let i=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(i/(n*n))))};var uOe=new he;Kc.extractHeights=function(e,t){let n=e.length,i=new Array(n);for(let o=0;o<n;o++){let r=e[o];i[o]=t.cartesianToCartographic(r,uOe).height}return i};var mOe=new M,hOe=new h,jae=new h,fOe=new an(h.UNIT_X,0),qae=new h,pOe=new an(h.UNIT_X,0),bOe=new h,yOe=new h,pH=[];function ece(e,t,n){let i=pH;i.length=e;let o;if(t===n){for(o=0;o<e;o++)i[o]=t;return i}let s=(n-t)/e;for(o=0;o<e;o++){let a=t+o*s;i[o]=a}return i}var RN=new he,ZN=new he,Ty=new h,bH=new h,gOe=new h,fH=new Cp,$W=new Za;function xOe(e,t,n,i,o,r,s,a){let c=i.scaleToGeodeticSurface(e,bH),d=i.scaleToGeodeticSurface(t,gOe),u=Kc.numberOfPoints(e,t,n),m=i.cartesianToCartographic(c,RN),p=i.cartesianToCartographic(d,ZN),b=ece(u,o,r);fH.setEndPoints(m,p);let f=fH.surfaceDistance/u,x=a;m.height=o;let _=i.cartographicToCartesian(m,Ty);h.pack(_,s,x),x+=3;for(let C=1;C<u;C++){let V=fH.interpolateUsingSurfaceDistance(C*f,ZN);V.height=b[C],_=i.cartographicToCartesian(V,Ty),h.pack(_,s,x),x+=3}return x}function _Oe(e,t,n,i,o,r,s,a){let c=i.cartesianToCartographic(e,RN),d=i.cartesianToCartographic(t,ZN),u=Kc.numberOfPointsRhumbLine(c,d,n);c.height=0,d.height=0;let m=ece(u,o,r);$W.ellipsoid.equals(i)||($W=new Za(void 0,void 0,i)),$W.setEndPoints(c,d);let p=$W.surfaceDistance/u,b=a;c.height=o;let f=i.cartographicToCartesian(c,Ty);h.pack(f,s,b),b+=3;for(let x=1;x<u;x++){let _=$W.interpolateUsingSurfaceDistance(x*p,ZN);_.height=m[x],f=i.cartographicToCartesian(_,Ty),h.pack(f,s,b),b+=3}return b}Kc.wrapLongitude=function(e,t){let n=[],i=[];if(l(e)&&e.length>0){t=g(t,M.IDENTITY);let o=M.inverseTransformation(t,mOe),r=M.multiplyByPoint(o,h.ZERO,hOe),s=h.normalize(M.multiplyByPointAsVector(o,h.UNIT_Y,jae),jae),a=an.fromPointNormal(r,s,fOe),c=h.normalize(M.multiplyByPointAsVector(o,h.UNIT_X,qae),qae),d=an.fromPointNormal(r,c,pOe),u=1;n.push(h.clone(e[0]));let m=n[0],p=e.length;for(let b=1;b<p;++b){let f=e[b];if(an.getPointDistance(d,m)<0||an.getPointDistance(d,f)<0){let x=jn.lineSegmentPlane(m,f,a,bOe);if(l(x)){let _=h.multiplyByScalar(s,5e-9,yOe);an.getPointDistance(a,m)<0&&h.negate(_,_),n.push(h.add(x,_,new h)),i.push(u+1),h.negate(_,_),n.push(h.add(x,_,new h)),u=1}}n.push(h.clone(e[b])),u++,m=f}i.push(u)}return{positions:n,lengths:i}};Kc.generateArc=function(e){l(e)||(e={});let t=e.positions,n=t.length,i=g(e.ellipsoid,oe.WGS84),o=g(e.height,0),r=Array.isArray(o);if(n<1)return[];if(n===1){let x=i.scaleToGeodeticSurface(t[0],bH);if(o=r?o[0]:o,o!==0){let _=i.geodeticSurfaceNormal(x,Ty);h.multiplyByScalar(_,o,_),h.add(x,_,x)}return[x.x,x.y,x.z]}let s=e.minDistance;if(!l(s)){let x=g(e.granularity,P.RADIANS_PER_DEGREE);s=P.chordLength(x,i.maximumRadius)}let a=0,c;for(c=0;c<n-1;c++)a+=Kc.numberOfPoints(t[c],t[c+1],s);let d=(a+1)*3,u=new Array(d),m=0;for(c=0;c<n-1;c++){let x=t[c],_=t[c+1],C=r?o[c]:o,V=r?o[c+1]:o;m=xOe(x,_,s,i,C,V,u,m)}pH.length=0;let p=t[n-1],b=i.cartesianToCartographic(p,RN);b.height=r?o[n-1]:o;let f=i.cartographicToCartesian(b,Ty);return h.pack(f,u,d-3),u};var $ae=new he,TOe=new he;Kc.generateRhumbArc=function(e){l(e)||(e={});let t=e.positions,n=t.length,i=g(e.ellipsoid,oe.WGS84),o=g(e.height,0),r=Array.isArray(o);if(n<1)return[];if(n===1){let C=i.scaleToGeodeticSurface(t[0],bH);if(o=r?o[0]:o,o!==0){let V=i.geodeticSurfaceNormal(C,Ty);h.multiplyByScalar(V,o,V),h.add(C,V,C)}return[C.x,C.y,C.z]}let s=g(e.granularity,P.RADIANS_PER_DEGREE),a=0,c,d=i.cartesianToCartographic(t[0],$ae),u;for(c=0;c<n-1;c++)u=i.cartesianToCartographic(t[c+1],TOe),a+=Kc.numberOfPointsRhumbLine(d,u,s),d=he.clone(u,$ae);let m=(a+1)*3,p=new Array(m),b=0;for(c=0;c<n-1;c++){let C=t[c],V=t[c+1],L=r?o[c]:o,R=r?o[c+1]:o;b=_Oe(C,V,s,i,L,R,p,b)}pH.length=0;let f=t[n-1],x=i.cartesianToCartographic(f,RN);x.height=r?o[n-1]:o;let _=i.cartographicToCartesian(x,Ty);return h.pack(_,p,m-3),p};Kc.generateCartesianArc=function(e){let t=Kc.generateArc(e),n=t.length/3,i=new Array(n);for(let o=0;o<n;o++)i[o]=h.unpack(t,o*3);return i};Kc.generateCartesianRhumbArc=function(e){let t=Kc.generateRhumbArc(e),n=t.length/3,i=new Array(n);for(let o=0;o<n;o++)i[o]=h.unpack(t,o*3);return i};var Ri=Kc;function gd(e,t){e=g(e,g.EMPTY_OBJECT),this._show=g(e.show,!0),this._width=g(e.width,1),this._loop=g(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,l(this._material)||(this._material=ki.fromType(ki.ColorType,{color:new O(1,1,1,1)}));let n=e.positions;l(n)||(n=[]),this._positions=n,this._actualPositions=yo(n,h.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=n.slice()),this._actualPositions.push(h.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id;let i;l(t)&&(i=M.clone(t.modelMatrix)),this._modelMatrix=i,this._segments=Ri.wrapLongitude(this._actualPositions,i),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(nce),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=ce.fromPoints(this._actualPositions),this._boundingVolumeWC=ce.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new ce}var tce=gd.POSITION_INDEX=0,SOe=gd.SHOW_INDEX=1,COe=gd.WIDTH_INDEX=2,VOe=gd.MATERIAL_INDEX=3,e2=gd.POSITION_SIZE_INDEX=4,LOe=gd.DISTANCE_DISPLAY_CONDITION=5,nce=gd.NUMBER_OF_PROPERTIES=6;function s0(e,t){++e._propertiesChanged[t];let n=e._polylineCollection;l(n)&&(n._updatePolyline(e,t),e._dirty=!0)}Object.defineProperties(gd.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,s0(this,SOe))}},positions:{get:function(){return this._positions},set:function(e){let t=yo(e,h.equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(h.clone(t[0]))),(this._actualPositions.length!==t.length||this._actualPositions.length!==this._length)&&s0(this,e2),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=ce.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=ce.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),s0(this,tce),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,s0(this,VOe))}},width:{get:function(){return this._width},set:function(e){let t=this._width;e!==t&&(this._width=e,s0(this,COe))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){let t=this._actualPositions;e?t.length>2&&!h.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(h.clone(t[0]))):t.length>2&&h.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,s0(this,e2)}}},id:{get:function(){return this._id},set:function(e){this._id=e,l(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!l(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){It.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=It.clone(e,this._distanceDisplayCondition),s0(this,LOe))}}});gd.prototype.update=function(){let e=M.IDENTITY;l(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);let t=this._segments.positions.length,n=this._segments.lengths,i=this._propertiesChanged[tce]>0||this._propertiesChanged[e2]>0;if((!M.equals(e,this._modelMatrix)||i)&&(this._segments=Ri.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=ce.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=M.clone(e,this._modelMatrix),this._segments.positions.length!==t)s0(this,e2);else{let o=n.length;for(let r=0;r<o;++r)if(n[r]!==this._segments.lengths[r]){s0(this,e2);break}}};gd.prototype.getPickId=function(e){return l(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId};gd.prototype._clean=function(){this._dirty=!1;let e=this._propertiesChanged;for(let t=0;t<nce-1;++t)e[t]=0};gd.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var Vu=gd;var ZOe=Vu.SHOW_INDEX,ROe=Vu.WIDTH_INDEX,gH=Vu.POSITION_INDEX,GOe=Vu.MATERIAL_INDEX,ice=Vu.POSITION_SIZE_INDEX,EOe=Vu.DISTANCE_DISPLAY_CONDITION,dce=Vu.NUMBER_OF_PROPERTIES,wl={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function Om(e){e=g(e,g.EMPTY_OBJECT),this.show=g(e.show,!0),this.modelMatrix=M.clone(g(e.modelMatrix,M.IDENTITY)),this._modelMatrix=M.clone(M.IDENTITY),this.debugShowBoundingVolume=g(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(dce),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:Me.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=O.clone(O.WHITE);let t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}Object.defineProperties(Om.prototype,{length:{get:function(){return xH(this),this._polylines.length}}});Om.prototype.add=function(e){let t=new Vu(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t};Om.prototype.remove=function(e){if(this.contains(e)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,l(e._bucket)){let t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}return e._destroy(),!0}return!1};Om.prototype.removeAll=function(){_H(this),pce(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0};Om.prototype.contains=function(e){return l(e)&&e._polylineCollection===this};Om.prototype.get=function(e){return xH(this),this._polylines[e]};function XOe(e,t){l(e._batchTable)&&e._batchTable.destroy();let n=[{functionName:\"batchTable_getWidthAndShow\",componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:\"batchTable_getPickColor\",componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:\"batchTable_getCenterHigh\",componentDatatype:Q.FLOAT,componentsPerAttribute:3},{functionName:\"batchTable_getCenterLowAndRadius\",componentDatatype:Q.FLOAT,componentsPerAttribute:4},{functionName:\"batchTable_getDistanceDisplayCondition\",componentDatatype:Q.FLOAT,componentsPerAttribute:2}];e._batchTable=new mx(t,n,e._polylines.length)}var uce=new Yn,mce=new se,hce=new D;Om.prototype.update=function(e){if(xH(this),this._polylines.length===0||!this.show)return;FOe(this,e);let t=e.context,n=e.mapProjection,i,o=this._propertiesChanged;if(this._createBatchTable){if(Yt.maximumVertexTextureImageUnits===0)throw new ue(\"Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.\");XOe(this,t),this._createBatchTable=!1}if(this._createVertexArray||WOe(this))sce(this,t,n);else if(this._polylinesUpdated){let c=this._polylinesToUpdate;if(this._mode!==ie.SCENE3D){let d=c.length;for(let u=0;u<d;++u)i=c[u],i.update()}if(o[ice]||o[GOe])sce(this,t,n);else{let d=c.length,u=this._polylineBuckets;for(let m=0;m<d;++m){i=c[m],o=i._propertiesChanged;let p=i._bucket,b=0;for(let f in u)if(u.hasOwnProperty(f)){if(u[f]===p){o[gH]&&p.writeUpdate(b,i,this._positionBuffer,n);break}b+=u[f].lengthOfPositions}if((o[ZOe]||o[ROe])&&this._batchTable.setBatchedAttribute(i._index,0,new D(i._width,i._show)),this._batchTable.attributes.length>2){if(o[gH]||o[ice]){let f=e.mode===ie.SCENE2D?i._boundingVolume2D:i._boundingVolumeWC,x=Yn.fromCartesian(f.center,uce),_=se.fromElements(x.low.x,x.low.y,x.low.z,f.radius,mce);this._batchTable.setBatchedAttribute(i._index,2,x.high),this._batchTable.setBatchedAttribute(i._index,3,_)}if(o[EOe]){let f=hce;f.x=0,f.y=Number.MAX_VALUE;let x=i.distanceDisplayCondition;l(x)&&(f.x=x.near,f.y=x.far),this._batchTable.setBatchedAttribute(i._index,4,f)}}i._clean()}}c.length=0,this._polylinesUpdated=!1}o=this._propertiesChanged;for(let c=0;c<dce;++c)o[c]=0;let r=M.IDENTITY;e.mode===ie.SCENE3D&&(r=this.modelMatrix);let s=e.passes,a=e.morphTime!==0;if((!l(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==a)&&(this._opaqueRS=Ne.fromCache({depthMask:a,depthTest:{enabled:a}})),(!l(this._translucentRS)||this._translucentRS.depthTest.enabled!==a)&&(this._translucentRS=Ne.fromCache({blending:un.ALPHA_BLEND,depthMask:!a,depthTest:{enabled:a}})),this._batchTable.update(e),s.render||s.pick){let c=this._colorCommands;IOe(this,e,c,r)}};var t2=new ce,oce=new ce;function IOe(e,t,n,i){let o=t.context,r=t.commandList,s=n.length,a=0,c=!0,d=e._vertexArrays,u=e.debugShowBoundingVolume,p=e._batchTable.getUniformMapCallback(),b=d.length;for(let f=0;f<b;++f){let x=d[f],_=x.buckets,C=_.length;for(let V=0;V<C;++V){let L=_[V],R=L.offset,G=L.bucket.shaderProgram,X=L.bucket.polylines,v=X.length,W,F,A=0,y,Z;for(let E=0;E<v;++E){let I=X[E],w=vOe(I._material);if(w!==W){if(l(W)&&A>0){let Y=F.isTranslucent();a>=s?(y=new je({owner:e}),n.push(y)):y=n[a],++a,Z=Ct(p(F._uniforms),e._uniformMap),y.boundingVolume=ce.clone(t2,y.boundingVolume),y.modelMatrix=i,y.shaderProgram=G,y.vertexArray=x.va,y.renderState=Y?e._translucentRS:e._opaqueRS,y.pass=Y?Ze.TRANSLUCENT:Ze.OPAQUE,y.debugShowBoundingVolume=u,y.pickId=\"v_pickColor\",y.uniformMap=Z,y.count=A,y.offset=R,R+=A,A=0,c=!0,r.push(y)}F=I._material,F.update(o),W=w}let k=I._locatorBuckets,B=k.length;for(let Y=0;Y<B;++Y){let N=k[Y];N.locator===L&&(A+=N.count)}let U;t.mode===ie.SCENE3D?U=I._boundingVolumeWC:t.mode===ie.COLUMBUS_VIEW?U=I._boundingVolume2D:t.mode===ie.SCENE2D?l(I._boundingVolume2D)&&(U=ce.clone(I._boundingVolume2D,oce),U.center.x=0):l(I._boundingVolumeWC)&&l(I._boundingVolume2D)&&(U=ce.union(I._boundingVolumeWC,I._boundingVolume2D,oce)),c?(c=!1,ce.clone(U,t2)):ce.union(U,t2,t2)}l(W)&&A>0&&(a>=s?(y=new je({owner:e}),n.push(y)):y=n[a],++a,Z=Ct(p(F._uniforms),e._uniformMap),y.boundingVolume=ce.clone(t2,y.boundingVolume),y.modelMatrix=i,y.shaderProgram=G,y.vertexArray=x.va,y.renderState=F.isTranslucent()?e._translucentRS:e._opaqueRS,y.pass=F.isTranslucent()?Ze.TRANSLUCENT:Ze.OPAQUE,y.debugShowBoundingVolume=u,y.pickId=\"v_pickColor\",y.uniformMap=Z,y.count=A,y.offset=R,c=!0,r.push(y)),W=void 0}}n.length=a}Om.prototype.isDestroyed=function(){return!1};Om.prototype.destroy=function(){return fce(this),_H(this),pce(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),me(this)};function WOe(e){let t=!1,n=e._propertiesChanged,i=e._positionBufferUsage;return n[gH]?(i.bufferUsage!==Me.STREAM_DRAW&&(t=!0,i.bufferUsage=Me.STREAM_DRAW),i.frameCount=100):i.bufferUsage!==Me.STATIC_DRAW&&(i.frameCount===0?(t=!0,i.bufferUsage=Me.STATIC_DRAW):i.frameCount--),t}var rce=[0,0,0];function sce(e,t,n){e._createVertexArray=!1,_H(e),fce(e),wOe(e);let i=[[]],o=i[0],r=e._batchTable,s=e._useHighlightColor,a=[0],c=0,d=[[]],u=0,m=e._polylineBuckets,p,b;for(p in m)m.hasOwnProperty(p)&&(b=m[p],b.updateShader(t,r,s),u+=b.lengthOfPositions);if(u>0){let f=e._mode,x=new Float32Array(6*u*3),_=new Float32Array(u*4),C,V=0,L=0,R=0;for(p in m)if(m.hasOwnProperty(p)){b=m[p],b.write(x,_,V,L,R,r,t,n),f===ie.MORPHING&&(l(C)||(C=new Float32Array(6*u*3)),b.writeForMorph(C,V));let Z=b.lengthOfPositions;V+=6*Z*3,L+=Z*4,R+=Z*4,c=b.updateIndices(i,a,d,c)}let G=e._positionBufferUsage.bufferUsage,X=Me.STATIC_DRAW;e._positionBuffer=pt.createVertexBuffer({context:t,typedArray:x,usage:G});let v;l(C)&&(v=pt.createVertexBuffer({context:t,typedArray:C,usage:G})),e._texCoordExpandAndBatchIndexBuffer=pt.createVertexBuffer({context:t,typedArray:_,usage:X});let W=3*Float32Array.BYTES_PER_ELEMENT,F=4*Float32Array.BYTES_PER_ELEMENT,A=0,y=i.length;for(let Z=0;Z<y;++Z)if(o=i[Z],o.length>0){let E=new Uint16Array(o),I=pt.createIndexBuffer({context:t,typedArray:E,usage:Me.STATIC_DRAW,indexDatatype:Ae.UNSIGNED_SHORT});A+=a[Z];let w=6*(Z*(W*P.SIXTY_FOUR_KILOBYTES)-A*W),k=W+w,B=W+k,U=W+B,Y=W+U,N=W+Y,J=Z*(F*P.SIXTY_FOUR_KILOBYTES)-A*F,z=[{index:wl.position3DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:w,strideInBytes:6*W},{index:wl.position3DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:k,strideInBytes:6*W},{index:wl.position2DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:w,strideInBytes:6*W},{index:wl.position2DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:k,strideInBytes:6*W},{index:wl.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:B,strideInBytes:6*W},{index:wl.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:U,strideInBytes:6*W},{index:wl.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:B,strideInBytes:6*W},{index:wl.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:U,strideInBytes:6*W},{index:wl.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:Y,strideInBytes:6*W},{index:wl.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:N,strideInBytes:6*W},{index:wl.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:Y,strideInBytes:6*W},{index:wl.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:Q.FLOAT,offsetInBytes:N,strideInBytes:6*W},{index:wl.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:Q.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:J}],ee,H,j,q;f===ie.SCENE3D?(H=e._positionBuffer,ee=\"vertexBuffer\",j=rce,q=\"value\"):f===ie.SCENE2D||f===ie.COLUMBUS_VIEW?(H=rce,ee=\"value\",j=e._positionBuffer,q=\"vertexBuffer\"):(H=v,ee=\"vertexBuffer\",j=e._positionBuffer,q=\"vertexBuffer\"),z[0][ee]=H,z[1][ee]=H,z[2][q]=j,z[3][q]=j,z[4][ee]=H,z[5][ee]=H,z[6][q]=j,z[7][q]=j,z[8][ee]=H,z[9][ee]=H,z[10][q]=j,z[11][q]=j;let pe=new ti({context:t,attributes:z,indexBuffer:I});e._vertexArrays.push({va:pe,buckets:d[Z]})}}}function POe(e,t){return t instanceof Ft?t.id:t}var GN=[];function vOe(e){let t=ki._uniformList[e.type],n=t.length;GN.length=2*n;let i=0;for(let o=0;o<n;++o){let r=t[o];GN[i]=r,GN[i+1]=e._uniforms[r](),i+=2}return`${e.type}:${JSON.stringify(GN,POe)}`}function wOe(e){let t=e._mode,n=e._modelMatrix,i=e._polylineBuckets={},o=e._polylines,r=o.length;for(let s=0;s<r;++s){let a=o[s];if(a._actualPositions.length>1){a.update();let c=a.material,d=i[c.type];l(d)||(d=i[c.type]=new ff(c,t,n)),d.addPolyline(a)}}}function FOe(e,t){let n=t.mode;(e._mode!==n||!M.equals(e._modelMatrix,e.modelMatrix))&&(e._mode=n,e._modelMatrix=M.clone(e.modelMatrix),e._createVertexArray=!0)}function xH(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;let t=[],n=[],i=0,o,r=e._polylines.length;for(let s=0;s<r;++s)o=e._polylines[s],o.isDestroyed||(o._index=i++,n.push(o),t.push(o));e._polylines=t,e._polylinesToUpdate=n}}function _H(e){let t=e._polylines,n=t.length;for(let i=0;i<n;++i)if(!t[i].isDestroyed){let o=t[i]._bucket;l(o)&&(o.shaderProgram=o.shaderProgram&&o.shaderProgram.destroy())}}function fce(e){let t=e._vertexArrays.length;for(let n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}Om.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]};function pce(e){let t=e._polylines,n=t.length;for(let i=0;i<n;++i)t[i].isDestroyed||t[i]._destroy()}function yH(e,t,n){this.count=e,this.offset=t,this.bucket=n}function ff(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=n}ff.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this};ff.prototype.updateShader=function(e,t,n){if(l(this.shaderProgram))return;let i=[\"DISTANCE_DISPLAY_CONDITION\"];n&&i.push(\"VECTOR_TILE\"),this.material.shaderSource.search(/in\\s+float\\s+v_polylineAngle;/g)!==-1&&i.push(\"POLYLINE_DASH\"),Ut.isInternetExplorer()||i.push(\"CLIP_POLYLINE\");let o=new Ue({defines:i,sources:[`in vec4 v_pickColor; `,this.material.shaderSource,Cx]}),r=t.getVertexShaderCallback()(qW),s=new Ue({defines:i,sources:[dd,r]});this.shaderProgram=Ht.fromCache({context:e,vertexShaderSource:s,fragmentShaderSource:o,attributeLocations:wl})};function bce(e){return h.dot(h.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(an.ORIGIN_ZX_PLANE)===nn.INTERSECTING}ff.prototype.getPolylinePositionsLength=function(e){let t;if(this.mode===ie.SCENE3D||!bce(e))return t=e._actualPositions.length,t*4-4;let n=0,i=e._segments.lengths;t=i.length;for(let o=0;o<t;++o)n+=i[o]*4-4;return n};var ys=new h,Lu=new h,Zu=new h,EN=new h,AOe=new se,MOe=new D;ff.prototype.write=function(e,t,n,i,o,r,s,a){let c=this.mode,d=a.ellipsoid.maximumRadius*P.PI,u=this.polylines,m=u.length;for(let p=0;p<m;++p){let b=u[p],f=b.width,x=b.show&&f>0,_=b._index,C=this.getSegments(b,a),V=C.positions,L=C.lengths,R=V.length,G=b.getPickId(s).color,X=0,v=0,W;for(let B=0;B<R;++B){B===0?b._loop?W=V[R-2]:(W=EN,h.subtract(V[0],V[1],W),h.add(V[0],W,W)):W=V[B-1],h.clone(W,Lu),h.clone(V[B],ys),B===R-1?b._loop?W=V[1]:(W=EN,h.subtract(V[R-1],V[R-2],W),h.add(V[R-1],W,W)):W=V[B+1],h.clone(W,Zu);let U=L[X];B===v+U&&(v+=U,++X);let Y=B-v===0,N=B===v+L[X]-1;c===ie.SCENE2D&&(Lu.z=0,ys.z=0,Zu.z=0),(c===ie.SCENE2D||c===ie.MORPHING)&&(Y||N)&&d-Math.abs(ys.x)<1&&((ys.x<0&&Lu.x>0||ys.x>0&&Lu.x<0)&&h.clone(ys,Lu),(ys.x<0&&Zu.x>0||ys.x>0&&Zu.x<0)&&h.clone(ys,Zu));let J=Y?2:0,z=N?2:4;for(let ee=J;ee<z;++ee){Yn.writeElements(ys,e,n),Yn.writeElements(Lu,e,n+6),Yn.writeElements(Zu,e,n+12);let H=ee-2<0?-1:1;t[o]=B/(R-1),t[o+1]=2*(ee%2)-1,t[o+2]=H,t[o+3]=_,n+=6*3,o+=4}}let F=AOe;F.x=O.floatToByte(G.red),F.y=O.floatToByte(G.green),F.z=O.floatToByte(G.blue),F.w=O.floatToByte(G.alpha);let A=MOe;A.x=f,A.y=x?1:0;let y=c===ie.SCENE2D?b._boundingVolume2D:b._boundingVolumeWC,Z=Yn.fromCartesian(y.center,uce),E=Z.high,I=se.fromElements(Z.low.x,Z.low.y,Z.low.z,y.radius,mce),w=hce;w.x=0,w.y=Number.MAX_VALUE;let k=b.distanceDisplayCondition;l(k)&&(w.x=k.near,w.y=k.far),r.setBatchedAttribute(_,0,A),r.setBatchedAttribute(_,1,F),r.attributes.length>2&&(r.setBatchedAttribute(_,2,E),r.setBatchedAttribute(_,3,I),r.setBatchedAttribute(_,4,w))}};var NOe=new h,kOe=new h,UOe=new h,ace=new h;ff.prototype.writeForMorph=function(e,t){let n=this.modelMatrix,i=this.polylines,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=s._segments.positions,c=s._segments.lengths,d=a.length,u=0,m=0;for(let p=0;p<d;++p){let b;p===0?s._loop?b=a[d-2]:(b=ace,h.subtract(a[0],a[1],b),h.add(a[0],b,b)):b=a[p-1],b=M.multiplyByPoint(n,b,kOe);let f=M.multiplyByPoint(n,a[p],NOe),x;p===d-1?s._loop?x=a[1]:(x=ace,h.subtract(a[d-1],a[d-2],x),h.add(a[d-1],x,x)):x=a[p+1],x=M.multiplyByPoint(n,x,UOe);let _=c[u];p===m+_&&(m+=_,++u);let C=p-m===0,V=p===m+c[u]-1,L=C?2:0,R=V?2:4;for(let G=L;G<R;++G)Yn.writeElements(f,e,t),Yn.writeElements(b,e,t+6),Yn.writeElements(x,e,t+12),t+=6*3}}};var DOe=new Array(1);ff.prototype.updateIndices=function(e,t,n,i){let o=n.length-1,r=new yH(0,i,this);n[o].push(r);let s=0,a=e[e.length-1],c=0;a.length>0&&(c=a[a.length-1]+1);let d=this.polylines,u=d.length;for(let m=0;m<u;++m){let p=d[m];p._locatorBuckets=[];let b;if(this.mode===ie.SCENE3D){b=DOe;let x=p._actualPositions.length;if(x>0)b[0]=x;else continue}else b=p._segments.lengths;let f=b.length;if(f>0){let x=0;for(let _=0;_<f;++_){let C=b[_]-1;for(let V=0;V<C;++V)c+4>P.SIXTY_FOUR_KILOBYTES&&(p._locatorBuckets.push({locator:r,count:x}),x=0,t.push(4),a=[],e.push(a),c=0,r.count=s,s=0,i=0,r=new yH(0,0,this),n[++o]=[r]),a.push(c,c+2,c+1),a.push(c+1,c+2,c+3),x+=6,s+=6,i+=6,c+=4}p._locatorBuckets.push({locator:r,count:x}),c+4>P.SIXTY_FOUR_KILOBYTES&&(t.push(0),a=[],e.push(a),c=0,r.count=s,i=0,s=0,r=new yH(0,0,this),n[++o]=[r])}p._clean()}return r.count=s,i};ff.prototype.getPolylineStartIndex=function(e){let t=this.polylines,n=0,i=t.length;for(let o=0;o<i;++o){let r=t[o];if(r===e)break;n+=r._actualLength}return n};var zC={positions:void 0,lengths:void 0},cce=new Array(1),BOe=new h,YOe=new he;ff.prototype.getSegments=function(e,t){let n=e._actualPositions;if(this.mode===ie.SCENE3D)return cce[0]=n.length,zC.positions=n,zC.lengths=cce,zC;bce(e)&&(n=e._segments.positions);let i=t.ellipsoid,o=[],r=this.modelMatrix,s=n.length,a,c=BOe;for(let d=0;d<s;++d)a=n[d],c=M.multiplyByPoint(r,a,c),o.push(t.project(i.cartesianToCartographic(c,YOe)));if(o.length>0){e._boundingVolume2D=ce.fromPoints(o,e._boundingVolume2D);let d=e._boundingVolume2D.center;e._boundingVolume2D.center=new h(d.z,d.x,d.y)}return zC.positions=o,zC.lengths=e._segments.lengths,zC};var lce;ff.prototype.writeUpdate=function(e,t,n,i){let o=this.mode,r=i.ellipsoid.maximumRadius*P.PI,s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);let a=lce,c=6*s*3;!l(a)||a.length<c?a=lce=new Float32Array(c):a.length>c&&(a=new Float32Array(a.buffer,0,c));let d=this.getSegments(t,i),u=d.positions,m=d.lengths,p=0,b=0,f=0,x;s=u.length;for(let _=0;_<s;++_){_===0?t._loop?x=u[s-2]:(x=EN,h.subtract(u[0],u[1],x),h.add(u[0],x,x)):x=u[_-1],h.clone(x,Lu),h.clone(u[_],ys),_===s-1?t._loop?x=u[1]:(x=EN,h.subtract(u[s-1],u[s-2],x),h.add(u[s-1],x,x)):x=u[_+1],h.clone(x,Zu);let C=m[b];_===f+C&&(f+=C,++b);let V=_-f===0,L=_===f+m[b]-1;o===ie.SCENE2D&&(Lu.z=0,ys.z=0,Zu.z=0),(o===ie.SCENE2D||o===ie.MORPHING)&&(V||L)&&r-Math.abs(ys.x)<1&&((ys.x<0&&Lu.x>0||ys.x>0&&Lu.x<0)&&h.clone(ys,Lu),(ys.x<0&&Zu.x>0||ys.x>0&&Zu.x<0)&&h.clone(ys,Zu));let R=V?2:0,G=L?2:4;for(let X=R;X<G;++X)Yn.writeElements(ys,a,p),Yn.writeElements(Lu,a,p+6),Yn.writeElements(Zu,a,p+12),p+=6*3}n.copyFromArrayView(a,6*3*Float32Array.BYTES_PER_ELEMENT*e)}};var zm=Om;function Sy(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=new yd({batchTable:e.batchTable}),this._labelCollection=new hf({batchTable:e.batchTable}),this._polylineCollection=new zm,this._polylineCollection._useHighlightColor=!0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0}Object.defineProperties(Sy.prototype,{ready:{get:function(){return this._ready}},pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){let e=this._billboardCollection.textureAtlas.texture.sizeInBytes,t=this._labelCollection._textureAtlas.texture.sizeInBytes;return e+t}}});function OOe(e,t){let n=e._rectangle,i=e._minHeight,o=e._maxHeight,r=2+le.packedLength+oe.packedLength,s=new Float64Array(r),a=0;return s[a++]=i,s[a++]=o,le.pack(n,s,a),a+=le.packedLength,oe.pack(t,s,a),s}var zOe=new di(\"createVectorTilePoints\",5),HOe=new h;function KOe(e,t){let n=e._positions,i=e._packedBuffer;l(i)||(n=e._positions=n.slice(),e._batchIds=e._batchIds.slice(),i=e._packedBuffer=OOe(e,t));let o=[n.buffer,i.buffer],r={positions:n.buffer,packedBuffer:i.buffer},s=zOe.scheduleTask(r,o);if(l(s))return s.then(a=>{if(e.isDestroyed())return;e._positions=new Float64Array(a.positions);let c=e._billboardCollection,d=e._labelCollection,u=e._polylineCollection;n=e._positions;let m=e._batchIds,p=n.length/3;for(let b=0;b<p;++b){let f=m[b],x=h.unpack(n,b*3,HOe),_=c.add();_.position=x,_._batchIndex=f;let C=d.add();C.text=\" \",C.position=x,C._batchIndex=f;let V=u.add();V.positions=[h.clone(x),h.clone(x)]}e._positions=void 0,e._packedBuffer=void 0,e._ready=!0}).catch(a=>{e.isDestroyed()||(e._error=a)})}Sy.prototype.createFeatures=function(e,t){let n=this._billboardCollection,i=this._labelCollection,o=this._polylineCollection,r=this._batchIds,s=r.length;for(let a=0;a<s;++a){let c=r[a],d=n.get(a),u=i.get(a),m=o.get(a);t[c]=new o0(e,c,d,u,m)}};Sy.prototype.applyDebugSettings=function(e,t){e?(O.clone(t,this._billboardCollection._highlightColor),O.clone(t,this._labelCollection._highlightColor),O.clone(t,this._polylineCollection._highlightColor)):(O.clone(O.WHITE,this._billboardCollection._highlightColor),O.clone(O.WHITE,this._labelCollection._highlightColor),O.clone(O.WHITE,this._polylineCollection._highlightColor))};function JOe(e,t){let n=e._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];s.show=!0,s.pointSize=o0.defaultPointSize,s.color=o0.defaultColor,s.pointOutlineColor=o0.defaultPointOutlineColor,s.pointOutlineWidth=o0.defaultPointOutlineWidth,s.labelColor=O.WHITE,s.labelOutlineColor=O.WHITE,s.labelOutlineWidth=1,s.font=\"30px sans-serif\",s.labelStyle=wo.FILL,s.labelText=void 0,s.backgroundColor=new O(.165,.165,.165,.8),s.backgroundPadding=new D(7,5),s.backgroundEnabled=!1,s.scaleByDistance=void 0,s.translucencyByDistance=void 0,s.distanceDisplayCondition=void 0,s.heightOffset=0,s.anchorLineEnabled=!1,s.anchorLineColor=O.WHITE,s.image=void 0,s.disableDepthTestDistance=0,s.horizontalOrigin=ui.CENTER,s.verticalOrigin=Wn.CENTER,s.labelHorizontalOrigin=ui.RIGHT,s.labelVerticalOrigin=Wn.BASELINE}}var QOe=new O,jOe=new O,qOe=new O,$Oe=new O,eze=new O,tze=new O,n2=new At,i2=new At,TH=new It;Sy.prototype.applyStyle=function(e,t){if(!l(e)){JOe(this,t);return}let n=this._batchIds,i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];if(l(e.show)&&(s.show=e.show.evaluate(s)),l(e.pointSize)&&(s.pointSize=e.pointSize.evaluate(s)),l(e.color)&&(s.color=e.color.evaluateColor(s,QOe)),l(e.pointOutlineColor)&&(s.pointOutlineColor=e.pointOutlineColor.evaluateColor(s,jOe)),l(e.pointOutlineWidth)&&(s.pointOutlineWidth=e.pointOutlineWidth.evaluate(s)),l(e.labelColor)&&(s.labelColor=e.labelColor.evaluateColor(s,qOe)),l(e.labelOutlineColor)&&(s.labelOutlineColor=e.labelOutlineColor.evaluateColor(s,$Oe)),l(e.labelOutlineWidth)&&(s.labelOutlineWidth=e.labelOutlineWidth.evaluate(s)),l(e.font)&&(s.font=e.font.evaluate(s)),l(e.labelStyle)&&(s.labelStyle=e.labelStyle.evaluate(s)),l(e.labelText)?s.labelText=e.labelText.evaluate(s):s.labelText=void 0,l(e.backgroundColor)&&(s.backgroundColor=e.backgroundColor.evaluateColor(s,eze)),l(e.backgroundPadding)&&(s.backgroundPadding=e.backgroundPadding.evaluate(s)),l(e.backgroundEnabled)&&(s.backgroundEnabled=e.backgroundEnabled.evaluate(s)),l(e.scaleByDistance)){let a=e.scaleByDistance.evaluate(s);l(a)?(n2.near=a.x,n2.nearValue=a.y,n2.far=a.z,n2.farValue=a.w,s.scaleByDistance=n2):s.scaleByDistance=void 0}else s.scaleByDistance=void 0;if(l(e.translucencyByDistance)){let a=e.translucencyByDistance.evaluate(s);l(a)?(i2.near=a.x,i2.nearValue=a.y,i2.far=a.z,i2.farValue=a.w,s.translucencyByDistance=i2):s.translucencyByDistance=void 0}else s.translucencyByDistance=void 0;if(l(e.distanceDisplayCondition)){let a=e.distanceDisplayCondition.evaluate(s);l(a)?(TH.near=a.x,TH.far=a.y,s.distanceDisplayCondition=TH):s.distanceDisplayCondition=void 0}else s.distanceDisplayCondition=void 0;l(e.heightOffset)&&(s.heightOffset=e.heightOffset.evaluate(s)),l(e.anchorLineEnabled)&&(s.anchorLineEnabled=e.anchorLineEnabled.evaluate(s)),l(e.anchorLineColor)&&(s.anchorLineColor=e.anchorLineColor.evaluateColor(s,tze)),l(e.image)?s.image=e.image.evaluate(s):s.image=void 0,l(e.disableDepthTestDistance)&&(s.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(s)),l(e.horizontalOrigin)&&(s.horizontalOrigin=e.horizontalOrigin.evaluate(s)),l(e.verticalOrigin)&&(s.verticalOrigin=e.verticalOrigin.evaluate(s)),l(e.labelHorizontalOrigin)&&(s.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(s)),l(e.labelVerticalOrigin)&&(s.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(s))}};Sy.prototype.update=function(e){if(!this._ready){if(l(this._promise)||(this._promise=KOe(this,e.mapProjection.ellipsoid)),l(this._error)){let t=this._error;throw this._error=void 0,t}return}this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e)};Sy.prototype.isDestroyed=function(){return!1};Sy.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),me(this)};var o2=Sy;var j2n=T(S(),1);function a0(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=g(e.ellipsoid,oe.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=g(e.center,h.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=Un.BOTH}Object.defineProperties(a0.prototype,{trianglesLength:{get:function(){return l(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return l(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}});function nze(e){let t=new Float64Array(3+h.packedLength+oe.packedLength+le.packedLength),n=0;return t[n++]=e._indices.BYTES_PER_ELEMENT,t[n++]=e._minimumHeight,t[n++]=e._maximumHeight,h.pack(e._center,t,n),n+=h.packedLength,oe.pack(e._ellipsoid,t,n),n+=oe.packedLength,le.pack(e._rectangle,t,n),t}function ize(e,t){let n=1,i=t[n++],o=e._boundingVolumes=new"
}
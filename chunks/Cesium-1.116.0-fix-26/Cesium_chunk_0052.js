{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 52,
    "total_chunks": 194,
    "chunk_size": 28549,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.677Z"
  },
  "content": "= northWestCorner - southWestCorner; float northExtent = length(northWard); northWard /= northExtent; v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner)); v_southPlane = vec4(northWard, -dot(northWard, southWestCorner)); v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent); #endif // SPHERICAL vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId); vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId); v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z); v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w); v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy; #endif // TEXTURE_COORDINATES #ifdef PER_INSTANCE_COLOR v_color = czm_batchTable_color(batchId); #endif gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position); } `;var xzt=T(S(),1),wb=`#ifdef VECTOR_TILE uniform vec4 u_highlightColor; #endif void main(void) { #ifdef VECTOR_TILE out_FragColor = czm_gammaCorrect(u_highlightColor); #else out_FragColor = vec4(1.0); #endif czm_writeDepthClamp(); } `;var Tzt=T(S(),1),vte={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2};vte.NUMBER_OF_CLASSIFICATION_TYPES=3;var Un=Object.freeze(vte);var Vzt=T(S(),1);var jXe={NEVER:ne.NEVER,LESS:ne.LESS,EQUAL:ne.EQUAL,LESS_OR_EQUAL:ne.LEQUAL,GREATER:ne.GREATER,NOT_EQUAL:ne.NOTEQUAL,GREATER_OR_EQUAL:ne.GEQUAL,ALWAYS:ne.ALWAYS},tc=Object.freeze(jXe);var $Kt=T(S(),1);var Zzt=T(S(),1);function qXe(e,t){let n=[],i=e.length,o=0;for(;o<i;){let r=Math.ceil((i-o)/t--);n.push(e.slice(o,o+r)),o+=r}return n}var EE=qXe;var kzt=T(S(),1);function Tp(e,t,n){if(this._attributes=t,this._numberOfInstances=n,t.length===0)return;let i=$Xe(t),o=e.floatingPointTexture,r=i===Qe.FLOAT&&!o,s=eIe(t,r),a=tIe(s,t,r),c=Math.floor(Yt.maximumTextureSize/a),d=Math.min(n,c),u=a*d,m=Math.ceil(n/d),p=1/u,b=p*.5,f=1/m,x=f*.5;this._textureDimensions=new D(u,m),this._textureStep=new se(p,b,f,x),this._pixelDatatype=r?Qe.UNSIGNED_BYTE:i,this._packFloats=r,this._offsets=s,this._stride=a,this._texture=void 0;let _=4*u*m;this._batchValues=i===Qe.FLOAT&&!r?new Float32Array(_):new Uint8Array(_),this._batchValuesDirty=!1}Object.defineProperties(Tp.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function $Xe(e){let t=!1,n=e.length;for(let i=0;i<n;++i)if(e[i].componentDatatype!==Q.UNSIGNED_BYTE){t=!0;break}return t?Qe.FLOAT:Qe.UNSIGNED_BYTE}function Fte(e,t){let n=e[t].componentsPerAttribute;return n===2?D:n===3?h:n===4?se:Number}function eIe(e,t){let n=new Array(e.length),i=0,o=e.length;for(let r=0;r<o;++r){let a=e[r].componentDatatype;n[r]=i,a!==Q.UNSIGNED_BYTE&&t?i+=4:++i}return n}function tIe(e,t,n){let i=e.length,o=e[i-1];return t[i-1].componentDatatype!==Q.UNSIGNED_BYTE&&n?o+4:o+1}var XE=new se;function nIe(e,t,n){let i=se.unpack(e,t,XE),o=se.unpackFloat(i);i=se.unpack(e,t+4,XE);let r=se.unpackFloat(i);i=se.unpack(e,t+8,XE);let s=se.unpackFloat(i);i=se.unpack(e,t+12,XE);let a=se.unpackFloat(i);return se.fromElements(o,r,s,a,n)}function iIe(e,t,n){let i=se.packFloat(e.x,XE);se.pack(i,t,n),i=se.packFloat(e.y,i),se.pack(i,t,n+4),i=se.packFloat(e.z,i),se.pack(i,t,n+8),i=se.packFloat(e.w,i),se.pack(i,t,n+12)}var wte=new se;Tp.prototype.getBatchedAttribute=function(e,t,n){let i=this._attributes,o=this._offsets[t],s=4*this._stride*e+4*o,a;this._packFloats&&i[t].componentDatatype!==Qe.UNSIGNED_BYTE?a=nIe(this._batchValues,s,wte):a=se.unpack(this._batchValues,s,wte);let c=Fte(i,t);return l(c.fromCartesian4)?c.fromCartesian4(a,n):l(c.clone)?c.clone(a,n):a.x};var oIe=[void 0,void 0,new D,new h,new se],rIe=new se;Tp.prototype.setBatchedAttribute=function(e,t,n){let i=this._attributes,o=oIe[i[t].componentsPerAttribute],r=this.getBatchedAttribute(e,t,o),s=Fte(this._attributes,t);if(l(s.equals)?s.equals(r,n):r===n)return;let c=rIe;c.x=l(n.x)?n.x:n,c.y=l(n.y)?n.y:0,c.z=l(n.z)?n.z:0,c.w=l(n.w)?n.w:0;let d=this._offsets[t],m=4*this._stride*e+4*d;this._packFloats&&i[t].componentDatatype!==Qe.UNSIGNED_BYTE?iIe(c,this._batchValues,m):se.pack(c,this._batchValues,m),this._batchValuesDirty=!0};function sIe(e,t){let n=e._textureDimensions;e._texture=new Ft({context:t,pixelFormat:at.RGBA,pixelDatatype:e._pixelDatatype,width:n.x,height:n.y,sampler:mn.NEAREST,flipY:!1})}function aIe(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}Tp.prototype.update=function(e){l(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,l(this._texture)||sIe(this,e.context),aIe(this))};Tp.prototype.getUniformMapCallback=function(){let e=this;return function(t){return e._attributes.length===0?t:Ct(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}};function cIe(e){let t=e._stride;return e._textureDimensions.y===1?`uniform vec4 batchTextureStep; vec2 computeSt(float batchId) { float stepX = batchTextureStep.x; float centerX = batchTextureStep.y; float numberOfAttributes = float(${t}); return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); } `:`uniform vec4 batchTextureStep; uniform vec2 batchTextureDimensions; vec2 computeSt(float batchId) { float stepX = batchTextureStep.x; float centerX = batchTextureStep.y; float stepY = batchTextureStep.z; float centerY = batchTextureStep.w; float numberOfAttributes = float(${t}); float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); } `}function lIe(e){return e===1?\"float\":`vec${e}`}function dIe(e){return e===1?\".x\":e===2?\".xy\":e===3?\".xyz\":\"\"}function uIe(e,t){let i=e._attributes[t],o=i.componentsPerAttribute,r=i.functionName,s=lIe(o),a=dIe(o),c=e._offsets[t],d=`${s} ${r}(float batchId) { vec2 st = computeSt(batchId); st.x += batchTextureStep.x * float(${c}); `;return e._packFloats&&i.componentDatatype!==Qe.UNSIGNED_BYTE?d+=`vec4 textureValue; textureValue.x = czm_unpackFloat(texture(batchTexture, st)); textureValue.y = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x, 0.0))); textureValue.z = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); textureValue.w = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); `:d+=` vec4 textureValue = texture(batchTexture, st); `,d+=` ${s} value = textureValue${a}; `,e._pixelDatatype===Qe.UNSIGNED_BYTE&&i.componentDatatype===Q.UNSIGNED_BYTE&&!i.normalize?d+=`value *= 255.0; `:e._pixelDatatype===Qe.FLOAT&&i.componentDatatype===Q.UNSIGNED_BYTE&&i.normalize&&(d+=`value /= 255.0; `),d+=` return value; } `,d}Tp.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(e.length===0)return function(i){return i};let t=`uniform highp sampler2D batchTexture; `;t+=`${cIe(this)} `;let n=e.length;for(let i=0;i<n;++i)t+=uIe(this,i);return function(i){let o=i.indexOf(\"void main\"),r=i.substring(0,o),s=i.substring(o);return`${r} ${t} ${s}`}};Tp.prototype.isDestroyed=function(){return!1};Tp.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),me(this)};var mx=Tp;var cKt=T(S(),1);var MHt=T(S(),1);var nHt=T(S(),1);var Kzt=T(S(),1);var to={SCALAR:\"SCALAR\",VEC2:\"VEC2\",VEC3:\"VEC3\",VEC4:\"VEC4\",MAT2:\"MAT2\",MAT3:\"MAT3\",MAT4:\"MAT4\"};to.getMathType=function(e){switch(e){case to.SCALAR:return Number;case to.VEC2:return D;case to.VEC3:return h;case to.VEC4:return se;case to.MAT2:return qi;case to.MAT3:return $;case to.MAT4:return M}};to.getNumberOfComponents=function(e){switch(e){case to.SCALAR:return 1;case to.VEC2:return 2;case to.VEC3:return 3;case to.VEC4:case to.MAT2:return 4;case to.MAT3:return 9;case to.MAT4:return 16}};to.getAttributeLocationCount=function(e){switch(e){case to.SCALAR:case to.VEC2:case to.VEC3:case to.VEC4:return 1;case to.MAT2:return 2;case to.MAT3:return 3;case to.MAT4:return 4}};to.getGlslType=function(e){switch(e){case to.SCALAR:return\"float\";case to.VEC2:return\"vec2\";case to.VEC3:return\"vec3\";case to.VEC4:return\"vec4\";case to.MAT2:return\"mat2\";case to.MAT3:return\"mat3\";case to.MAT4:return\"mat4\"}};var tn=Object.freeze(to);var Ate=1/256,Mte=256,bo={};bo.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let i=n.x,o=n.y;n.x=(1-Math.abs(o))*P.signNotZero(i),n.y=(1-Math.abs(i))*P.signNotZero(o)}return n.x=P.toSNorm(n.x,t),n.y=P.toSNorm(n.y,t),n};bo.octEncode=function(e,t){return bo.octEncodeInRange(e,255,t)};var IE=new D,Nte=new Uint8Array(1);function y5(e){return Nte[0]=e,Nte[0]}bo.octEncodeToCartesian4=function(e,t){return bo.octEncodeInRange(e,65535,IE),t.x=y5(IE.x*Ate),t.y=y5(IE.x),t.z=y5(IE.y*Ate),t.w=y5(IE.y),t};bo.octDecodeInRange=function(e,t,n,i){if(i.x=P.fromSNorm(e,n),i.y=P.fromSNorm(t,n),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){let o=i.x;i.x=(1-Math.abs(i.y))*P.signNotZero(o),i.y=(1-Math.abs(o))*P.signNotZero(i.y)}return h.normalize(i,i)};bo.octDecode=function(e,t,n){return bo.octDecodeInRange(e,t,255,n)};bo.octDecodeFromCartesian4=function(e,t){let n=e.x,i=e.y,o=e.z,r=e.w,s=n*Mte+i,a=o*Mte+r;return bo.octDecodeInRange(s,a,65535,t)};bo.octPackFloat=function(e){return 256*e.x+e.y};var iO=new D;bo.octEncodeFloat=function(e){return bo.octEncode(e,iO),bo.octPackFloat(iO)};bo.octDecodeFloat=function(e,t){let n=e/256,i=Math.floor(n),o=(n-i)*256;return bo.octDecode(i,o,t)};bo.octPack=function(e,t,n,i){let o=bo.octEncodeFloat(e),r=bo.octEncodeFloat(t),s=bo.octEncode(n,iO);return i.x=65536*s.x+o,i.y=65536*s.y+r,i};bo.octUnpack=function(e,t,n,i){let o=e.x/65536,r=Math.floor(o),s=(o-r)*65536;o=e.y/65536;let a=Math.floor(o),c=(o-a)*65536;bo.octDecodeFloat(s,t),bo.octDecodeFloat(c,n),bo.octDecode(r,a,i)};bo.compressTextureCoordinates=function(e){let t=e.x*4095|0,n=e.y*4095|0;return 4096*t+n};bo.decompressTextureCoordinates=function(e,t){let n=e/4096,i=Math.floor(n);return t.x=i/4095,t.y=(e-i*4096)/4095,t};function nO(e){return e>>1^-(e&1)}bo.zigZagDeltaDecode=function(e,t,n){let i=e.length,o=0,r=0,s=0;for(let a=0;a<i;++a)o+=nO(e[a]),r+=nO(t[a]),e[a]=o,t[a]=r,l(n)&&(s+=nO(n[a]),n[a]=s)};bo.dequantize=function(e,t,n,i){let o=tn.getNumberOfComponents(n),r;switch(t){case Q.BYTE:r=127;break;case Q.UNSIGNED_BYTE:r=255;break;case Q.SHORT:r=32767;break;case Q.UNSIGNED_SHORT:r=65535;break;case Q.INT:r=2147483647;break;case Q.UNSIGNED_INT:r=4294967295;break}let s=new Float32Array(i*o);for(let a=0;a<i;a++)for(let c=0;c<o;c++){let d=a*o+c;s[d]=Math.max(e[d]/r,-1)}return s};bo.decodeRGB565=function(e,t){let n=e.length;l(t)||(t=new Float32Array(n*3));let i=31,o=63,r=1/31,s=1/63;for(let a=0;a<n;a++){let c=e[a],d=c>>11,u=c>>5&o,m=c&i,p=3*a;t[p]=d*r,t[p+1]=u*s,t[p+2]=m*r}return t};var wn=bo;var cHt=T(S(),1);var kte=new h,Ute=new h,Dte=new h;function mIe(e,t,n,i,o){l(o)||(o=new h);let r,s,a,c,d,u,m,p;if(l(t.z)){if(h.equalsEpsilon(e,t,P.EPSILON14))return h.clone(h.UNIT_X,o);if(h.equalsEpsilon(e,n,P.EPSILON14))return h.clone(h.UNIT_Y,o);if(h.equalsEpsilon(e,i,P.EPSILON14))return h.clone(h.UNIT_Z,o);r=h.subtract(n,t,kte),s=h.subtract(i,t,Ute),a=h.subtract(e,t,Dte),c=h.dot(r,r),d=h.dot(r,s),u=h.dot(r,a),m=h.dot(s,s),p=h.dot(s,a)}else{if(D.equalsEpsilon(e,t,P.EPSILON14))return h.clone(h.UNIT_X,o);if(D.equalsEpsilon(e,n,P.EPSILON14))return h.clone(h.UNIT_Y,o);if(D.equalsEpsilon(e,i,P.EPSILON14))return h.clone(h.UNIT_Z,o);r=D.subtract(n,t,kte),s=D.subtract(i,t,Ute),a=D.subtract(e,t,Dte),c=D.dot(r,r),d=D.dot(r,s),u=D.dot(r,a),m=D.dot(s,s),p=D.dot(s,a)}o.y=m*u-d*p,o.z=c*p-d*u;let b=c*m-d*d;if(b!==0)return o.y/=b,o.z/=b,o.x=1-o.y-o.z,o}var hx=mIe;var mHt=T(S(),1);var oO={};oO.calculateACMR=function(e){e=g(e,g.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,i=g(e.cacheSize,24),o=t.length;if(!l(n)){n=0;let a=0,c=t[a];for(;a<o;)c>n&&(n=c),++a,c=t[a]}let r=[];for(let a=0;a<n+1;a++)r[a]=0;let s=i+1;for(let a=0;a<o;++a)s-r[t[a]]>i&&(r[t[a]]=s,++s);return(s-i+1)/(o/3)};oO.tipsify=function(e){e=g(e,g.EMPTY_OBJECT);let t=e.indices,n=e.maximumIndex,i=g(e.cacheSize,24),o;function r(y,Z,E,I){for(;Z.length>=1;){let w=Z[Z.length-1];if(Z.splice(Z.length-1,1),y[w].numLiveTriangles>0)return w}for(;o<I;){if(y[o].numLiveTriangles>0)return++o,o-1;++o}return-1}function s(y,Z,E,I,w,k,B){let U=-1,Y,N=-1,J=0;for(;J<E.length;){let z=E[J];I[z].numLiveTriangles&&(Y=0,w-I[z].timeStamp+2*I[z].numLiveTriangles<=Z&&(Y=w-I[z].timeStamp),(Y>N||N===-1)&&(N=Y,U=z)),++J}return U===-1?r(I,k,y,B):U}let a=t.length,c=0,d=0,u=t[d],m=a;if(l(n))c=n+1;else{for(;d<m;)u>c&&(c=u),++d,u=t[d];if(c===-1)return 0;++c}let p=[],b;for(b=0;b<c;b++)p[b]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};d=0;let f=0;for(;d<m;)p[t[d]].vertexTriangles.push(f),++p[t[d]].numLiveTriangles,p[t[d+1]].vertexTriangles.push(f),++p[t[d+1]].numLiveTriangles,p[t[d+2]].vertexTriangles.push(f),++p[t[d+2]].numLiveTriangles,++f,d+=3;let x=0,_=i+1;o=1;let C=[],V=[],L,R,G=0,X=[],v=a/3,W=[];for(b=0;b<v;b++)W[b]=!1;let F,A;for(;x!==-1;){C=[],R=p[x],A=R.vertexTriangles.length;for(let y=0;y<A;++y)if(f=R.vertexTriangles[y],!W[f]){W[f]=!0,d=f+f+f;for(let Z=0;Z<3;++Z)F=t[d],C.push(F),V.push(F),X[G]=F,++G,L=p[F],--L.numLiveTriangles,_-L.timeStamp>i&&(L.timeStamp=_,++_),++d}x=s(t,i,C,p,_,V,c)}return X};var WE=oO;var Ac={};function V5(e,t,n,i,o){e[t++]=n,e[t++]=i,e[t++]=i,e[t++]=o,e[t++]=o,e[t]=n}function hIe(e){let t=e.length,n=t/3*6,i=Ae.createTypedArray(t,n),o=0;for(let r=0;r<t;r+=3,o+=6)V5(i,o,e[r],e[r+1],e[r+2]);return i}function fIe(e){let t=e.length;if(t>=3){let n=(t-2)*6,i=Ae.createTypedArray(t,n);V5(i,0,e[0],e[1],e[2]);let o=6;for(let r=3;r<t;++r,o+=6)V5(i,o,e[r-1],e[r],e[r-2]);return i}return new Uint16Array}function pIe(e){if(e.length>0){let t=e.length-1,n=(t-1)*6,i=Ae.createTypedArray(t,n),o=e[0],r=0;for(let s=1;s<t;++s,r+=6)V5(i,r,o,e[s],e[s+1]);return i}return new Uint16Array}Ac.toWireframe=function(e){let t=e.indices;if(l(t)){switch(e.primitiveType){case we.TRIANGLES:e.indices=hIe(t);break;case we.TRIANGLE_STRIP:e.indices=fIe(t);break;case we.TRIANGLE_FAN:e.indices=pIe(t);break}e.primitiveType=we.LINES}return e};Ac.createLineSegmentsForVectors=function(e,t,n){t=g(t,\"normal\"),n=g(n,1e4);let i=e.attributes.position.values,o=e.attributes[t].values,r=i.length,s=new Float64Array(2*r),a=0;for(let u=0;u<r;u+=3)s[a++]=i[u],s[a++]=i[u+1],s[a++]=i[u+2],s[a++]=i[u]+o[u]*n,s[a++]=i[u+1]+o[u+1]*n,s[a++]=i[u+2]+o[u+2]*n;let c,d=e.boundingSphere;return l(d)&&(c=new ce(d.center,d.radius+n)),new ut({attributes:{position:new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:we.LINES,boundingSphere:c})};Ac.createAttributeLocations=function(e){let t=[\"position\",\"positionHigh\",\"positionLow\",\"position3DHigh\",\"position3DLow\",\"position2DHigh\",\"position2DLow\",\"pickColor\",\"normal\",\"st\",\"tangent\",\"bitangent\",\"extrudeDirection\",\"compressedAttributes\"],n=e.attributes,i={},o=0,r,s=t.length;for(r=0;r<s;++r){let a=t[r];l(n[a])&&(i[a]=o++)}for(let a in n)n.hasOwnProperty(a)&&!l(i[a])&&(i[a]=o++);return i};Ac.reorderForPreVertexCache=function(e){let t=ut.computeNumberOfVertices(e),n=e.indices;if(l(n)){let i=new Int32Array(t);for(let p=0;p<t;p++)i[p]=-1;let o=n,r=o.length,s=Ae.createTypedArray(t,r),a=0,c=0,d=0,u;for(;a<r;)u=i[o[a]],u!==-1?s[c]=u:(u=o[a],i[u]=d,s[c]=d,++d),++a,++c;e.indices=s;let m=e.attributes;for(let p in m)if(m.hasOwnProperty(p)&&l(m[p])&&l(m[p].values)){let b=m[p],f=b.values,x=0,_=b.componentsPerAttribute,C=Q.createTypedArray(b.componentDatatype,d*_);for(;x<t;){let V=i[x];if(V!==-1)for(let L=0;L<_;L++)C[_*V+L]=f[_*x+L];++x}b.values=C}}return e};Ac.reorderForPostVertexCache=function(e,t){let n=e.indices;if(e.primitiveType===we.TRIANGLES&&l(n)){let i=n.length,o=0;for(let r=0;r<i;r++)n[r]>o&&(o=n[r]);e.indices=WE.tipsify({indices:n,maximumIndex:o,cacheSize:t})}return e};function Bte(e){let t={};for(let n in e)if(e.hasOwnProperty(n)&&l(e[n])&&l(e[n].values)){let i=e[n];t[n]=new Ee({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return t}function bIe(e,t,n){for(let i in t)if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){let o=t[i];for(let r=0;r<o.componentsPerAttribute;++r)e[i].values.push(o.values[n*o.componentsPerAttribute+r])}}Ac.fitToUnsignedShortIndices=function(e){let t=[],n=ut.computeNumberOfVertices(e);if(l(e.indices)&&n>=P.SIXTY_FOUR_KILOBYTES){let i=[],o=[],r=0,s=Bte(e.attributes),a=e.indices,c=a.length,d;e.primitiveType===we.TRIANGLES?d=3:e.primitiveType===we.LINES?d=2:e.primitiveType===we.POINTS&&(d=1);for(let u=0;u<c;u+=d){for(let m=0;m<d;++m){let p=a[u+m],b=i[p];l(b)||(b=r++,i[p]=b,bIe(s,e.attributes,p)),o.push(b)}r+d>=P.SIXTY_FOUR_KILOBYTES&&(t.push(new ut({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),i=[],o=[],r=0,s=Bte(e.attributes))}o.length!==0&&t.push(new ut({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var Yte=new h,yIe=new he;Ac.projectTo2D=function(e,t,n,i,o){let r=e.attributes[t];o=l(o)?o:new Ci;let s=o.ellipsoid,a=r.values,c=new Float64Array(a.length),d=0;for(let u=0;u<a.length;u+=3){let m=h.fromArray(a,u,Yte),p=s.cartesianToCartographic(m,yIe),b=o.project(p,Yte);c[d++]=b.x,c[d++]=b.y,c[d++]=b.z}return e.attributes[n]=r,e.attributes[i]=new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:c}),delete e.attributes[t],e};var rO={high:0,low:0};Ac.encodeAttribute=function(e,t,n,i){let o=e.attributes[t],r=o.values,s=r.length,a=new Float32Array(s),c=new Float32Array(s);for(let u=0;u<s;++u)Yn.encode(r[u],rO),a[u]=rO.high,c[u]=rO.low;let d=o.componentsPerAttribute;return e.attributes[n]=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:d,values:a}),e.attributes[i]=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:d,values:c}),delete e.attributes[t],e};var Vm=new h;function sO(e,t){if(l(t)){let n=t.values,i=n.length;for(let o=0;o<i;o+=3)h.unpack(n,o,Vm),M.multiplyByPoint(e,Vm,Vm),h.pack(Vm,n,o)}}function aO(e,t){if(l(t)){let n=t.values,i=n.length;for(let o=0;o<i;o+=3)h.unpack(n,o,Vm),$.multiplyByVector(e,Vm,Vm),Vm=h.normalize(Vm,Vm),h.pack(Vm,n,o)}}var g5=new M,x5=new $;Ac.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(M.equals(t,M.IDENTITY))return e;let n=e.geometry.attributes;sO(t,n.position),sO(t,n.prevPosition),sO(t,n.nextPosition),(l(n.normal)||l(n.tangent)||l(n.bitangent))&&(M.inverse(t,g5),M.transpose(g5,g5),M.getMatrix3(g5,x5),aO(x5,n.normal),aO(x5,n.tangent),aO(x5,n.bitangent));let i=e.geometry.boundingSphere;return l(i)&&(e.geometry.boundingSphere=ce.transform(i,t,i)),e.modelMatrix=M.clone(M.IDENTITY),e};function gIe(e,t){let n=e.length,i={},o=e[0][t].attributes,r;for(r in o)if(o.hasOwnProperty(r)&&l(o[r])&&l(o[r].values)){let s=o[r],a=s.values.length,c=!0;for(let d=1;d<n;++d){let u=e[d][t].attributes[r];if(!l(u)||s.componentDatatype!==u.componentDatatype||s.componentsPerAttribute!==u.componentsPerAttribute||s.normalize!==u.normalize){c=!1;break}a+=u.values.length}c&&(i[r]=new Ee({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:Q.createTypedArray(s.componentDatatype,a)}))}return i}var xIe=new h;function cO(e,t){let n=e.length,i,o,r,s,a=e[0].modelMatrix,c=l(e[0][t].indices),d=e[0][t].primitiveType,u=gIe(e,t),m,p,b;for(i in u)if(u.hasOwnProperty(i))for(m=u[i].values,s=0,o=0;o<n;++o)for(p=e[o][t].attributes[i].values,b=p.length,r=0;r<b;++r)m[s++]=p[r];let f;if(c){let V=0;for(o=0;o<n;++o)V+=e[o][t].indices.length;let L=ut.computeNumberOfVertices(new ut({attributes:u,primitiveType:we.POINTS})),R=Ae.createTypedArray(L,V),G=0,X=0;for(o=0;o<n;++o){let v=e[o][t].indices,W=v.length;for(s=0;s<W;++s)R[G++]=X+v[s];X+=ut.computeNumberOfVertices(e[o][t])}f=R}let x=new h,_=0,C;for(o=0;o<n;++o){if(C=e[o][t].boundingSphere,!l(C)){x=void 0;break}h.add(C.center,x,x)}if(l(x))for(h.divideByScalar(x,n,x),o=0;o<n;++o){C=e[o][t].boundingSphere;let V=h.magnitude(h.subtract(C.center,x,xIe))+C.radius;V>_&&(_=V)}return new ut({attributes:u,indices:f,primitiveType:d,boundingSphere:l(x)?new ce(x,_):void 0})}Ac.combineInstances=function(e){let t=[],n=[],i=e.length;for(let r=0;r<i;++r){let s=e[r];l(s.geometry)?t.push(s):l(s.westHemisphereGeometry)&&l(s.eastHemisphereGeometry)&&n.push(s)}let o=[];return t.length>0&&o.push(cO(t,\"geometry\")),n.length>0&&(o.push(cO(n,\"westHemisphereGeometry\")),o.push(cO(n,\"eastHemisphereGeometry\"))),o};var lu=new h,PE=new h,HS=new h,KS=new h;Ac.computeNormal=function(e){let t=e.indices,n=e.attributes,i=n.position.values,o=n.position.values.length/3,r=t.length,s=new Array(o),a=new Array(r/3),c=new Array(r),d;for(d=0;d<o;d++)s[d]={indexOffset:0,count:0,currentCount:0};let u=0;for(d=0;d<r;d+=3){let f=t[d],x=t[d+1],_=t[d+2],C=f*3,V=x*3,L=_*3;PE.x=i[C],PE.y=i[C+1],PE.z=i[C+2],HS.x=i[V],HS.y=i[V+1],HS.z=i[V+2],KS.x=i[L],KS.y=i[L+1],KS.z=i[L+2],s[f].count++,s[x].count++,s[_].count++,h.subtract(HS,PE,HS),h.subtract(KS,PE,KS),a[u]=h.cross(HS,KS,new h),u++}let m=0;for(d=0;d<o;d++)s[d].indexOffset+=m,m+=s[d].count;u=0;let p;for(d=0;d<r;d+=3){p=s[t[d]];let f=p.indexOffset+p.currentCount;c[f]=u,p.currentCount++,p=s[t[d+1]],f=p.indexOffset+p.currentCount,c[f]=u,p.currentCount++,p=s[t[d+2]],f=p.indexOffset+p.currentCount,c[f]=u,p.currentCount++,u++}let b=new Float32Array(o*3);for(d=0;d<o;d++){let f=d*3;if(p=s[d],h.clone(h.ZERO,lu),p.count>0){for(u=0;u<p.count;u++)h.add(lu,a[c[p.indexOffset+u]],lu);h.equalsEpsilon(h.ZERO,lu,P.EPSILON10)&&h.clone(a[c[p.indexOffset]],lu)}h.equalsEpsilon(h.ZERO,lu,P.EPSILON10)&&(lu.z=1),h.normalize(lu,lu),b[f]=lu.x,b[f+1]=lu.y,b[f+2]=lu.z}return e.attributes.normal=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:b}),e};var _Ie=new h,Ote=new h,TIe=new h;Ac.computeTangentAndBitangent=function(e){let t=e.attributes,n=e.indices,i=e.attributes.position.values,o=e.attributes.normal.values,r=e.attributes.st.values,s=e.attributes.position.values.length/3,a=n.length,c=new Array(s*3),d;for(d=0;d<c.length;d++)c[d]=0;let u,m,p;for(d=0;d<a;d+=3){let x=n[d],_=n[d+1],C=n[d+2];u=x*3,m=_*3,p=C*3;let V=x*2,L=_*2,R=C*2,G=i[u],X=i[u+1],v=i[u+2],W=r[V],F=r[V+1],A=r[L+1]-F,y=r[R+1]-F,Z=1/((r[L]-W)*y-(r[R]-W)*A),E=(y*(i[m]-G)-A*(i[p]-G))*Z,I=(y*(i[m+1]-X)-A*(i[p+1]-X))*Z,w=(y*(i[m+2]-v)-A*(i[p+2]-v))*Z;c[u]+=E,c[u+1]+=I,c[u+2]+=w,c[m]+=E,c[m+1]+=I,c[m+2]+=w,c[p]+=E,c[p+1]+=I,c[p+2]+=w}let b=new Float32Array(s*3),f=new Float32Array(s*3);for(d=0;d<s;d++){u=d*3,m=u+1,p=u+2;let x=h.fromArray(o,u,_Ie),_=h.fromArray(c,u,TIe),C=h.dot(x,_);h.multiplyByScalar(x,C,Ote),h.normalize(h.subtract(_,Ote,_),_),b[u]=_.x,b[m]=_.y,b[p]=_.z,h.normalize(h.cross(x,_,_),_),f[u]=_.x,f[m]=_.y,f[p]=_.z}return e.attributes.tangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:b}),e.attributes.bitangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:f}),e};var vE=new D,Cm=new h,zte=new h,Hte=new h,_5=new D;Ac.compressVertices=function(e){let t=e.attributes.extrudeDirection,n,i;if(l(t)){let X=t.values;i=X.length/3;let v=new Float32Array(i*2),W=0;for(n=0;n<i;++n){if(h.fromArray(X,n*3,Cm),h.equals(Cm,h.ZERO)){W+=2;continue}_5=wn.octEncodeInRange(Cm,65535,_5),v[W++]=_5.x,v[W++]=_5.y}return e.attributes.compressedAttributes=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:2,values:v}),delete e.attributes.extrudeDirection,e}let o=e.attributes.normal,r=e.attributes.st,s=l(o),a=l(r);if(!s&&!a)return e;let c=e.attributes.tangent,d=e.attributes.bitangent,u=l(c),m=l(d),p,b,f,x;s&&(p=o.values),a&&(b=r.values),u&&(f=c.values),m&&(x=d.values),i=(s?p.length:b.length)/(s?3:2);let V=i,L=a&&s?2:1;L+=u||m?1:0,V*=L;let R=new Float32Array(V),G=0;for(n=0;n<i;++n){a&&(D.fromArray(b,n*2,vE),R[G++]=wn.compressTextureCoordinates(vE));let X=n*3;s&&l(f)&&l(x)?(h.fromArray(p,X,Cm),h.fromArray(f,X,zte),h.fromArray(x,X,Hte),wn.octPack(Cm,zte,Hte,vE),R[G++]=vE.x,R[G++]=vE.y):(s&&(h.fromArray(p,X,Cm),R[G++]=wn.octEncodeFloat(Cm)),u&&(h.fromArray(f,X,Cm),R[G++]=wn.octEncodeFloat(Cm)),m&&(h.fromArray(x,X,Cm),R[G++]=wn.octEncodeFloat(Cm)))}return e.attributes.compressedAttributes=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:L,values:R}),s&&delete e.attributes.normal,a&&delete e.attributes.st,m&&delete e.attributes.bitangent,u&&delete e.attributes.tangent,e};function SIe(e){if(l(e.indices))return e;let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function CIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-2)*3);n[0]=1,n[1]=0,n[2]=2;let i=3;for(let o=3;o<t;++o)n[i++]=o-1,n[i++]=0,n[i++]=o;return e.indices=n,e.primitiveType=we.TRIANGLES,e}function VIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-2)*3);n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);let i=6;for(let o=3;o<t-1;o+=2)n[i++]=o,n[i++]=o-1,n[i++]=o+1,o+2<t&&(n[i++]=o,n[i++]=o+1,n[i++]=o+2);return e.indices=n,e.primitiveType=we.TRIANGLES,e}function LIe(e){if(l(e.indices))return e;let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t);for(let i=0;i<t;++i)n[i]=i;return e.indices=n,e}function ZIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,(t-1)*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return e.indices=n,e.primitiveType=we.LINES,e}function RIe(e){let t=ut.computeNumberOfVertices(e),n=Ae.createTypedArray(t,t*2);n[0]=0,n[1]=1;let i=2;for(let o=2;o<t;++o)n[i++]=o-1,n[i++]=o;return n[i++]=t-1,n[i]=0,e.indices=n,e.primitiveType=we.LINES,e}function GIe(e){switch(e.primitiveType){case we.TRIANGLE_FAN:return CIe(e);case we.TRIANGLE_STRIP:return VIe(e);case we.TRIANGLES:return SIe(e);case we.LINE_STRIP:return ZIe(e);case we.LINE_LOOP:return RIe(e);case we.LINES:return LIe(e)}return e}function Fb(e,t){Math.abs(e.y)<P.EPSILON6&&(t?e.y=-P.EPSILON6:e.y=P.EPSILON6)}function EIe(e,t,n){if(e.y!==0&&t.y!==0&&n.y!==0){Fb(e,e.y<0),Fb(t,t.y<0),Fb(n,n.y<0);return}let i=Math.abs(e.y),o=Math.abs(t.y),r=Math.abs(n.y),s;i>o?i>r?s=P.sign(e.y):s=P.sign(n.y):o>r?s=P.sign(t.y):s=P.sign(n.y);let a=s<0;Fb(e,a),Fb(t,a),Fb(n,a)}var Kte=new h;function du(e,t,n,i){h.add(e,h.multiplyByScalar(h.subtract(t,e,Kte),e.y/(e.y-t.y),Kte),n),h.clone(n,i),Fb(n,!0),Fb(i,!1)}var fx=new h,px=new h,bx=new h,yx=new h,lO={positions:new Array(7),indices:new Array(3*3)};function XIe(e,t,n){if(e.x>=0||t.x>=0||n.x>=0)return;EIe(e,t,n);let i=e.y<0,o=t.y<0,r=n.y<0,s=0;s+=i?1:0,s+=o?1:0,s+=r?1:0;let a=lO.indices;s===1?(a[1]=3,a[2]=4,a[5]=6,a[7]=6,a[8]=5,i?(du(e,t,fx,bx),du(e,n,px,yx),a[0]=0,a[3]=1,a[4]=2,a[6]=1):o?(du(t,n,fx,bx),du(t,e,px,yx),a[0]=1,a[3]=2,a[4]=0,a[6]=2):r&&(du(n,e,fx,bx),du(n,t,px,yx),a[0]=2,a[3]=0,a[4]=1,a[6]=0)):s===2&&(a[2]=4,a[4]=4,a[5]=3,a[7]=5,a[8]=6,i?o?r||(du(n,e,fx,bx),du(n,t,px,yx),a[0]=0,a[1]=1,a[3]=0,a[6]=2):(du(t,n,fx,bx),du(t,e,px,yx),a[0]=2,a[1]=0,a[3]=2,a[6]=1):(du(e,t,fx,bx),du(e,n,px,yx),a[0]=1,a[1]=2,a[3]=1,a[6]=0));let c=lO.positions;return c[0]=e,c[1]=t,c[2]=n,c.length=3,(s===1||s===2)&&(c[3]=fx,c[4]=px,c[5]=bx,c[6]=yx,c.length=7),lO}function Jte(e,t){let n=e.attributes;if(n.position.values.length===0)return;for(let o in n)if(n.hasOwnProperty(o)&&l(n[o])&&l(n[o].values)){let r=n[o];r.values=Q.createTypedArray(r.componentDatatype,r.values)}let i=ut.computeNumberOfVertices(e);return e.indices=Ae.createTypedArray(i,e.indices),t&&(e.boundingSphere=ce.fromVertices(n.position.values)),e}function QS(e){let t=e.attributes,n={};for(let i in t)if(t.hasOwnProperty(i)&&l(t[i])&&l(t[i].values)){let o=t[i];n[i]=new Ee({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return new ut({attributes:n,indices:[],primitiveType:e.primitiveType})}function hO(e,t,n){let i=l(e.geometry.boundingSphere);t=Jte(t,i),n=Jte(n,i),l(n)&&!l(t)?e.geometry=n:!l(n)&&l(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function fO(e,t){let n=new e,i=new e,o=new e;return function(r,s,a,c,d,u,m,p){let b=e.fromArray(d,r*t,n),f=e.fromArray(d,s*t,i),x=e.fromArray(d,a*t,o);e.multiplyByScalar(b,c.x,b),e.multiplyByScalar(f,c.y,f),e.multiplyByScalar(x,c.z,x);let _=e.add(b,f,b);e.add(_,x,_),p&&e.normalize(_,_),e.pack(_,u,m*t)}}var IIe=fO(se,4),C5=fO(h,3),tne=fO(D,2),WIe=function(e,t,n,i,o,r,s){let a=o[e]*i.x,c=o[t]*i.y,d=o[n]*i.z;r[s]=a+c+d>P.EPSILON6?1:0},wE=new h,dO=new h,uO=new h,PIe=new h;function T5(e,t,n,i,o,r,s,a,c,d,u,m,p,b,f,x){if(!l(r)&&!l(s)&&!l(a)&&!l(c)&&!l(d)&&b===0)return;let"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 120,
    "total_chunks": 194,
    "chunk_size": 48601,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.723Z"
  },
  "content": "m=P.toDegrees(u.longitude).toString(),p=P.toDegrees(u.latitude).toString();c=c.replace(\"[lookatLon]\",m),c=c.replace(\"[lookatLat]\",p),c=c.replace(\"[lookatTilt]\",P.toDegrees(t.pitch).toString()),c=c.replace(\"[lookatHeading]\",P.toDegrees(t.heading).toString()),c=c.replace(\"[lookatRange]\",h.distance(t.positionWC,d)),c=c.replace(\"[lookatTerrainLon]\",m),c=c.replace(\"[lookatTerrainLat]\",p),c=c.replace(\"[lookatTerrainAlt]\",u.height.toString()),r.cartesianToCartographic(t.positionWC,gV),c=c.replace(\"[cameraLon]\",P.toDegrees(gV.longitude).toString()),c=c.replace(\"[cameraLat]\",P.toDegrees(gV.latitude).toString()),c=c.replace(\"[cameraAlt]\",P.toDegrees(gV.height).toString());let b=t.frustum,f=b.aspectRatio,x=\"\",_=\"\";if(l(f)){let C=P.toDegrees(b.fov);f>1?(x=C,_=C/f):(_=C,x=C*f)}c=c.replace(\"[horizFov]\",x.toString()),c=c.replace(\"[vertFov]\",_.toString())}else c=c.replace(\"[bboxWest]\",\"-180\"),c=c.replace(\"[bboxSouth]\",\"-90\"),c=c.replace(\"[bboxEast]\",\"180\"),c=c.replace(\"[bboxNorth]\",\"90\"),c=c.replace(\"[lookatLon]\",\"\"),c=c.replace(\"[lookatLat]\",\"\"),c=c.replace(\"[lookatRange]\",\"\"),c=c.replace(\"[lookatTilt]\",\"\"),c=c.replace(\"[lookatHeading]\",\"\"),c=c.replace(\"[lookatTerrainLon]\",\"\"),c=c.replace(\"[lookatTerrainLat]\",\"\"),c=c.replace(\"[lookatTerrainAlt]\",\"\"),c=c.replace(\"[cameraLon]\",\"\"),c=c.replace(\"[cameraLat]\",\"\"),c=c.replace(\"[cameraAlt]\",\"\"),c=c.replace(\"[horizFov]\",\"\"),c=c.replace(\"[vertFov]\",\"\");l(n)?(c=c.replace(\"[horizPixels]\",n.clientWidth),c=c.replace(\"[vertPixels]\",n.clientHeight)):(c=c.replace(\"[horizPixels]\",\"\"),c=c.replace(\"[vertPixels]\",\"\")),c=c.replace(\"[terrainEnabled]\",\"1\"),c=c.replace(\"[clientVersion]\",\"1\"),c=c.replace(\"[kmlVersion]\",\"2.2\"),c=c.replace(\"[clientName]\",\"Cesium\"),c=c.replace(\"[language]\",\"English\"),e.setQueryParameters(nd(c))}function Nnt(e,t,n,i){let r=OU(e,t,n).entity,s=n.sourceResource,a=n.uriResolver,c=Xi(t,\"Link\",ve.kml);if(l(c)||(c=Xi(t,\"Url\",ve.kml)),l(c)){let d=In(c,\"href\",ve.kml),u,m;if(l(d)){let p=d;if(d=QQ(d,s,n.uriResolver),/^data:/.test(d.getUrlComponent()))/\\.kmz/i.test(s.getUrlComponent())||(p=s.getDerivedResource({url:p}));else{if(p=d.clone(),u=In(c,\"viewRefreshMode\",ve.kml),u===\"onRegion\"){wt(\"kml-refrehMode-onRegion\",\"KML - Unsupported viewRefreshMode: onRegion\");return}m=g(In(c,\"viewBoundScale\",ve.kml),1);let _=u===\"onStop\"?\"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]\":\"\",C=g(In(c,\"viewFormat\",ve.kml),_),V=In(c,\"httpQuery\",ve.kml);l(C)&&d.setQueryParameters(nd(DU(C))),l(V)&&d.setQueryParameters(nd(DU(V)));let L=e._ellipsoid;e4(d,e.camera,e.canvas,m,e._lastCameraView.bbox,L)}let b={sourceUri:p,uriResolver:a,context:r.id,screenOverlayContainer:n.screenOverlayContainer},f=new Us,x=t4(e,f,d,b).then(function(_){let C=e._entityCollection,V=f.values;C.suspendEvents();for(let G=0;G<V.length;G++){let X=V[G];l(X.parent)||(X.parent=r,n4(X)),C.add(X)}C.resumeEvents();let L=In(c,\"refreshMode\",ve.kml),R=g(qn(c,\"refreshInterval\",ve.kml),0);if(L===\"onInterval\"&&R>0||L===\"onExpire\"||u===\"onStop\"){let G=Xi(_,\"NetworkLinkControl\",ve.kml),X=l(G),v=te.now(),W={id:Bn(),href:d,cookie:{},lastUpdated:v,updating:!1,entity:r,viewBoundScale:m,needsUpdate:!1,cameraUpdateTime:v},F=0;if(X&&(W.cookie=nd(g(In(G,\"cookie\",ve.kml),\"\")),F=g(qn(G,\"minRefreshPeriod\",ve.kml),0)),L===\"onInterval\")X&&(R=Math.max(F,R)),W.refreshMode=dg.INTERVAL,W.time=R;else if(L===\"onExpire\"){let A;if(X&&(A=In(G,\"expires\",ve.kml)),l(A))try{let y=te.fromIso8601(A),Z=te.secondsDifference(y,v);Z>0&&Z<F&&te.addSeconds(v,F,y),W.refreshMode=dg.EXPIRE,W.time=y}catch{wt(\"kml-refreshMode-onInterval-onExpire\",\"KML - NetworkLinkControl expires is not a valid date\")}else wt(\"kml-refreshMode-onExpire\",\"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element\")}else l(e.camera)?(W.refreshMode=dg.STOP,W.time=g(qn(c,\"viewRefreshTime\",ve.kml),0)):wt(\"kml-refrehMode-onStop-noCamera\",\"A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.\");l(W.refreshMode)&&e._networkLinks.set(W.id,W)}}).catch(function(_){wt(`An error occured during loading ${d.url}`),e._error.raiseEvent(e,_)});i.addPromise(x)}}}function knt(e,t,n,i){let o=JQ[t.localName];return l(o)?o(e,t,n,i):j0e(e,t,n,i)}function HQ(e,t,n,i,o,r,s){t.removeAll();let a=n.documentElement,c=a.localName===\"Document\"?a:Xi(a,\"Document\",ve.kml),d=In(c,\"name\",ve.kml);l(d)||(d=G0(i.getUrlComponent())),l(e._name)||(e._name=d);let u=new Md._DeferredLoading(e),m=new Us(e);return Promise.all(Y0e(e,n,m,i,!1,o)).then(function(){let p=n.documentElement;if(p.localName===\"kml\"){let f=p.childNodes;for(let x=0;x<f.length;x++){let _=f[x];if(l(JQ[_.localName])){p=_;break}}}let b={parentEntity:void 0,entityCollection:t,styleCollection:m,sourceResource:i,uriResolver:o,context:s,screenOverlayContainer:r};return t.suspendEvents(),knt(e,p,b,u),t.resumeEvents(),u.wait().then(function(){return n.documentElement})})}function Unt(e,t,n,i,o){let r=on(\"ThirdParty/Workers/z-worker-pako.js\");dV({workerScripts:{deflate:[r,\"./pako_deflate.min.js\"],inflate:[r,\"./pako_inflate.min.js\"]}});let s=new PU(new O0(n));return Promise.resolve(s.getEntries()).then(function(a){let c=[],d={},u;for(let m=0;m<a.length;m++){let p=a[m];p.directory||(/\\.kml$/i.test(p.filename)&&(!l(u)||!/\\//i.test(p.filename))?(l(u)&&c.push(DQ(u,d)),u=p):c.push(DQ(p,d)))}return l(u)&&c.push(hnt(u,d)),Promise.all(c).then(function(){if(s.close(),!l(d.kml))throw new ue(\"KMZ file does not contain a KML document.\");return d.keys=Object.keys(d),HQ(e,t,d.kml,i,d,o)})})}function t4(e,t,n,i){i=g(i,g.EMPTY_OBJECT);let o=i.sourceUri,r=i.uriResolver,s=i.context,a=i.screenOverlayContainer,c=n;if(typeof n==\"string\"||n instanceof Xe){n=Xe.createIfNeeded(n),c=n.fetchBlob(),o=g(o,n.clone());let d=e._resourceCredits,u=n.credits;if(l(u)){let m=u.length;for(let p=0;p<m;p++)d.push(u[p])}}else o=g(o,Xe.DEFAULT.clone());return o=Xe.createIfNeeded(o),l(a)&&(a=Xn(a)),Promise.resolve(c).then(function(d){return d instanceof Blob?unt(d).then(function(u){return u?Unt(e,t,d,o,a):mnt(d).then(function(m){m=N0e(m),m=k0e(m);let p,b;try{p=KQ.parseFromString(m,\"application/xml\")}catch(f){b=f.toString()}if(l(b)||p.body||p.documentElement.tagName===\"parsererror\"){let f=l(b)?b:p.documentElement.firstChild.nodeValue;throw f||(f=p.body.innerText),new ue(f)}return HQ(e,t,p,o,r,a,s)})}):HQ(e,t,d,o,r,a,s)}).catch(function(d){return e._error.raiseEvent(e,d),console.log(d),Promise.reject(d)})}function Md(e){e=g(e,g.EMPTY_OBJECT);let t=e.camera,n=e.canvas;this._changed=new ge,this._error=new ge,this._loading=new ge,this._refresh=new ge,this._unsupportedNode=new ge,this._clock=void 0,this._entityCollection=new Us(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new k0,this._networkLinks=new Lt,this._entityCluster=new Sd,this.canvas=n,this.camera=t,this._lastCameraView={position:l(t)?h.clone(t.positionWC):void 0,direction:l(t)?h.clone(t.directionWC):void 0,up:l(t)?h.clone(t.upWC):void 0,bbox:l(t)?t.computeViewRectangle():le.clone(le.MAX_VALUE)},this._ellipsoid=g(e.ellipsoid,oe.WGS84);let i=e.credit;typeof i==\"string\"&&(i=new Zt(i)),this._credit=i,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}Md.load=function(e,t){return t=g(t,g.EMPTY_OBJECT),new Md(t).load(e,t)};Object.defineProperties(Md.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}});Md.prototype.load=function(e,t){t=g(t,g.EMPTY_OBJECT),Pr.setLoading(this,!0);let n=this._name;this._name=void 0,this._clampToGround=g(t.clampToGround,!1);let i=this;return t4(this,this._entityCollection,e,t).then(function(){let o,r=i._entityCollection.computeAvailability(),s=r.start,a=r.stop,c=te.equals(s,Be.MINIMUM_VALUE),d=te.equals(a,Be.MAXIMUM_VALUE);if(!c||!d){let m;c&&(m=new Date,m.setHours(0,0,0,0),s=te.fromDate(m)),d&&(m=new Date,m.setHours(24,0,0,0),a=te.fromDate(m)),o=new nh,o.startTime=s,o.stopTime=a,o.currentTime=te.clone(s),o.clockRange=vr.LOOP_STOP,o.clockStep=mo.SYSTEM_CLOCK_MULTIPLIER,o.multiplier=Math.round(Math.min(Math.max(te.secondsDifference(a,s)/60,1),31556900))}let u=!1;return o!==i._clock&&(i._clock=o,u=!0),n!==i._name&&(u=!0),u&&i._changed.raiseEvent(i),Pr.setLoading(i,!1),i}).catch(function(o){return Pr.setLoading(i,!1),i._error.raiseEvent(i,o),console.log(o),Promise.reject(o)})};Md.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};function n4(e){let t=e.parent;if(l(t)){let n=t.availability;if(l(n)){let i=e.availability;l(i)?i.intersect(n):e.availability=n}}}function Dnt(e,t,n,i,o){return function(r){if(!i.contains(t.id))return;let s=!1,a=Xi(r,\"NetworkLinkControl\",ve.kml),c=l(a),d=0;if(c){if(l(Xi(a,\"Update\",ve.kml))){wt(\"kml-networkLinkControl-update\",\"KML - NetworkLinkControl updates aren't supported.\"),t.updating=!1,i.remove(t.id);return}t.cookie=nd(g(In(a,\"cookie\",ve.kml),\"\")),d=g(qn(a,\"minRefreshPeriod\",ve.kml),0)}let u=te.now(),m=t.refreshMode;if(m===dg.INTERVAL)l(a)&&(t.time=Math.max(d,t.time));else if(m===dg.EXPIRE){let v;if(l(a)&&(v=In(a,\"expires\",ve.kml)),l(v))try{let W=te.fromIso8601(v),F=te.secondsDifference(W,u);F>0&&F<d&&te.addSeconds(u,d,W),t.time=W}catch{wt(\"kml-networkLinkControl-expires\",\"KML - NetworkLinkControl expires is not a valid date\"),s=!0}else wt(\"kml-refreshMode-onExpire\",\"KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element\"),s=!0}let p=t.entity,b=e._entityCollection,f=n.values;function x(v){b.remove(v);let W=v._children,F=W.length;for(let A=0;A<F;++A)x(W[A])}b.suspendEvents();let _=b.values.slice(),C;for(C=0;C<_.length;++C){let v=_[C];v.parent===p&&(v.parent=void 0,x(v))}for(b.resumeEvents(),b.suspendEvents(),C=0;C<f.length;C++){let v=f[C];l(v.parent)||(v.parent=p,n4(v)),b.add(v)}b.resumeEvents(),s?i.remove(t.id):t.lastUpdated=u;let V=b.computeAvailability(),L=V.start,R=V.stop,G=te.equals(L,Be.MINIMUM_VALUE),X=te.equals(R,Be.MAXIMUM_VALUE);if(!G||!X){let v=e._clock;(v.startTime!==L||v.stopTime!==R)&&(v.startTime=L,v.stopTime=R,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,o.getUrlComponent(!0))}}var OQ=new Lt;Md.prototype.update=function(e){let t=this._networkLinks;if(t.length===0)return!0;let n=te.now(),i=this;OQ.removeAll();function o(u){let m=u._children,p=m.length;for(let b=0;b<p;++b){let f=m[b];OQ.set(f.id,f),o(f)}}let r=!1,s=this._lastCameraView,a=this.camera;l(a)&&!(a.positionWC.equalsEpsilon(s.position,P.EPSILON7)&&a.directionWC.equalsEpsilon(s.direction,P.EPSILON7)&&a.upWC.equalsEpsilon(s.up,P.EPSILON7))&&(s.position=h.clone(a.positionWC),s.direction=h.clone(a.directionWC),s.up=h.clone(a.upWC),s.bbox=a.computeViewRectangle(),r=!0);let c=new Lt,d=!1;return t.values.forEach(function(u){let m=u.entity;if(!OQ.contains(m.id)){if(!u.updating){let p=!1;if(u.refreshMode===dg.INTERVAL?te.secondsDifference(n,u.lastUpdated)>u.time&&(p=!0):u.refreshMode===dg.EXPIRE?te.greaterThan(n,u.time)&&(p=!0):u.refreshMode===dg.STOP&&(r&&(u.needsUpdate=!0,u.cameraUpdateTime=n),u.needsUpdate&&te.secondsDifference(n,u.cameraUpdateTime)>=u.time&&(p=!0)),p){o(m),u.updating=!0;let b=new Us,f=u.href.clone();f.setQueryParameters(u.cookie);let x=g(i._ellipsoid,oe.WGS84);e4(f,i.camera,i.canvas,u.viewBoundScale,s.bbox,x),t4(i,b,f,{context:m.id}).then(Dnt(i,u,b,c,f)).catch(function(_){let C=`NetworkLink ${u.href} refresh failed: ${_}`;console.log(C),i._error.raiseEvent(i,C)}),d=!0}}c.set(u.id,u)}}),d&&(this._networkLinks=c,this._changed.raiseEvent(this)),!0};function Bnt(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}Md._DeferredLoading=Af;Md._getTimestamp=fi;var wv=Md;var bpi=T(S(),1);function Fv(){fe.throwInstantiationError()}Fv.prototype.update=fe.throwInstantiationError;Fv.prototype.getBoundingSphere=fe.throwInstantiationError;Fv.prototype.isDestroyed=fe.throwInstantiationError;Fv.prototype.destroy=fe.throwInstantiationError;var i4=Fv;var zpi=T(S(),1);var o4=32,Ynt=\"http://www.opengis.net/kml/2.2\",yh=\"http://www.google.com/kml/ext/2.2\",Ont=\"http://www.w3.org/2000/xmlns/\";function zU(e){this._files={},this._promises=[],this._count=0,this._modelCallback=e}var znt=/^data:image\\/([^,;]+)/;zU.prototype.texture=function(e){let t=this,n;if(typeof e==\"string\"||e instanceof Xe){if(e=Xe.createIfNeeded(e),!e.isDataUri)return e.url;let i=e.url.match(znt);n=`texture_${++this._count}`,l(i)&&(n+=`.${i[1]}`);let o=e.fetchBlob().then(function(r){t._files[n]=r});return this._promises.push(o),n}if(e instanceof HTMLCanvasElement){n=`texture_${++this._count}.png`;let i=new Promise(o=>{e.toBlob(function(r){t._files[n]=r,o()})});return this._promises.push(i),n}return\"\"};function Hnt(e,t){return function(n){e._files[t]=n}}zU.prototype.model=function(e,t){let n=this._modelCallback;if(!l(n))throw new ue(\"Encountered a model entity while exporting to KML, but no model callback was supplied.\");let i={},o=n(e,t,i);for(let r in i)if(i.hasOwnProperty(r)){let s=Promise.resolve(i[r]);this._promises.push(s),s.then(Hnt(this,r))}return o};Object.defineProperties(zU.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}});function HU(e){this._time=e}HU.prototype.get=function(e,t,n){let i;return l(e)&&(i=l(e.getValue)?e.getValue(this._time,n):e),g(i,t)};HU.prototype.getColor=function(e,t){let n=this.get(e,t);if(l(n))return hT(n)};HU.prototype.getMaterialType=function(e){if(l(e))return e.getType(this._time)};function r4(){this._ids={},this._styles={},this._count=0}r4.prototype.get=function(e){let t=this._ids,n=e.innerHTML;if(l(t[n]))return t[n];let i=`style-${++this._count}`;return e.setAttribute(\"id\",i),i=`#${i}`,t[n]=i,this._styles[n]=e,i};r4.prototype.save=function(e){let t=this._styles,n=e.childNodes[0];for(let i in t)t.hasOwnProperty(i)&&e.insertBefore(t[i],n)};function ebe(){this._ids={}}ebe.prototype.get=function(e){if(!l(e))return this.get(Bn());let t=this._ids;return l(t[e])?`${e.toString()}-${++t[e]}`:(t[e]=0,e)};function s4(e){e=g(e,g.EMPTY_OBJECT);let t=e.entities,n=g(e.kmz,!1),i=s4._createState(e),o=t.values.filter(function(d){return!l(d.parent)}),r=i.kmlDoc,s=r.documentElement;s.setAttributeNS(Ont,\"xmlns:gx\",yh);let a=r.createElement(\"Document\");s.appendChild(a),nbe(i,a,o),i.styleCache.save(a);let c=i.externalFileHandler;return c.promise.then(function(){let u=new XMLSerializer().serializeToString(i.kmlDoc);return n?Knt(u,c.files):{kml:u,externalFiles:c.files}})}function Knt(e,t){let n=on(\"ThirdParty/Workers/z-worker-pako.js\");dV({workerScripts:{deflate:[n,\"./pako_deflate.min.js\"],inflate:[n,\"./pako_inflate.min.js\"]}});let i=new Cv,o=new FU(i);return o.add(\"doc.kml\",new xU(e)).then(function(){let r=Object.keys(t);return tbe(o,r,t,0)}).then(function(){return o.close()}).then(function(r){return{kmz:r}})}function tbe(e,t,n,i){if(t.length===i)return;let o=t[i];return e.add(o,new O0(n[o])).then(function(){return tbe(e,t,n,i+1)})}s4._createState=function(e){let t=e.entities,n=new r4,i=t.computeAvailability(),o=l(e.time)?e.time:i.start,r=g(e.defaultAvailability,i),s=g(e.sampleDuration,60);r.start===Be.MINIMUM_VALUE?r.stop===Be.MAXIMUM_VALUE?r=new Sn:te.addSeconds(r.stop,-10*s,r.start):r.stop===Be.MAXIMUM_VALUE&&te.addSeconds(r.start,10*s,r.stop);let a=new zU(e.modelCallback);return{kmlDoc:document.implementation.createDocument(Ynt,\"kml\"),ellipsoid:g(e.ellipsoid,oe.WGS84),idManager:new ebe,styleCache:n,externalFileHandler:a,time:o,valueGetter:new HU(o),sampleDuration:s,defaultAvailability:new Wr([r])}};function nbe(e,t,n){let i=e.kmlDoc,o=e.styleCache,r=e.valueGetter,s=e.idManager,a=n.length,c,d,u;for(let m=0;m<a;++m){let p=n[m];c=[],d=[],u=[],Jnt(e,p,d,u),Qnt(e,p.polyline,d,u),$0e(e,p.rectangle,d,u,c),$0e(e,p.polygon,d,u,c),eit(e,p,p.model,d,u);let b,f=p.availability;l(f)&&(b=i.createElement(\"TimeSpan\"),te.equals(f.start,Be.MINIMUM_VALUE)||b.appendChild(fn(i,\"begin\",te.toIso8601(f.start))),te.equals(f.stop,Be.MAXIMUM_VALUE)||b.appendChild(fn(i,\"end\",te.toIso8601(f.stop))));for(let C=0;C<c.length;++C){let V=c[C];V.setAttribute(\"id\",s.get(p.id)),V.appendChild(fn(i,\"name\",p.name)),V.appendChild(fn(i,\"visibility\",p.show)),V.appendChild(fn(i,\"description\",p.description)),l(b)&&V.appendChild(b),t.appendChild(V)}let x=d.length;if(x>0){let C=i.createElement(\"Placemark\");C.setAttribute(\"id\",s.get(p.id));let V=p.name,L=p.label;if(l(L)){let G=i.createElement(\"LabelStyle\"),X=r.get(L.text);V=l(X)&&X.length>0?X:V;let v=r.getColor(L.fillColor);l(v)&&(G.appendChild(fn(i,\"color\",v)),G.appendChild(fn(i,\"colorMode\",\"normal\")));let W=r.get(L.scale);l(W)&&G.appendChild(fn(i,\"scale\",W)),u.push(G)}C.appendChild(fn(i,\"name\",V)),C.appendChild(fn(i,\"visibility\",p.show)),C.appendChild(fn(i,\"description\",p.description)),l(b)&&C.appendChild(b),t.appendChild(C);let R=u.length;if(R>0){let G=i.createElement(\"Style\");for(let X=0;X<R;++X)G.appendChild(u[X]);C.appendChild(fn(i,\"styleUrl\",o.get(G)))}if(d.length===1)C.appendChild(d[0]);else if(d.length>1){let G=i.createElement(\"MultiGeometry\");for(let X=0;X<x;++X)G.appendChild(d[X]);C.appendChild(G)}}let _=p._children;if(_.length>0){let C=i.createElement(\"Folder\");C.setAttribute(\"id\",s.get(p.id)),C.appendChild(fn(i,\"name\",p.name)),C.appendChild(fn(i,\"visibility\",p.show)),C.appendChild(fn(i,\"description\",p.description)),t.appendChild(C),nbe(e,C,_)}}}var zl=new h,tl=new he,bh=new te;function Jnt(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter,a=g(t.billboard,t.point);if(!l(a)&&!l(t.path))return;let c=t.position;if(!c.isConstant){ibe(e,t,a,n,i);return}s.get(c,void 0,zl);let d=fn(o,\"coordinates\",mT(zl,r)),u=o.createElement(\"Point\"),m=o.createElement(\"altitudeMode\");m.appendChild(fT(e,a.heightReference)),u.appendChild(m),u.appendChild(d),n.push(u);let p=a instanceof ec?rbe(e,a):obe(e,a);i.push(p)}function ibe(e,t,n,i,o){let r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter,c,d=t.position,u=!0;d instanceof aa?(c=d.intervals,u=!1):c=g(t.availability,e.defaultAvailability);let m=n instanceof Ep,p,b,f,x=[];for(p=0;p<c.length;++p){let C=c.get(p),V=u?d:C.data,L=r.createElement(\"altitudeMode\");V instanceof Lf?(V=V._value,L.appendChild(fT(e,Je.CLAMP_TO_GROUND))):l(n)?L.appendChild(fT(e,n.heightReference)):L.appendChild(fT(e,Je.NONE));let R=[],G=[];if(V.isConstant){a.get(V,void 0,zl);let v=fn(r,\"coordinates\",mT(zl,s));R.push(te.toIso8601(C.start)),G.push(v),R.push(te.toIso8601(C.stop)),G.push(v)}else if(V instanceof la)for(f=V._property._times,b=0;b<f.length;++b)R.push(te.toIso8601(f[b])),V.getValueInReferenceFrame(f[b],no.FIXED,zl),G.push(mT(zl,s));else if(V instanceof Zd){f=V._times;let v=V._values;for(b=0;b<f.length;++b)R.push(te.toIso8601(f[b])),h.fromArray(v,b*3,zl),G.push(mT(zl,s))}else{let v=e.sampleDuration;C.start.clone(bh),C.isStartIncluded||te.addSeconds(bh,v,bh);let W=C.stop;for(;te.lessThan(bh,W);)V.getValue(bh,zl),R.push(te.toIso8601(bh)),G.push(mT(zl,s)),te.addSeconds(bh,v,bh);C.isStopIncluded&&te.equals(bh,W)&&(V.getValue(bh,zl),R.push(te.toIso8601(bh)),G.push(mT(zl,s)))}let X=r.createElementNS(yh,\"Track\");X.appendChild(L);for(let v=0;v<R.length;++v){let W=fn(r,\"when\",R[v]),F=fn(r,\"coord\",G[v],yh);X.appendChild(W),X.appendChild(F)}m&&X.appendChild(sbe(e,n)),x.push(X)}if(x.length===1)i.push(x[0]);else if(x.length>1){let C=r.createElementNS(yh,\"MultiTrack\");for(p=0;p<x.length;++p)C.appendChild(x[p]);i.push(C)}if(l(n)&&!m){let C=n instanceof ec?rbe(e,n):obe(e,n);o.push(C)}let _=t.path;if(l(_)){let C=a.get(_.width),V=_.material;if(l(V)||l(C)){let L=r.createElement(\"LineStyle\");l(C)&&L.appendChild(fn(r,\"width\",C)),a4(e,V,L),o.push(L)}}}function obe(e,t){let n=e.kmlDoc,i=e.valueGetter,o=n.createElement(\"IconStyle\"),r=i.getColor(t.color);l(r)&&(o.appendChild(fn(n,\"color\",r)),o.appendChild(fn(n,\"colorMode\",\"normal\")));let s=i.get(t.pixelSize);return l(s)&&o.appendChild(fn(n,\"scale\",s/o4)),o}function rbe(e,t){let n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement(\"IconStyle\"),s=i.get(t.image);if(l(s)){s=o.texture(s);let p=n.createElement(\"Icon\");p.appendChild(fn(n,\"href\",s));let b=i.get(t.imageSubRegion);l(b)&&(p.appendChild(fn(n,\"x\",b.x,yh)),p.appendChild(fn(n,\"y\",b.y,yh)),p.appendChild(fn(n,\"w\",b.width,yh)),p.appendChild(fn(n,\"h\",b.height,yh))),r.appendChild(p)}let a=i.getColor(t.color);l(a)&&(r.appendChild(fn(n,\"color\",a)),r.appendChild(fn(n,\"colorMode\",\"normal\")));let c=i.get(t.scale);l(c)&&r.appendChild(fn(n,\"scale\",c));let d=i.get(t.pixelOffset);if(l(d)){c=g(c,1),D.divideByScalar(d,c,d);let p=i.get(t.width,o4),b=i.get(t.height,o4),f=i.get(t.horizontalOrigin,ui.CENTER);f===ui.CENTER?d.x-=p*.5:f===ui.RIGHT&&(d.x-=p);let x=i.get(t.verticalOrigin,Wn.CENTER);x===Wn.TOP?d.y+=b:x===Wn.CENTER&&(d.y+=b*.5);let _=n.createElement(\"hotSpot\");_.setAttribute(\"x\",-d.x),_.setAttribute(\"y\",d.y),_.setAttribute(\"xunits\",\"pixels\"),_.setAttribute(\"yunits\",\"pixels\"),r.appendChild(_)}let u=i.get(t.rotation),m=i.get(t.alignedAxis);return l(u)&&h.equals(h.UNIT_Z,m)&&(u=P.toDegrees(-u),u===0&&(u=360),r.appendChild(fn(n,\"heading\",u))),r}function Qnt(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=e.valueGetter;if(!l(t))return;let a=o.createElement(\"LineString\"),c=o.createElement(\"altitudeMode\"),d=s.get(t.clampToGround,!1),u;d?(a.appendChild(fn(o,\"tessellate\",!0)),u=o.createTextNode(\"clampToGround\")):u=o.createTextNode(\"absolute\"),c.appendChild(u),a.appendChild(c);let m=t.positions,p=s.get(m),b=fn(o,\"coordinates\",mT(p,r));a.appendChild(b);let f=s.get(t.zIndex);d&&l(f)&&a.appendChild(fn(o,\"drawOrder\",f,yh)),n.push(a);let x=o.createElement(\"LineStyle\"),_=s.get(t.width);l(_)&&x.appendChild(fn(o,\"width\",_)),a4(e,t.material,x),i.push(x)}function jnt(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=o.get(t.height,0);n>0&&(r=n);let s=t.coordinates,a=o.get(s),c=[],d=[le.northeast,le.southeast,le.southwest,le.northwest];for(let b=0;b<4;++b)d[b](a,tl),c.push(`${P.toDegrees(tl.longitude)},${P.toDegrees(tl.latitude)},${r}`);let u=fn(i,\"coordinates\",c.join(\" \")),m=i.createElement(\"outerBoundaryIs\"),p=i.createElement(\"LinearRing\");return p.appendChild(u),m.appendChild(p),[m]}function q0e(e,t,n,i){let o=e.kmlDoc,r=e.ellipsoid,s=[],a=t.length;for(let u=0;u<a;++u)he.fromCartesian(t[u],r,tl),s.push(`${P.toDegrees(tl.longitude)},${P.toDegrees(tl.latitude)},${i?tl.height:n}`);let c=fn(o,\"coordinates\",s.join(\" \")),d=o.createElement(\"LinearRing\");return d.appendChild(c),d}function qnt(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=o.get(t.height,0),s=o.get(t.perPositionHeight,!1);!s&&n>0&&(r=n);let a=[],c=t.hierarchy,d=o.get(c),u=Array.isArray(d)?d:d.positions,m=i.createElement(\"outerBoundaryIs\");m.appendChild(q0e(e,u,r,s)),a.push(m);let p=d.holes;if(l(p)){let b=p.length;for(let f=0;f<b;++f){let x=i.createElement(\"innerBoundaryIs\");x.appendChild(q0e(e,p[f].positions,r,s)),a.push(x)}}return a}function $0e(e,t,n,i,o){let r=e.kmlDoc,s=e.valueGetter;if(!l(t))return;let a=t instanceof Gm;if(a&&s.getMaterialType(t.material)===\"Image\"){$nt(e,t,o);return}let c=r.createElement(\"Polygon\"),d=s.get(t.extrudedHeight,0);d>0&&c.appendChild(fn(r,\"extrude\",!0));let u=a?jnt(e,t,d):qnt(e,t,d),m=u.length;for(let _=0;_<m;++_)c.appendChild(u[_]);let p=r.createElement(\"altitudeMode\");p.appendChild(fT(e,t.heightReference)),c.appendChild(p),n.push(c);let b=r.createElement(\"PolyStyle\"),f=s.get(t.fill,!1);f&&b.appendChild(fn(r,\"fill\",f)),a4(e,t.material,b);let x=s.get(t.outline,!1);if(x){b.appendChild(fn(r,\"outline\",x));let _=r.createElement(\"LineStyle\"),C=s.get(t.outlineWidth,1);_.appendChild(fn(r,\"width\",C));let V=s.getColor(t.outlineColor,O.BLACK);_.appendChild(fn(r,\"color\",V)),_.appendChild(fn(r,\"colorMode\",\"normal\")),i.push(_)}i.push(b)}function $nt(e,t,n){let i=e.kmlDoc,o=e.valueGetter,r=e.externalFileHandler,s=i.createElement(\"GroundOverlay\"),a=i.createElement(\"altitudeMode\");a.appendChild(fT(e,t.heightReference)),s.appendChild(a);let c=o.get(t.height);l(c)&&s.appendChild(fn(i,\"altitude\",c));let d=o.get(t.coordinates),u=i.createElement(\"LatLonBox\");u.appendChild(fn(i,\"north\",P.toDegrees(d.north))),u.appendChild(fn(i,\"south\",P.toDegrees(d.south))),u.appendChild(fn(i,\"east\",P.toDegrees(d.east))),u.appendChild(fn(i,\"west\",P.toDegrees(d.west))),s.appendChild(u);let m=o.get(t.material),p=r.texture(m.image),b=i.createElement(\"Icon\");b.appendChild(fn(i,\"href\",p)),s.appendChild(b);let f=m.color;l(f)&&s.appendChild(fn(i,\"color\",hT(m.color))),n.push(s)}function sbe(e,t){let n=e.kmlDoc,i=e.valueGetter,o=e.externalFileHandler,r=n.createElement(\"Model\"),s=i.get(t.scale);if(l(s)){let d=n.createElement(\"scale\");d.appendChild(fn(n,\"x\",s)),d.appendChild(fn(n,\"y\",s)),d.appendChild(fn(n,\"z\",s)),r.appendChild(d)}let a=n.createElement(\"Link\"),c=o.model(t,e.time);return a.appendChild(fn(n,\"href\",c)),r.appendChild(a),r}function eit(e,t,n,i,o){let r=e.kmlDoc,s=e.ellipsoid,a=e.valueGetter;if(!l(n))return;let c=t.position;if(!c.isConstant){ibe(e,t,n,i,o);return}let d=sbe(e,n),u=r.createElement(\"altitudeMode\");u.appendChild(fT(e,n.heightReference)),d.appendChild(u),a.get(c,void 0,zl),he.fromCartesian(zl,s,tl);let m=r.createElement(\"Location\");m.appendChild(fn(r,\"longitude\",P.toDegrees(tl.longitude))),m.appendChild(fn(r,\"latitude\",P.toDegrees(tl.latitude))),m.appendChild(fn(r,\"altitude\",tl.height)),d.appendChild(m),i.push(d)}function a4(e,t,n){let i=e.kmlDoc,o=e.valueGetter;if(!l(t))return;let r=o.get(t);if(!l(r))return;let s,a=o.getMaterialType(t),c,d;switch(a){case\"Image\":s=hT(O.WHITE);break;case\"Color\":case\"Grid\":case\"PolylineGlow\":case\"PolylineArrow\":case\"PolylineDash\":s=hT(r.color);break;case\"PolylineOutline\":s=hT(r.color),c=hT(r.outlineColor),d=r.outlineWidth,n.appendChild(fn(i,\"outerColor\",c,yh)),n.appendChild(fn(i,\"outerWidth\",d,yh));break;case\"Stripe\":s=hT(r.oddColor);break}l(s)&&(n.appendChild(fn(i,\"color\",s)),n.appendChild(fn(i,\"colorMode\",\"normal\")))}function fT(e,t){let n=e.kmlDoc,o=e.valueGetter.get(t,Je.NONE),r;switch(o){case Je.NONE:r=n.createTextNode(\"absolute\");break;case Je.CLAMP_TO_GROUND:r=n.createTextNode(\"clampToGround\");break;case Je.RELATIVE_TO_GROUND:r=n.createTextNode(\"relativeToGround\");break}return r}function mT(e,t){Array.isArray(e)||(e=[e]);let n=e.length,i=[];for(let o=0;o<n;++o)he.fromCartesian(e[o],t,tl),i.push(`${P.toDegrees(tl.longitude)},${P.toDegrees(tl.latitude)},${tl.height}`);return i.join(\" \")}function fn(e,t,n,i){n=g(n,\"\"),typeof n==\"boolean\"&&(n=n?\"1\":\"0\");let o=l(i)?e.createElementNS(i,t):e.createElement(t),r=n===\"string\"&&n.indexOf(\"<\")!==-1?e.createCDATASection(n):e.createTextNode(n);return o.appendChild(r),o}function hT(e){let t=\"\",n=e.toBytes();for(let i=3;i>=0;--i)t+=n[i]<16?`0${n[i].toString(16)}`:n[i].toString(16);return t}var c4=s4;var M3i=T(S(),1);var Jpi=T(S(),1);function tit(e){let t,n=e.name,i=e.message;l(n)&&l(i)?t=`${n}: ${i}`:t=e.toString();let o=e.stack;return l(o)&&(t+=` ${o}`),t}var Mf=tit;var NVi=T(S(),1);var mbi=T(S(),1);var ibi=T(S(),1);var jpi=T(S(),1),nit={NONE:0,LERC:1},Ku=Object.freeze(nit);var G0i=T(S(),1);var u0i=T(S(),1);var $pi=T(S(),1),iit={NONE:0,BITS12:1},Os=Object.freeze(iit);var pT=new h,oit=new h,Ju=new D,KU=new M,rit=new M,sit=Math.pow(2,12);function yc(e,t,n,i,o,r,s,a,c,d){let u=Os.NONE,m,p;if(l(t)&&l(n)&&l(i)&&l(o)){let b=t.minimum,f=t.maximum,x=h.subtract(f,b,oit),_=i-n;Math.max(h.maximumComponent(x),_)<sit-1?u=Os.BITS12:u=Os.NONE,m=M.inverseTransformation(o,new M);let V=h.negate(b,pT);M.multiply(M.fromTranslation(V,KU),m,m);let L=pT;L.x=1/x.x,L.y=1/x.y,L.z=1/x.z,M.multiply(M.fromScale(L,KU),m,m),p=M.clone(o),M.setTranslation(p,h.ZERO,p),o=M.clone(o,new M);let R=M.fromTranslation(b,KU),G=M.fromScale(x,rit),X=M.multiply(R,G,KU);M.multiply(o,X,o),M.multiply(p,X,p)}this.quantization=u,this.minimumHeight=n,this.maximumHeight=i,this.center=h.clone(e),this.toScaledENU=m,this.fromScaledENU=o,this.matrix=p,this.hasVertexNormals=r,this.hasWebMercatorT=g(s,!1),this.hasGeodeticSurfaceNormals=g(a,!1),this.exaggeration=g(c,1),this.exaggerationRelativeHeight=g(d,0),this.stride=0,this._offsetGeodeticSurfaceNormal=0,this._offsetVertexNormal=0,this._calculateStrideAndOffsets()}yc.prototype.encode=function(e,t,n,i,o,r,s,a){let c=i.x,d=i.y;if(this.quantization===Os.BITS12){n=M.multiplyByPoint(this.toScaledENU,n,pT),n.x=P.clamp(n.x,0,1),n.y=P.clamp(n.y,0,1),n.z=P.clamp(n.z,0,1);let u=this.maximumHeight-this.minimumHeight,m=P.clamp((o-this.minimumHeight)/u,0,1);D.fromElements(n.x,n.y,Ju);let p=wn.compressTextureCoordinates(Ju);D.fromElements(n.z,m,Ju);let b=wn.compressTextureCoordinates(Ju);D.fromElements(c,d,Ju);let f=wn.compressTextureCoordinates(Ju);if(e[t++]=p,e[t++]=b,e[t++]=f,this.hasWebMercatorT){D.fromElements(s,0,Ju);let x=wn.compressTextureCoordinates(Ju);e[t++]=x}}else h.subtract(n,this.center,pT),e[t++]=pT.x,e[t++]=pT.y,e[t++]=pT.z,e[t++]=o,e[t++]=c,e[t++]=d,this.hasWebMercatorT&&(e[t++]=s);return this.hasVertexNormals&&(e[t++]=wn.octPackFloat(r)),this.hasGeodeticSurfaceNormals&&(e[t++]=a.x,e[t++]=a.y,e[t++]=a.z),t};var ait=new h,abe=new h;yc.prototype.addGeodeticSurfaceNormals=function(e,t,n){if(this.hasGeodeticSurfaceNormals)return;let i=this.stride,o=e.length/i;this.hasGeodeticSurfaceNormals=!0,this._calculateStrideAndOffsets();let r=this.stride;for(let s=0;s<o;s++){for(let u=0;u<i;u++){let m=s*i+u,p=s*r+u;t[p]=e[m]}let a=this.decodePosition(t,s,ait),c=n.geodeticSurfaceNormal(a,abe),d=s*r+this._offsetGeodeticSurfaceNormal;t[d]=c.x,t[d+1]=c.y,t[d+2]=c.z}};yc.prototype.removeGeodeticSurfaceNormals=function(e,t){if(!this.hasGeodeticSurfaceNormals)return;let n=this.stride,i=e.length/n;this.hasGeodeticSurfaceNormals=!1,this._calculateStrideAndOffsets();let o=this.stride;for(let r=0;r<i;r++)for(let s=0;s<o;s++){let a=r*n+s,c=r*o+s;t[c]=e[a]}};yc.prototype.decodePosition=function(e,t,n){if(l(n)||(n=new h),t*=this.stride,this.quantization===Os.BITS12){let i=wn.decompressTextureCoordinates(e[t],Ju);n.x=i.x,n.y=i.y;let o=wn.decompressTextureCoordinates(e[t+1],Ju);return n.z=o.x,M.multiplyByPoint(this.fromScaledENU,n,n)}return n.x=e[t],n.y=e[t+1],n.z=e[t+2],h.add(n,this.center,n)};yc.prototype.getExaggeratedPosition=function(e,t,n){n=this.decodePosition(e,t,n);let i=this.exaggeration,o=this.exaggerationRelativeHeight;if(i!==1&&this.hasGeodeticSurfaceNormals){let s=this.decodeGeodeticSurfaceNormal(e,t,abe),a=this.decodeHeight(e,t),c=pr.getHeight(a,i,o)-a;n.x+=s.x*c,n.y+=s.y*c,n.z+=s.z*c}return n};yc.prototype.decodeTextureCoordinates=function(e,t,n){return l(n)||(n=new D),t*=this.stride,this.quantization===Os.BITS12?wn.decompressTextureCoordinates(e[t+2],n):D.fromElements(e[t+4],e[t+5],n)};yc.prototype.decodeHeight=function(e,t){return t*=this.stride,this.quantization===Os.BITS12?wn.decompressTextureCoordinates(e[t+1],Ju).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:e[t+3]};yc.prototype.decodeWebMercatorT=function(e,t){return t*=this.stride,this.quantization===Os.BITS12?wn.decompressTextureCoordinates(e[t+3],Ju).x:e[t+6]};yc.prototype.getOctEncodedNormal=function(e,t,n){t=t*this.stride+this._offsetVertexNormal;let i=e[t]/256,o=Math.floor(i),r=(i-o)*256;return D.fromElements(o,r,n)};yc.prototype.decodeGeodeticSurfaceNormal=function(e,t,n){return t=t*this.stride+this._offsetGeodeticSurfaceNormal,n.x=e[t],n.y=e[t+1],n.z=e[t+2],n};yc.prototype._calculateStrideAndOffsets=function(){let e=0;switch(this.quantization){case Os.BITS12:e+=3;break;default:e+=6}this.hasWebMercatorT&&(e+=1),this.hasVertexNormals&&(this._offsetVertexNormal=e,e+=1),this.hasGeodeticSurfaceNormals&&(this._offsetGeodeticSurfaceNormal=e,e+=3),this.stride=e};var JU={position3DAndHeight:0,textureCoordAndEncodedNormals:1,geodeticSurfaceNormal:2},QU={compressed0:0,compressed1:1,geodeticSurfaceNormal:2};yc.prototype.getAttributes=function(e){let t=Q.FLOAT,n=Q.getSizeInBytes(t),i=this.stride*n,o=0,r=[];function s(a,c){r.push({index:a,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:c,offsetInBytes:o,strideInBytes:i}),o+=c*n}if(this.quantization===Os.NONE){s(JU.position3DAndHeight,4);let a=2;a+=this.hasWebMercatorT?1:0,a+=this.hasVertexNormals?1:0,s(JU.textureCoordAndEncodedNormals,a),this.hasGeodeticSurfaceNormals&&s(JU.geodeticSurfaceNormal,3)}else{let a=this.hasWebMercatorT||this.hasVertexNormals,c=this.hasWebMercatorT&&this.hasVertexNormals;s(QU.compressed0,a?4:3),c&&s(QU.compressed1,1),this.hasGeodeticSurfaceNormals&&s(QU.geodeticSurfaceNormal,3)}return r};yc.prototype.getAttributeLocations=function(){return this.quantization===Os.NONE?JU:QU};yc.clone=function(e,t){if(l(e))return l(t)||(t=new yc),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=h.clone(e.center),t.toScaledENU=M.clone(e.toScaledENU),t.fromScaledENU=M.clone(e.fromScaledENU),t.matrix=M.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t.hasGeodeticSurfaceNormals=e.hasGeodeticSurfaceNormals,t.exaggeration=e.exaggeration,t.exaggerationRelativeHeight=e.exaggerationRelativeHeight,t._calculateStrideAndOffsets(),t};var gc=yc;var Nf={};Nf.DEFAULT_STRUCTURE=Object.freeze({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var l4=new h,cit=new M,lit=new h,dit=new h;Nf.computeVertices=function(e){let t=Math.cos,n=Math.sin,i=Math.sqrt,o=Math.atan,r=Math.exp,s=P.PI_OVER_TWO,a=P.toRadians,c=e.heightmap,d=e.width,u=e.height,m=e.skirtHeight,p=m>0,b=g(e.isGeographic,!0),f=g(e.ellipsoid,oe.WGS84),x=1/f.maximumRadius,_=le.clone(e.nativeRectangle),C=le.clone(e.rectangle),V,L,R,G;l(C)?(V=C.west,L=C.south,R=C.east,G=C.north):b?(V=a(_.west),L=a(_.south),R=a(_.east),G=a(_.north)):(V=_.west*x,L=s-2*o(r(-_.south*x)),R=_.east*x,G=s-2*o(r(-_.north*x)));let X=e.relativeToCenter,v=l(X);X=v?X:h.ZERO;let W=g(e.includeWebMercatorT,!1),F=g(e.exaggeration,1),A=g(e.exaggerationRelativeHeight,0),Z=F!==1,E=g(e.structure,Nf.DEFAULT_STRUCTURE),I=g(E.heightScale,Nf.DEFAULT_STRUCTURE.heightScale),w=g(E.heightOffset,Nf.DEFAULT_STRUCTURE.heightOffset),k=g(E.elementsPerHeight,Nf.DEFAULT_STRUCTURE.elementsPerHeight),B=g(E.stride,Nf.DEFAULT_STRUCTURE.stride),U=g(E.elementMultiplier,Nf.DEFAULT_STRUCTURE.elementMultiplier),Y=g(E.isBigEndian,Nf.DEFAULT_STRUCTURE.isBigEndian),N=le.computeWidth(_),J=le.computeHeight(_),z=N/(d-1),ee=J/(u-1);b||(N*=x,J*=x);let H=f.radiiSquared,j=H.x,q=H.y,pe=H.z,_e=65536,ae=-65536,ye=Wt.eastNorthUpToFixedFrame(X,f),Te=M.inverseTransformation(ye,cit),Le,Re;W&&(Le=Li.geodeticLatitudeToMercatorAngle(L),Re=1/(Li.geodeticLatitudeToMercatorAngle(G)-Le));let ke=lit;ke.x=Number.POSITIVE_INFINITY,ke.y=Number.POSITIVE_INFINITY,ke.z=Number.POSITIVE_INFINITY;let rt=dit;rt.x=Number.NEGATIVE_INFINITY,rt.y=Number.NEGATIVE_INFINITY,rt.z=Number.NEGATIVE_INFINITY;let yt=Number.POSITIVE_INFINITY,Dt=d*u,it=m>0?d*2+u*2:0,Ie=Dt+it,ft=new Array(Ie),Ke=new Array(Ie),ct=new Array(Ie),Jt=W?new Array(Ie):[],be=Z?new Array(Ie):[],Ve=0,Bt=u,mt=0,Pi=d;p&&(--Ve,++Bt,--mt,++Pi);let Co=1e-5;for(let Ye=Ve;Ye<Bt;++Ye){let gt=Ye;gt<0&&(gt=0),gt>=u&&(gt=u-1);let zt=_.north-ee*gt;b?zt=a(zt):zt=s-2*o(r(-zt*x));let Gn=(zt-L)/(G-L);Gn=P.clamp(Gn,0,1);let Vo=Ye===Ve,tr=Ye===Bt-1;m>0&&(Vo?zt+=Co*J:tr&&(zt-=Co*J));let Da=t(zt),nr=n(zt),ir=pe*nr,zi;W&&(zi=(Li.geodeticLatitudeToMercatorAngle(zt)-Le)*Re);for(let ds=mt;ds<Pi;++ds){let es=ds;es<0&&(es=0),es>=d&&(es=d-1);let dl=gt*(d*B)+es*B,Uo;if(k===1)Uo=c[dl];else{Uo=0;let Xc;if(Y)for(Xc=0;Xc<k;++Xc)Uo=Uo*U+c[dl+Xc];else for(Xc=k-1;Xc>=0;--Xc)Uo=Uo*U+c[dl+Xc]}Uo=Uo*I+w,ae=Math.max(ae,Uo),_e=Math.min(_e,Uo);let ur=_.west+z*es;b?ur=a(ur):ur=ur*x;let Ec=(ur-V)/(R-V);Ec=P.clamp(Ec,0,1);let ul=gt*d+es;if(m>0){let Xc=ds===mt,Ah=ds===Pi-1,fM=Vo||tr||Xc||Ah;if((Vo||tr)&&(Xc||Ah))continue;fM&&(Uo-=m,Xc?(ul=Dt+(u-gt-1),ur-=Co*N):tr?ul=Dt+u+(d-es-1):Ah?(ul=Dt+u+d+gt,ur+=Co*N):Vo&&(ul=Dt+u+d+u+es))}let vi=Da*t(ur),ga=Da*n(ur),Tr=j*vi,kr=q*ga,xa=1/i(Tr*vi+kr*ga+ir*nr),yb=Tr*xa,_a=kr*xa,um=ir*xa,mm=new h;mm.x=yb+vi*Uo,mm.y=_a+ga*Uo,mm.z=um+nr*Uo,M.multiplyByPoint(Te,mm,l4),h.minimumByComponent(l4,ke,ke),h.maximumByComponent(l4,rt,rt),yt=Math.min(yt,Uo),ft[ul]=mm,ct[ul]=new D(Ec,Gn),Ke[ul]=Uo,W&&(Jt[ul]=zi),Z&&(be[ul]=f.geodeticSurfaceNormal(mm))}}let Es=ce.fromPoints(ft),$r;l(C)&&($r=Zn.fromRectangle(C,_e,ae,f));let Nr;v&&(Nr=new L0(f).computeHorizonCullingPointPossiblyUnderEllipsoid(X,ft,_e));let Qs=new vb(ke,rt,X),De=new gc(X,Qs,yt,ae,ye,!1,W,Z,F,A),et=new Float32Array(Ie*De.stride),qe=0;for(let Ye=0;Ye<Ie;++Ye)qe=De.encode(et,qe,ft[Ye],ct[Ye],Ke[Ye],void 0,Jt[Ye],be[Ye]);return{vertices:et,maximumHeight:ae,minimumHeight:_e,encoding:De,boundingSphere3D:Es,orientedBoundingBox:$r,occludeePointInScaledSpace:Nr}};var xV=Nf;var I0i=T(S(),1);function ug(){fe.throwInstantiationError()}Object.defineProperties(ug.prototype,{credits:{get:fe.throwInstantiationError},waterMask:{get:fe.throwInstantiationError}});ug.prototype.interpolateHeight=fe.throwInstantiationError;ug.prototype.isChildAvailable=fe.throwInstantiationError;ug.prototype.createMesh=fe.throwInstantiationError;ug.prototype.upsample=fe.throwInstantiationError;ug.prototype.wasCreatedByUpsampling=fe.throwInstantiationError;ug.maximumAsynchronousTasks=5;var gh=ug;var v0i=T(S(),1);function uit(e,t,n,i,o,r,s,a,c,d,u,m,p,b,f,x){this.center=e,this.vertices=t,this.stride=g(d,6),this.indices=n,this.indexCountWithoutSkirts=i,this.vertexCountWithoutSkirts=o,this.minimumHeight=r,this.maximumHeight=s,this.boundingSphere3D=a,this.occludeePointInScaledSpace=c,this.orientedBoundingBox=u,this.encoding=m,this.westIndicesSouthToNorth=p,this.southIndicesEastToWest=b,this.eastIndicesNorthToSouth=f,this.northIndicesWestToEast=x}var Qu=uit;var k0i=T(S(),1);function nl(){fe.throwInstantiationError()}Object.defineProperties(nl.prototype,{errorEvent:{get:fe.throwInstantiationError},credit:{get:fe.throwInstantiationError},tilingScheme:{get:fe.throwInstantiationError},hasWaterMask:{get:fe.throwInstantiationError},hasVertexNormals:{get:fe.throwInstantiationError},availability:{get:fe.throwInstantiationError}});var cbe=[];nl.getRegularGridIndices=function(e,t){let n=cbe[e];l(n)||(cbe[e]=n=[]);let i=n[t];return l(i)||(e*t<P.SIXTY_FOUR_KILOBYTES?i=n[t]=new Uint16Array((e-1)*(t-1)*6):i=n[t]=new Uint32Array((e-1)*(t-1)*6),mbe(e,t,i,0)),i};var lbe=[];nl.getRegularGridIndicesAndEdgeIndices=function(e,t){let n=lbe[e];l(n)||(lbe[e]=n=[]);let i=n[t];if(!l(i)){let o=nl.getRegularGridIndices(e,t),r=ube(e,t),s=r.westIndicesSouthToNorth,a=r.southIndicesEastToWest,c=r.eastIndicesNorthToSouth,d=r.northIndicesWestToEast;i=n[t]={indices:o,westIndicesSouthToNorth:s,southIndicesEastToWest:a,eastIndicesNorthToSouth:c,northIndicesWestToEast:d}}return i};var dbe=[];nl.getRegularGridAndSkirtIndicesAndEdgeIndices=function(e,t){let n=dbe[e];l(n)||(dbe[e]=n=[]);let i=n[t];if(!l(i)){let o=e*t,r=(e-1)*(t-1)*6,s=e*2+t*2,a=Math.max(0,s-4)*6,c=o+s,d=r+a,u=ube(e,t),m=u.westIndicesSouthToNorth,p=u.southIndicesEastToWest,b=u.eastIndicesNorthToSouth,f=u.northIndicesWestToEast,x=Ae.createTypedArray(c,d);mbe(e,t,x,0),nl.addSkirtIndices(m,p,b,f,o,x,r),i=n[t]={indices:x,westIndicesSouthToNorth:m,southIndicesEastToWest:p,eastIndicesNorthToSouth:b,northIndicesWestToEast:f,indexCountWithoutSkirts:r}}return i};nl.addSkirtIndices=function(e,t,n,i,o,r,s){let a=o;s=jU(e,a,r,s),a+=e.length,s=jU(t,a,r,s),a+=t.length,s=jU(n,a,r,s),a+=n.length,jU(i,a,r,s)};function ube(e,t){let n=new Array(t),i=new Array(e),o=new Array(t),r=new Array(e),s;for(s=0;s<e;++s)r[s]=s,i[s]=e*t-1-s;for(s=0;s<t;++s)o[s]=(s+1)*e-1,n[s]=(t-s-1)*e;return{westIndicesSouthToNorth:n,southIndicesEastToWest:i,eastIndicesNorthToSouth:o,northIndicesWestToEast:r}}function mbe(e,t,n,i){let o=0;for(let r=0;r<t-1;++r){for(let s=0;s<e-1;++s){let a=o,c=a+e,d=c+1,u=a+1;n[i++]=a,n[i++]=c,n[i++]=u,n[i++]=u,n[i++]=c,n[i++]=d,++o}++o}}function jU(e,t,n,i){let o=e[0],r=e.length;for(let s=1;s<r;++s){let a=e[s];n[i++]=o,n[i++]=a,n[i++]=t,n[i++]=t,n[i++]=a,n[i++]=t+1,o=a,++t}return i}nl.heightmapTerrainQuality=.25;nl.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,n){return e.maximumRadius*2*Math.PI*nl.heightmapTerrainQuality/(t*n)};nl.prototype.requestTileGeometry=fe.throwInstantiationError;nl.prototype.getLevelMaximumGeometricError=fe.throwInstantiationError;nl.prototype.getTileDataAvailable=fe.throwInstantiationError;nl.prototype.loadTileDataAvailability=fe.throwInstantiationError;var Jr=nl;function z0(e){this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=g(e.childTileMask,15),this._encoding=g(e.encoding,Ku.NONE);let t=xV.DEFAULT_STRUCTURE,n=e.structure;l(n)?n!==t&&(n.heightScale=g(n.heightScale,t.heightScale),n.heightOffset=g(n.heightOffset,t.heightOffset),n.elementsPerHeight=g(n.elementsPerHeight,t.elementsPerHeight),n.stride=g(n.stride,t.stride),n.elementMultiplier=g(n.elementMultiplier,t.elementMultiplier),n.isBigEndian=g(n.isBigEndian,t.isBigEndian)):n=t,this._structure=n,this._createdByUpsampling=g(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._encoding===Ku.LERC?Float32Array:this._buffer.constructor,this._mesh=void 0}Object.defineProperties(z0.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}}});var hbe=\"createVerticesFromHeightmap\",mit=new di(hbe),hit=new di(hbe,gh.maximumAsynchronousTasks);z0.prototype.createMesh=function(e){e=g(e,g.EMPTY_OBJECT);let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=g(e.exaggeration,1),s=g(e.exaggerationRelativeHeight,0),a=g(e.throttle,!0),c=t.ellipsoid,d=t.tileXYToNativeRectangle(n,i,o),u=t.tileXYToRectangle(n,i,o),m=c.cartographicToCartesian(le.center(u)),p=this._structure,f=Jr.getEstimatedLevelZeroGeometricErrorForAHeightmap(c,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<o);this._skirtHeight=Math.min(f*4,1e3);let _=(a?hit:mit).scheduleTask({heightmap:this._buffer,structure:p,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:d,rectangle:u,relativeToCenter:m,ellipsoid:c,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Ci,exaggeration:r,exaggerationRelativeHeight:s,encoding:this._encoding});if(!l(_))return;let C=this;return Promise.resolve(_).then(function(V){let L;C._skirtHeight>0?L=Jr.getRegularGridAndSkirtIndicesAndEdgeIndices(V.gridWidth,V.gridHeight):L=Jr.getRegularGridIndicesAndEdgeIndices(V.gridWidth,V.gridHeight);let R=V.gridWidth*V.gridHeight;return C._mesh=new Qu(m,new Float32Array(V.vertices),L.indices,L.indexCountWithoutSkirts,R,V.minimumHeight,V.maximumHeight,ce.clone(V.boundingSphere3D),h.clone(V.occludeePointInScaledSpace),V.numberOfAttributes,Zn.clone(V.orientedBoundingBox),gc.clone(V.encoding),L.westIndicesSouthToNorth,L.southIndicesEastToWest,L.eastIndicesNorthToSouth,L.northIndicesWestToEast),C._buffer=void 0,C._mesh})};z0.prototype._createMeshSync=function(e){let t=e.tilingScheme,n=e.x,i=e.y,o=e.level,r=g(e.exaggeration,1),s=g(e.exaggerationRelativeHeight,0),a=t.ellipsoid,c=t.tileXYToNativeRectangle(n,i,o),d=t.tileXYToRectangle(n,i,o),u=a.cartographicToCartesian(le.center(d)),m=this._structure,b=Jr.getEstimatedLevelZeroGeometricErrorForAHeightmap(a,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<o);this._skirtHeight=Math.min(b*4,1e3);let f=xV.computeVertices({heightmap:this._buffer,structure:m,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:c,rectangle:d,relativeToCenter:u,ellipsoid:a,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Ci,exaggeration:r,exaggerationRelativeHeight:s});this._buffer=void 0;let x;this._skirtHeight>0?x=Jr.getRegularGridAndSkirtIndicesAndEdgeIndices(this._width,this._height):x=Jr.getRegularGridIndicesAndEdgeIndices(this._width,this._height);let _=f.gridWidth*f.gridHeight;return this._mesh=new Qu(u,f.vertices,x.indices,x.indexCountWithoutSkirts,_,f.minimumHeight,f.maximumHeight,f.boundingSphere3D,f.occludeePointInScaledSpace,f.encoding.stride,f.orientedBoundingBox,f.encoding,x.westIndicesSouthToNorth,x.southIndicesEastToWest,x.eastIndicesNorthToSouth,x.northIndicesWestToEast),this._mesh};z0.prototype.interpolateHeight=function(e,t,n){let i=this._width,o=this._height,r=this._structure,s=r.stride,a=r.elementsPerHeight,c=r.elementMultiplier,d=r.isBigEndian,u=r.heightOffset,m=r.heightScale,p=l(this._mesh),b=this._encoding===Ku.LERC;if(!p&&b)return;let x;if(p){let _=this._mesh.vertices,C=this._mesh.encoding;x=fbe(_,C,u,m,e,i,o,t,n)}else x=fit(this._buffer,a,c,s,d,e,i,o,t,n),x=x*m+u;return x};z0.prototype.upsample=function(e,t,n,i,o,r,s){let a=this._mesh;if(!l(a))return;let c=this._width,d=this._height,u=this._structure,m=u.stride,p=new this._bufferType(c*d*m),b=a.vertices,f=a.encoding,x=e.tileXYToRectangle(t,n,i),_=e.tileXYToRectangle(o,r,s),C=u.heightOffset,V=u.heightScale,L=u.elementsPerHeight,R=u.elementMultiplier,G=u.isBigEndian,X=Math.pow(R,L-1);for(let v=0;v<d;++v){let W=P.lerp(_.north,_.south,v/(d-1));for(let F=0;F<c;++F){let A=P.lerp(_.west,_.east,F/(c-1)),y=fbe(b,f,C,V,x,c,d,A,W);y=y<u.lowestEncodedHeight?u.lowestEncodedHeight:y,y=y>u.highestEncodedHeight?u.highestEncodedHeight:y,pit(p,L,R,X,m,G,v*c+F,y)}}return Promise.resolve(new z0({buffer:p,width:c,height:d,childTileMask:0,structure:this._structure,createdByUpsampling:!0}))};z0.prototype.isChildAvailable=function(e,t,n,i){let o=2;return n!==e*2&&++o,i!==t*2&&(o-=2),(this._childTileMask&1<<o)!==0};z0.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};function fit(e,t,n,i,o,r,s,a,c,d){let u=(c-r.west)*(s-1)/(r.east-r.west),m=(d-r.south)*(a-1)/(r.north-r.south),p=u|0,b=p+1;b>=s&&(b=s-1,p=s-2);let f=m|0,x=f+1;x>=a&&(x=a-1,f=a-2);let _=u-p,C=m-f;f=a-1-f,x=a-1-x;let V=qU(e,t,n,i,o,f*s+p),L=qU(e,t,n,i,o,f*s+b),R=qU(e,t,n,i,o,x*s+p),G=qU(e,t,n,i,o,x*s+b);return pbe(_,C,V,L,R,G)}function fbe(e,t,n,i,o,r,s,a,c){let d=(a-o.west)*(r-1)/(o.east-o.west),u=(c-o.south)*(s-1)/(o.north-o.south),m=d|0,p=m+1;p>=r&&(p=r-1,m=r-2);let b=u|0,f=b+1;f>=s&&(f=s-1,b=s-2);let x=d-m,_=u-b;b=s-1-b,f=s-1-f;let C=(t.decodeHeight(e,b*r+m)-n)/i,V=(t.decodeHeight(e,b*r+p)-n)/i,L=(t.decodeHeight(e,f*r+m)-n)/i,R=(t.decodeHeight(e,f*r+p)-n)/i;return pbe(x,_,C,V,L,R)}function pbe(e,t,n,i,o,r){return t<e?n+e*(i-n)+t*(r-i):n+e*(r-o)+t*(o-n)}function qU(e,t,n,i,o,r){r*=i;let s=0,a;if(o)for(a=0;a<t;++a)s=s*n+e[r+a];else for(a=t-1;a>=0;--a)s=s*n+e[r+a];return s}function pit(e,t,n,i,o,r,s,a){s*=o;let c;if(r)for(c=0;c<t-1;++c)e[s+c]=a/i|0,a-=e[s+c]*i,i/=n;else for(c=t-1;c>0;--c)e[s+c]=a/i|0,a-=e[s+c]*i,i/=n;e[s+c]=a}var Fa=z0;function _V(e){e=g(e,g.EMPTY_OBJECT),this._tilingScheme=e.tilingScheme,l(this._tilingScheme)||(this._tilingScheme=new Ui({ellipsoid:g(e.ellipsoid,oe.WGS84)})),this._levelZeroMaximumGeometricError=Jr.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new ge}Object.defineProperties(_V.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});_V.prototype.requestTileGeometry=function(e,t,n,i){return Promise.resolve(new Fa({buffer:new Uint8Array(16*16),width:16,height:16}))};_V.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};_V.prototype.getTileDataAvailable=function(e,t,n){};_V.prototype.loadTileDataAvailability=function(e,t,n){};var kf=_V;var fbi=T(S(),1),Av=`uniform vec4 u_initialColor; #if TEXTURE_UNITS > 0 uniform sampler2D u_dayTextures[TEXTURE_UNITS]; uniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS]; uniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS]; #ifdef APPLY_ALPHA uniform float u_dayTextureAlpha[TEXTURE_UNITS]; #endif #ifdef APPLY_DAY_NIGHT_ALPHA uniform float u_dayTextureNightAlpha[TEXTURE_UNITS]; uniform float u_dayTextureDayAlpha[TEXTURE_UNITS]; #endif #ifdef APPLY_SPLIT uniform float u_dayTextureSplit[TEXTURE_UNITS]; #endif #ifdef APPLY_BRIGHTNESS uniform float u_dayTextureBrightness[TEXTURE_UNITS]; #endif #ifdef APPLY_CONTRAST"
}
{
  "metadata": {
    "source_file": "Cesium-1.116.0-fix-26\\Cesium.js",
    "chunk_index": 106,
    "total_chunks": 194,
    "chunk_size": 43187,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:49.710Z"
  },
  "content": "> 0.0) { // Add padding for anti-aliasing on both sides. totalSize += 3.0; } // Clamp to max point size. totalSize = min(totalSize, u_maxTotalPointSize); // If size is too small, push vertex behind near plane for clipping. // Note that context.minimumAliasedPointSize \"will be at most 1.0\". if (totalSize < 1.0) { positionEC.xyz = vec3(0.0); totalSize = 1.0; } float translucency = 1.0; #ifdef EYE_DISTANCE_TRANSLUCENCY translucency = czm_nearFarScalar(translucencyByDistance, lengthSq); // push vertex behind near plane for clipping if (translucency < 0.004) { positionEC.xyz = vec3(0.0); } #endif #ifdef DISTANCE_DISPLAY_CONDITION float nearSq = distanceDisplayConditionAndDisableDepth.x; float farSq = distanceDisplayConditionAndDisableDepth.y; if (lengthSq < nearSq || lengthSq > farSq) { // push vertex behind camera to force it to be clipped positionEC.xyz = vec3(0.0, 0.0, 1.0); } #endif gl_Position = czm_projection * positionEC; czm_vertexLogDepth(); #ifdef DISABLE_DEPTH_DISTANCE float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z; if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0) { disableDepthTestDistance = czm_minimumDisableDepthTestDistance; } if (disableDepthTestDistance != 0.0) { // Don't try to \"multiply both sides\" by w. Greater/less-than comparisons won't work for negative values of w. float zclip = gl_Position.z / gl_Position.w; bool clipped = (zclip < -1.0 || zclip > 1.0); if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance))) { // Position z on the near plane. gl_Position.z = -gl_Position.w; #ifdef LOG_DEPTH czm_vertexLogDepth(vec4(czm_currentFrustum.x)); #endif } } #endif v_color = color; v_color.a *= translucency * show; v_outlineColor = outlineColor; v_outlineColor.a *= translucency * show; #ifdef DEPTH_FAIL_TRANSLUCENCY v_color.a *= depthFailTranslucency; #endif v_innerPercent = 1.0 - outlinePercent; v_pixelDistance = 2.0 / totalSize; gl_PointSize = totalSize * show; gl_Position *= show; v_pickColor = pickColor; } `;var r4e=_s.SHOW_INDEX,xK=_s.POSITION_INDEX,Xde=_s.COLOR_INDEX,s4e=_s.OUTLINE_COLOR_INDEX,a4e=_s.OUTLINE_WIDTH_INDEX,c4e=_s.PIXEL_SIZE_INDEX,Ide=_s.SCALE_BY_DISTANCE_INDEX,Wde=_s.TRANSLUCENCY_BY_DISTANCE_INDEX,Pde=_s.DISTANCE_DISPLAY_CONDITION_INDEX,l4e=_s.DISABLE_DEPTH_DISTANCE_INDEX,_K=_s.NUMBER_OF_PROPERTIES,d4e=_s.DEPTH_FAIL_TRANSLUCENCY,Hr={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5,depthFailTranslucency:6};function Fu(e){e=g(e,g.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._spDepthFail=void 0,this._spTranslucentDepthFail=void 0,this._rsDepthFail=Ne.fromCache({depthTest:{enabled:!0,func:ne.GREATER},blending:un.ALPHA_BLEND}),this._allDepthFailTranslucencyNoValue=!0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(_K),this._maxPixelSize=1,this._baseVolume=new ce,this._baseVolumeWC=new ce,this._baseVolume2D=new ce,this._boundingVolume=new ce,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=g(e.show,!0),this.modelMatrix=M.clone(g(e.modelMatrix,M.IDENTITY)),this._modelMatrix=M.clone(M.IDENTITY),this.debugShowBoundingVolume=g(e.debugShowBoundingVolume,!1),this.blendOption=g(e.blendOption,Bi.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ie.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW,Me.STATIC_DRAW];let t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}Object.defineProperties(Fu.prototype,{length:{get:function(){return TK(this),this._pointPrimitives.length}}});function vde(e){let t=e.length;for(let n=0;n<t;++n)e[n]&&e[n]._destroy()}Fu.prototype.add=function(e){let t=new _s(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t};Fu.prototype.remove=function(e){return this.contains(e)?(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0):!1};Fu.prototype.removeAll=function(){vde(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0};function TK(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;let t=[],n=e._pointPrimitives,i=n.length;for(let o=0,r=0;o<i;++o){let s=n[o];s&&(s._index=r++,t.push(s))}e._pointPrimitives=t}}Fu.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]};Fu.prototype.contains=function(e){return l(e)&&e._pointPrimitiveCollection===this};Fu.prototype.get=function(e){return TK(this),this._pointPrimitives[e]};Fu.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,n=this._propertiesChanged;for(let i=0;i<_K;++i){let o=n[i]===0?Me.STATIC_DRAW:Me.STREAM_DRAW;t=t||e[i]!==o,e[i]=o}return t};function u4e(e,t,n){return new xp(e,[{index:Hr.positionHighAndSize,componentsPerAttribute:4,componentDatatype:Q.FLOAT,usage:n[xK]},{index:Hr.positionLowAndShow,componentsPerAttribute:4,componentDatatype:Q.FLOAT,usage:n[xK]},{index:Hr.compressedAttribute0,componentsPerAttribute:4,componentDatatype:Q.FLOAT,usage:n[Xde]},{index:Hr.compressedAttribute1,componentsPerAttribute:4,componentDatatype:Q.FLOAT,usage:n[Wde]},{index:Hr.scaleByDistance,componentsPerAttribute:4,componentDatatype:Q.FLOAT,usage:n[Ide]},{index:Hr.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:Q.FLOAT,usage:n[Pde]},{index:Hr.depthFailTranslucency,componentsPerAttribute:1,componentDatatype:Q.FLOAT,usage:Me.STATIC_DRAW}],t)}var yK=new Yn;function wde(e,t,n,i){let o=i._index,r=i._getActualPosition();e._mode===ie.SCENE3D&&(ce.expand(e._baseVolume,r,e._baseVolume),e._boundingVolumeDirty=!0),Yn.fromCartesian(r,yK);let s=i.pixelSize,a=i.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,s+a);let c=n[Hr.positionHighAndSize],d=yK.high;c(o,d.x,d.y,d.z,s);let u=n[Hr.positionLowAndOutline],m=yK.low;u(o,m.x,m.y,m.z,a)}var ik=65536,q2=256;function Fde(e,t,n,i){let o=i._index,r=i.color,s=i.getPickId(t).color,a=i.outlineColor,c=O.floatToByte(r.red),d=O.floatToByte(r.green),u=O.floatToByte(r.blue),m=c*ik+d*q2+u;c=O.floatToByte(a.red),d=O.floatToByte(a.green),u=O.floatToByte(a.blue);let p=c*ik+d*q2+u;c=O.floatToByte(s.red),d=O.floatToByte(s.green),u=O.floatToByte(s.blue);let b=c*ik+d*q2+u,f=O.floatToByte(r.alpha)*ik+O.floatToByte(a.alpha)*q2+O.floatToByte(s.alpha),x=n[Hr.compressedAttribute0];x(o,m,p,b,f)}function Ade(e,t,n,i){let o=i._index,r=0,s=1,a=1,c=1,d=i.translucencyByDistance;l(d)&&(r=d.near,s=d.nearValue,a=d.far,c=d.farValue,(s!==1||c!==1)&&(e._shaderTranslucencyByDistance=!0));let u=i.show&&i.clusterShow;i.color.alpha===0&&i.outlineColor.alpha===0&&(u=!1),s=P.clamp(s,0,1),s=s===1?255:s*255|0;let m=(u?1:0)*q2+s;c=P.clamp(c,0,1),c=c===1?255:c*255|0;let p=c,b=n[Hr.compressedAttribute1];b(o,m,p,r,a)}function Mde(e,t,n,i){let o=i._index,r=n[Hr.scaleByDistance],s=0,a=1,c=1,d=1,u=i.scaleByDistance;l(u)&&(s=u.near,a=u.nearValue,c=u.far,d=u.farValue,(a!==1||d!==1)&&(e._shaderScaleByDistance=!0)),r(o,s,a,c,d)}function Nde(e,t,n,i){let o=i._index,r=n[Hr.distanceDisplayConditionAndDisableDepth],s=0,a=Number.MAX_VALUE,c=i.distanceDisplayCondition;l(c)&&(s=c.near,a=c.far,s*=s,a*=a,e._shaderDistanceDisplayCondition=!0);let d=i.disableDepthTestDistance;d*=d,d>0&&(e._shaderDisableDepthDistance=!0,d===Number.POSITIVE_INFINITY&&(d=-1)),r(o,s,a,d)}function kde(e,t,n,i){let o=i._index,r=n[Hr.depthFailTranslucency];e._allDepthFailTranslucencyNoValue=e._allDepthFailTranslucencyNoValue&&i.depthFailTranslucency===void 0;let s=1;e._allDepthFailTranslucencyNoValue||(i.depthFailTranslucency===void 0?s=0:s=i.depthFailTranslucency),r(o,s)}function m4e(e,t,n,i){wde(e,t,n,i),Fde(e,t,n,i),Ade(e,t,n,i),Mde(e,t,n,i),Nde(e,t,n,i),kde(e,t,n,i)}function gK(e,t,n,i,o,r){let s;i.mode===ie.SCENE3D?(s=e._baseVolume,e._boundingVolumeDirty=!0):s=e._baseVolume2D;let a=[];for(let c=0;c<n;++c){let d=t[c],u=d.position,m=_s._computeActualPosition(u,i,o);l(m)&&(d._setActualPosition(m),r?a.push(m):ce.expand(s,m,s))}r&&ce.fromPoints(a,s)}function h4e(e,t){let n=t.mode,i=e._pointPrimitives,o=e._pointPrimitivesToUpdate,r=e._modelMatrix;e._createVertexArray||e._mode!==n||n!==ie.SCENE3D&&!M.equals(r,e.modelMatrix)?(e._mode=n,M.clone(e.modelMatrix,r),e._createVertexArray=!0,(n===ie.SCENE3D||n===ie.SCENE2D||n===ie.COLUMBUS_VIEW)&&gK(e,i,i.length,t,r,!0)):n===ie.MORPHING?gK(e,i,i.length,t,r,!0):(n===ie.SCENE2D||n===ie.COLUMBUS_VIEW)&&gK(e,o,e._pointPrimitivesToUpdateIndex,t,r,!1)}function f4e(e,t,n){let o=t.camera.getPixelSize(n,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;n.radius+=o}var p4e=[];Fu.prototype.update=function(e){if(TK(this),!this.show)return;this._maxTotalPointSize=Yt.maximumAliasedPointSize,h4e(this,e);let n=this._pointPrimitives.length,i=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,r=this._propertiesChanged,s=this._createVertexArray,a,c=e.context,d=e.passes,u=d.pick;if(s||!u&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let G=0;G<_K;++G)r[G]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),n>0){this._vaf=u4e(c,n,this._buffersUsage),a=this._vaf.writers,this._allDepthFailTranslucencyNoValue=!0;for(let G=0;G<n;++G){let X=this._pointPrimitives[G];X._dirty=!1,m4e(this,c,a,X)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){let G=p4e;G.length=0,(r[xK]||r[a4e]||r[c4e])&&G.push(wde),(r[Xde]||r[s4e])&&G.push(Fde),(r[r4e]||r[Wde])&&G.push(Ade),r[Ide]&&G.push(Mde),(r[Pde]||r[l4e])&&G.push(Nde),r[d4e]&&G.push(kde);let X=G.length;if(a=this._vaf.writers,o/n>.1){for(let v=0;v<o;++v){let W=i[v];W._dirty=!1;for(let F=0;F<X;++F)G[F](this,c,a,W)}this._vaf.commit()}else{for(let v=0;v<o;++v){let W=i[v];W._dirty=!1;for(let F=0;F<X;++F)G[F](this,c,a,W);this._vaf.subCommit(W._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>n*1.5&&(i.length=n),!l(this._vaf)||!l(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,ce.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let m,p=M.IDENTITY;e.mode===ie.SCENE3D?(p=this.modelMatrix,m=ce.clone(this._baseVolumeWC,this._boundingVolume)):m=ce.clone(this._baseVolume2D,this._boundingVolume),f4e(this,e,m);let b=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,b&&(this._blendOption===Bi.OPAQUE||this._blendOption===Bi.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ne.fromCache({depthTest:{enabled:!0,func:ne.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===Bi.TRANSLUCENT||this._blendOption===Bi.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ne.fromCache({depthTest:{enabled:!0,func:ne.LEQUAL},depthMask:!1,blending:un.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||e.minimumDisableDepthTestDistance!==0;let f,x;if(b||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance){if(f=new Ue({sources:[j2]}),this._shaderScaleByDistance&&f.defines.push(\"EYE_DISTANCE_SCALING\"),this._shaderTranslucencyByDistance&&f.defines.push(\"EYE_DISTANCE_TRANSLUCENCY\"),this._shaderDistanceDisplayCondition&&f.defines.push(\"DISTANCE_DISPLAY_CONDITION\"),this._shaderDisableDepthDistance&&f.defines.push(\"DISABLE_DEPTH_DISTANCE\"),this._blendOption===Bi.OPAQUE_AND_TRANSLUCENT&&(x=new Ue({defines:[\"OPAQUE\"],sources:[Z0]}),this._sp=Ht.replaceCache({context:c,shaderProgram:this._sp,vertexShaderSource:f,fragmentShaderSource:x,attributeLocations:Hr}),x=new Ue({defines:[\"TRANSLUCENT\"],sources:[Z0]}),this._spTranslucent=Ht.replaceCache({context:c,shaderProgram:this._spTranslucent,vertexShaderSource:f,fragmentShaderSource:x,attributeLocations:Hr})),this._blendOption===Bi.OPAQUE&&(x=new Ue({sources:[Z0]}),this._sp=Ht.replaceCache({context:c,shaderProgram:this._sp,vertexShaderSource:f,fragmentShaderSource:x,attributeLocations:Hr})),this._blendOption===Bi.TRANSLUCENT&&(x=new Ue({sources:[Z0]}),this._spTranslucent=Ht.replaceCache({context:c,shaderProgram:this._spTranslucent,vertexShaderSource:f,fragmentShaderSource:x,attributeLocations:Hr})),!this._allDepthFailTranslucencyNoValue){let G=f.clone();G.defines.push(\"DEPTH_FAIL_TRANSLUCENCY\");let X=new Ue({sources:[Z0]});if(this._blendOption===Bi.OPAQUE_AND_TRANSLUCENT){let v=X.clone();v.defines.push(\"OPAQUE\"),this._spDepthFail=Ht.replaceCache({context:c,shaderProgram:this._spDepthFail,vertexShaderSource:G,fragmentShaderSource:v,attributeLocations:Hr});let W=X.clone();W.defines.push(\"TRANSLUCENT\"),this._spTranslucentDepthFail=Ht.replaceCache({context:c,shaderProgram:this._spTranslucentDepthFail,vertexShaderSource:G,fragmentShaderSource:W,attributeLocations:Hr})}if(this._blendOption===Bi.OPAQUE){let v=X.clone();this._spDepthFail=Ht.replaceCache({context:c,shaderProgram:this._spDepthFail,vertexShaderSource:G,fragmentShaderSource:v,attributeLocations:Hr})}if(this._blendOption===Bi.TRANSLUCENT){let v=X.clone();this._spTranslucentDepthFail=Ht.replaceCache({context:c,shaderProgram:this._spTranslucentDepthFail,vertexShaderSource:G,fragmentShaderSource:v,attributeLocations:Hr})}}this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance}let _,C,V,L,R=e.commandList;if(d.render||u){let G=this._colorCommands,X=this._blendOption===Bi.OPAQUE,v=this._blendOption===Bi.OPAQUE_AND_TRANSLUCENT;_=this._vaf.va,C=_.length,G.length=C;let W=v?C*2:C;for(L=0;L<W;++L){let F=X||v&&L%2===0;V=G[L],l(V)||(V=G[L]=new je),V.primitiveType=we.POINTS,V.pass=F||!v?Ze.OPAQUE:Ze.TRANSLUCENT,V.owner=this;let A=v?Math.floor(L/2):L;if(V.boundingVolume=m,V.modelMatrix=p,V.shaderProgram=F?this._sp:this._spTranslucent,V.uniformMap=this._uniforms,V.vertexArray=_[A].va,V.renderState=F?this._rsOpaque:this._rsTranslucent,V.debugShowBoundingVolume=this.debugShowBoundingVolume,V.pickId=\"v_pickColor\",R.push(V),!this._allDepthFailTranslucencyNoValue){let y=F?this._spDepthFail:this._spTranslucentDepthFail;if(y){let Z=new je;Z.primitiveType=we.POINTS,Z.boundingVolume=m,Z.pass=Ze.TRANSLUCENT,Z.owner=this,Z.modelMatrix=p,Z.shaderProgram=y,Z.uniformMap=this._uniforms,Z.vertexArray=_[A].va,Z.renderState=this._rsDepthFail,Z.pickId=\"v_pickColor\",R.push(Z)}}}}};Fu.prototype.isDestroyed=function(){return!1};Fu.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy(),this._spTranslucentDepthFail=this._spTranslucentDepthFail&&this._spTranslucentDepthFail.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),vde(this._pointPrimitives),me(this)};var b1=Fu;var mYn=T(S(),1),Ude=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],SK=1,$2=8,tP=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error(\"Data must be an instance of ArrayBuffer.\");let[n,i]=new Uint8Array(t,0,2);if(n!==219)throw new Error(\"Data does not appear to be in a KDBush format.\");let o=i>>4;if(o!==SK)throw new Error(`Got v${o} data when expected v${SK}.`);let r=Ude[i&15];if(!r)throw new Error(\"Unrecognized array type.\");let[s]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new e(a,s,r,t)}constructor(t,n=64,i=Float64Array,o){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let r=Ude.indexOf(this.ArrayType),s=t*2*this.ArrayType.BYTES_PER_ELEMENT,a=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,$2,t),this.coords=new this.ArrayType(this.data,$2+a+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer($2+s+a+c),this.ids=new this.IndexArrayType(this.data,$2,t),this.coords=new this.ArrayType(this.data,$2+a+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(SK<<4)+r]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){let i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=n,i}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return VK(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,i,o){if(!this._finished)throw new Error(\"Data not yet indexed - call index.finish().\");let{ids:r,coords:s,nodeSize:a}=this,c=[0,r.length-1,0],d=[];for(;c.length;){let u=c.pop()||0,m=c.pop()||0,p=c.pop()||0;if(m-p<=a){for(let _=p;_<=m;_++){let C=s[2*_],V=s[2*_+1];C>=t&&C<=i&&V>=n&&V<=o&&d.push(r[_])}continue}let b=p+m>>1,f=s[2*b],x=s[2*b+1];f>=t&&f<=i&&x>=n&&x<=o&&d.push(r[b]),(u===0?t<=f:n<=x)&&(c.push(p),c.push(b-1),c.push(1-u)),(u===0?i>=f:o>=x)&&(c.push(b+1),c.push(m),c.push(1-u))}return d}within(t,n,i){if(!this._finished)throw new Error(\"Data not yet indexed - call index.finish().\");let{ids:o,coords:r,nodeSize:s}=this,a=[0,o.length-1,0],c=[],d=i*i;for(;a.length;){let u=a.pop()||0,m=a.pop()||0,p=a.pop()||0;if(m-p<=s){for(let _=p;_<=m;_++)Dde(r[2*_],r[2*_+1],t,n)<=d&&c.push(o[_]);continue}let b=p+m>>1,f=r[2*b],x=r[2*b+1];Dde(f,x,t,n)<=d&&c.push(o[b]),(u===0?t-i<=f:n-i<=x)&&(a.push(p),a.push(b-1),a.push(1-u)),(u===0?t+i>=f:n+i>=x)&&(a.push(b+1),a.push(m),a.push(1-u))}return c}};function VK(e,t,n,i,o,r){if(o-i<=n)return;let s=i+o>>1;Bde(e,t,s,i,o,r),VK(e,t,n,i,s-1,1-r),VK(e,t,n,s+1,o,1-r)}function Bde(e,t,n,i,o,r){for(;o>i;){if(o-i>600){let d=o-i+1,u=n-i+1,m=Math.log(d),p=.5*Math.exp(2*m/3),b=.5*Math.sqrt(m*p*(d-p)/d)*(u-d/2<0?-1:1),f=Math.max(i,Math.floor(n-u*p/d+b)),x=Math.min(o,Math.floor(n+(d-u)*p/d+b));Bde(e,t,n,f,x,r)}let s=t[2*n+r],a=i,c=o;for(eP(e,t,i,n),t[2*o+r]>s&&eP(e,t,i,o);a<c;){for(eP(e,t,a,c),a++,c--;t[2*a+r]<s;)a++;for(;t[2*c+r]>s;)c--}t[2*i+r]===s?eP(e,t,i,c):(c++,eP(e,t,c,o)),c<=n&&(i=c+1),n<=c&&(o=c-1)}}function eP(e,t,n,i){CK(e,n,i),CK(t,2*n,2*i),CK(t,2*n+1,2*i+1)}function CK(e,t,n){let i=e[t];e[t]=e[n],e[n]=i}function Dde(e,t,n,i){let o=e-n,r=t-i;return o*o+r*r}function eh(e){e=g(e,g.EMPTY_OBJECT),this._enabled=g(e.enabled,!1),this._pixelRange=g(e.pixelRange,80),this._minimumClusterSize=g(e.minimumClusterSize,2),this._clusterBillboards=g(e.clusterBillboards,!0),this._clusterLabels=g(e.clusterLabels,!0),this._clusterPoints=g(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new ge,this.show=g(e.show,!0)}function Yde(e,t){e.x-=t,e.y-=t,e.width+=t*2,e.height+=t*2}var b4e=new ze;function Ode(e,t,n,i,o){if(l(e._labelCollection)&&i._clusterLabels?o=_y.getScreenSpaceBoundingBox(e,t,o):l(e._billboardCollection)&&i._clusterBillboards?o=ao.getScreenSpaceBoundingBox(e,t,o):l(e._pointPrimitiveCollection)&&i._clusterPoints&&(o=_s.getScreenSpaceBoundingBox(e,t,o)),Yde(o,n),i._clusterLabels&&!l(e._labelCollection)&&l(e.id)&&Hde(i,e.id.id)&&l(e.id._label)){let r=i._collectionIndicesByEntity[e.id.id].labelIndex,s=i._labelCollection.get(r),a=_y.getScreenSpaceBoundingBox(s,t,b4e);Yde(a,n),o=ze.union(o,a,o)}return o}function y4e(e,t){if(e.clusterShow=!0,!l(e._labelCollection)&&l(e.id)&&Hde(t,e.id.id)&&l(e.id._label)){let n=t._collectionIndicesByEntity[e.id.id].labelIndex,i=t._labelCollection.get(n);i.clusterShow=!0}}function zde(e,t,n,i){let o={billboard:i._clusterBillboardCollection.add(),label:i._clusterLabelCollection.add(),point:i._clusterPointCollection.add()};o.billboard.show=!1,o.point.show=!1,o.label.show=!0,o.label.text=t.toLocaleString(),o.label.id=n,o.billboard.position=o.label.position=o.point.position=e,i._clusterEvent.raiseEvent(n,o)}function Hde(e,t){return l(e)&&l(e._collectionIndicesByEntity[t])&&l(e._collectionIndicesByEntity[t].labelIndex)}function LK(e,t,n,i,o){if(!l(e))return;let r=e.length;for(let s=0;s<r;++s){let a=e.get(s);if(a.clusterShow=!1,!a.show||o._scene.mode===ie.SCENE3D&&!i.isPointVisible(a.position))continue;let c=o._clusterLabels&&l(a._labelCollection),d=o._clusterBillboards&&l(a.id._billboard),u=o._clusterPoints&&l(a.id._point);if(c&&(u||d))continue;let m=a.computeScreenSpacePosition(n);l(m)&&t.push({index:s,collection:e,clustered:!1,coord:m})}}var g4e=new ze,x4e=new ze,_4e=new ze;function T4e(e){return function(t){if(l(t)&&t<.05||!e.enabled)return;let n=e._scene,i=e._labelCollection,o=e._billboardCollection,r=e._pointCollection;if(!l(i)&&!l(o)&&!l(r)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let s=e._clusterLabelCollection,a=e._clusterBillboardCollection,c=e._clusterPointCollection;l(s)?s.removeAll():s=e._clusterLabelCollection=new hf({scene:n}),l(a)?a.removeAll():a=e._clusterBillboardCollection=new yd({scene:n}),l(c)?c.removeAll():c=e._clusterPointCollection=new b1;let d=e._pixelRange,u=e._minimumClusterSize,m=e._previousClusters,p=[],b=e._previousHeight,f=n.camera.positionCartographic.height,x=n.mapProjection.ellipsoid,_=n.camera.positionWC,C=new L0(x,_),V=[];e._clusterLabels&&LK(i,V,n,C,e),e._clusterBillboards&&LK(o,V,n,C,e),e._clusterPoints&&LK(r,V,n,C,e);let L,R,G,X,v,W,F,A,y,Z,E,I;if(V.length>0){let w=new tP(V.length,64,Uint32Array);for(let k=0;k<V.length;++k)w.add(V[k].coord.x,V[k].coord.y);if(w.finish(),f<b)for(G=m.length,L=0;L<G;++L){let k=m[L];if(!C.isPointVisible(k.position))continue;let B=ao._computeScreenSpacePosition(M.IDENTITY,k.position,h.ZERO,D.ZERO,n);if(!l(B))continue;let U=1-f/b,Y=k.width=k.width*U,N=k.height=k.height*U;Y=Math.max(Y,k.minimumWidth),N=Math.max(N,k.minimumHeight);let J=B.x-Y*.5,z=B.y-N*.5,ee=B.x+Y,H=B.y+N;for(v=w.range(J,z,ee,H),W=v.length,Z=0,y=[],R=0;R<W;++R)F=v[R],A=V[F],A.clustered||(++Z,E=A.collection,I=A.index,y.push(E.get(I).id));if(Z>=u)for(zde(k.position,Z,y,e),p.push(k),R=0;R<W;++R)V[v[R]].clustered=!0}for(G=V.length,L=0;L<G;++L){let k=V[L];if(k.clustered)continue;k.clustered=!0,E=k.collection,I=k.index;let B=E.get(I);X=Ode(B,k.coord,d,e,g4e);let U=ze.clone(X,x4e);v=w.range(X.x,X.y,X.x+X.width,X.y+X.height),W=v.length;let Y=h.clone(B.position);for(Z=1,y=[B.id],R=0;R<W;++R)if(F=v[R],A=V[F],!A.clustered){let N=A.collection.get(A.index),J=Ode(N,A.coord,d,e,_4e);h.add(N.position,Y,Y),ze.union(U,J,U),++Z,y.push(N.id)}if(Z>=u){let N=h.multiplyByScalar(Y,1/Z,Y);for(zde(N,Z,y,e),p.push({position:N,width:U.width,height:U.height,minimumWidth:X.width,minimumHeight:X.height}),R=0;R<W;++R)V[v[R]].clustered=!0}else y4e(B,e)}}s.length===0&&(s.destroy(),e._clusterLabelCollection=void 0),a.length===0&&(a.destroy(),e._clusterBillboardCollection=void 0),c.length===0&&(c.destroy(),e._clusterPointCollection=void 0),e._previousClusters=p,e._previousHeight=f}}eh.prototype._initialize=function(e){this._scene=e;let t=T4e(this);this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)};Object.defineProperties(eh.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}},collectionIndicesByEntity:{get:function(){return this._collectionIndicesByEntity}}});function RK(e,t,n,i){return function(o){let r=this[e];l(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let s=this._collectionIndicesByEntity[o.id];if(l(s)||(s=this._collectionIndicesByEntity[o.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),l(r)&&l(s[i]))return r.get(s[i]);l(r)||(r=this[e]=new t({scene:this._scene}));let a,c,d=this[n];d.length>0?(a=d.shift(),c=r.get(a)):(c=r.add(),a=r.length-1),s[i]=a;let u=this;return Promise.resolve().then(function(){u._clusterDirty=!0}),c}}function GK(e,t){let n=e._collectionIndicesByEntity[t];!l(n.billboardIndex)&&!l(n.labelIndex)&&!l(n.pointIndex)&&delete e._collectionIndicesByEntity[t]}eh.prototype.getLabel=RK(\"_labelCollection\",hf,\"_unusedLabelIndices\",\"labelIndex\");eh.prototype.removeLabel=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!l(this._labelCollection)||!l(t)||!l(t.labelIndex))return;let n=t.labelIndex;t.labelIndex=void 0,GK(this,e.id);let i=this._labelCollection.get(n);i.show=!1,i.text=\"\",i.id=void 0,this._unusedLabelIndices.push(n),this._clusterDirty=!0};eh.prototype.getBillboard=RK(\"_billboardCollection\",yd,\"_unusedBillboardIndices\",\"billboardIndex\");eh.prototype.removeBillboard=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!l(this._billboardCollection)||!l(t)||!l(t.billboardIndex))return;let n=t.billboardIndex;t.billboardIndex=void 0,GK(this,e.id);let i=this._billboardCollection.get(n);i.id=void 0,i.show=!1,i.image=void 0,this._unusedBillboardIndices.push(n),this._clusterDirty=!0};eh.prototype.getPoint=RK(\"_pointCollection\",b1,\"_unusedPointIndices\",\"pointIndex\");eh.prototype.removePoint=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!l(this._pointCollection)||!l(t)||!l(t.pointIndex))return;let n=t.pointIndex;t.pointIndex=void 0,GK(this,e.id);let i=this._pointCollection.get(n);i.show=!1,i.id=void 0,this._unusedPointIndices.push(n),this._clusterDirty=!0};function ZK(e){if(!l(e))return;let t=e.length;for(let n=0;n<t;++n)e.get(n).clusterShow=!0}function S4e(e){e.enabled||(l(e._clusterLabelCollection)&&e._clusterLabelCollection.destroy(),l(e._clusterBillboardCollection)&&e._clusterBillboardCollection.destroy(),l(e._clusterPointCollection)&&e._clusterPointCollection.destroy(),e._clusterLabelCollection=void 0,e._clusterBillboardCollection=void 0,e._clusterPointCollection=void 0,ZK(e._labelCollection),ZK(e._billboardCollection),ZK(e._pointCollection))}eh.prototype.update=function(e){if(!this.show)return;let t;l(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),l(this._billboardCollection)&&this._billboardCollection.length>0&&!l(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,S4e(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),l(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),l(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),l(this._clusterPointCollection)&&this._clusterPointCollection.update(e),l(this._labelCollection)&&this._labelCollection.update(e),l(this._billboardCollection)&&this._billboardCollection.update(e),l(this._pointCollection)&&this._pointCollection.update(e)};eh.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),l(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var Sd=eh;function EK(e){this._name=e,this._clock=void 0,this._changed=new ge,this._error=new ge,this._isLoading=!1,this._loading=new ge,this._entityCollection=new Us(this),this._entityCluster=new Sd}Object.defineProperties(EK.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){Pr.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}});EK.prototype.update=function(e){return!0};var nP=EK;var NOn=T(S(),1);var nOn=T(S(),1);var NYn=T(S(),1);var Kde={};Kde.computePositions=function(e,t,n,i,o){let r=e*.5,s=-r,a=i+i,c=o?2*a:a,d=new Float64Array(c*3),u,m=0,p=0,b=o?a*3:0,f=o?(a+i)*3:i*3;for(u=0;u<i;u++){let x=u/i*P.TWO_PI,_=Math.cos(x),C=Math.sin(x),V=_*n,L=C*n,R=_*t,G=C*t;d[p+b]=V,d[p+b+1]=L,d[p+b+2]=s,d[p+f]=R,d[p+f+1]=G,d[p+f+2]=r,p+=3,o&&(d[m++]=V,d[m++]=L,d[m++]=s,d[m++]=R,d[m++]=G,d[m++]=r)}return d};var A_=Kde;var XK=new D,C4e=new h,V4e=new h,L4e=new h,Z4e=new h;function R0(e){e=g(e,g.EMPTY_OBJECT);let t=e.length,n=e.topRadius,i=e.bottomRadius,o=g(e.vertexFormat,Pe.DEFAULT),r=g(e.slices,128);this._length=t,this._topRadius=n,this._bottomRadius=i,this._vertexFormat=Pe.clone(o),this._slices=r,this._offsetAttribute=e.offsetAttribute,this._workerName=\"createCylinderGeometry\"}R0.packedLength=Pe.packedLength+5;R0.pack=function(e,t,n){return n=g(n,0),Pe.pack(e._vertexFormat,t,n),n+=Pe.packedLength,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n]=g(e._offsetAttribute,-1),t};var Jde=new Pe,y1={vertexFormat:Jde,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};R0.unpack=function(e,t,n){t=g(t,0);let i=Pe.unpack(e,t,Jde);t+=Pe.packedLength;let o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return l(n)?(n._vertexFormat=Pe.clone(i,n._vertexFormat),n._length=o,n._topRadius=r,n._bottomRadius=s,n._slices=a,n._offsetAttribute=c===-1?void 0:c,n):(y1.length=o,y1.topRadius=r,y1.bottomRadius=s,y1.slices=a,y1.offsetAttribute=c===-1?void 0:c,new R0(y1))};R0.createGeometry=function(e){let t=e._length,n=e._topRadius,i=e._bottomRadius,o=e._vertexFormat,r=e._slices;if(t<=0||n<0||i<0||n===0&&i===0)return;let s=r+r,a=r+s,c=s+s,d=A_.computePositions(t,n,i,r,!0),u=o.st?new Float32Array(c*2):void 0,m=o.normal?new Float32Array(c*3):void 0,p=o.tangent?new Float32Array(c*3):void 0,b=o.bitangent?new Float32Array(c*3):void 0,f,x=o.normal||o.tangent||o.bitangent;if(x){let v=o.tangent||o.bitangent,W=0,F=0,A=0,y=Math.atan2(i-n,t),Z=C4e;Z.z=Math.sin(y);let E=Math.cos(y),I=L4e,w=V4e;for(f=0;f<r;f++){let k=f/r*P.TWO_PI,B=E*Math.cos(k),U=E*Math.sin(k);x&&(Z.x=B,Z.y=U,v&&(I=h.normalize(h.cross(h.UNIT_Z,Z,I),I)),o.normal&&(m[W++]=Z.x,m[W++]=Z.y,m[W++]=Z.z,m[W++]=Z.x,m[W++]=Z.y,m[W++]=Z.z),o.tangent&&(p[F++]=I.x,p[F++]=I.y,p[F++]=I.z,p[F++]=I.x,p[F++]=I.y,p[F++]=I.z),o.bitangent&&(w=h.normalize(h.cross(Z,I,w),w),b[A++]=w.x,b[A++]=w.y,b[A++]=w.z,b[A++]=w.x,b[A++]=w.y,b[A++]=w.z))}for(f=0;f<r;f++)o.normal&&(m[W++]=0,m[W++]=0,m[W++]=-1),o.tangent&&(p[F++]=1,p[F++]=0,p[F++]=0),o.bitangent&&(b[A++]=0,b[A++]=-1,b[A++]=0);for(f=0;f<r;f++)o.normal&&(m[W++]=0,m[W++]=0,m[W++]=1),o.tangent&&(p[F++]=1,p[F++]=0,p[F++]=0),o.bitangent&&(b[A++]=0,b[A++]=1,b[A++]=0)}let _=12*r-12,C=Ae.createTypedArray(c,_),V=0,L=0;for(f=0;f<r-1;f++)C[V++]=L,C[V++]=L+2,C[V++]=L+3,C[V++]=L,C[V++]=L+3,C[V++]=L+1,L+=2;for(C[V++]=s-2,C[V++]=0,C[V++]=1,C[V++]=s-2,C[V++]=1,C[V++]=s-1,f=1;f<r-1;f++)C[V++]=s+f+1,C[V++]=s+f,C[V++]=s;for(f=1;f<r-1;f++)C[V++]=a,C[V++]=a+f,C[V++]=a+f+1;let R=0;if(o.st){let v=Math.max(n,i);for(f=0;f<c;f++){let W=h.fromArray(d,f*3,Z4e);u[R++]=(W.x+v)/(2*v),u[R++]=(W.y+v)/(2*v)}}let G=new hn;o.position&&(G.position=new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:d})),o.normal&&(G.normal=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:m})),o.tangent&&(G.tangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:p})),o.bitangent&&(G.bitangent=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:3,values:b})),o.st&&(G.st=new Ee({componentDatatype:Q.FLOAT,componentsPerAttribute:2,values:u})),XK.x=t*.5,XK.y=Math.max(i,n);let X=new ce(h.ZERO,D.magnitude(XK));if(l(e._offsetAttribute)){t=d.length;let v=e._offsetAttribute===cn.NONE?0:1,W=new Uint8Array(t/3).fill(v);G.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:W})}return new ut({attributes:G,indices:C,primitiveType:we.TRIANGLES,boundingSphere:X,offsetAttribute:e._offsetAttribute})};var IK;R0.getUnitCylinder=function(){return l(IK)||(IK=R0.createGeometry(new R0({topRadius:1,bottomRadius:1,length:1,vertexFormat:Pe.POSITION_ONLY}))),IK};var iP=R0;var yOn=T(S(),1);var WK=new D;function g1(e){e=g(e,g.EMPTY_OBJECT);let t=e.length,n=e.topRadius,i=e.bottomRadius,o=g(e.slices,128),r=Math.max(g(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=n,this._bottomRadius=i,this._slices=o,this._numberOfVerticalLines=r,this._offsetAttribute=e.offsetAttribute,this._workerName=\"createCylinderOutlineGeometry\"}g1.packedLength=6;g1.pack=function(e,t,n){return n=g(n,0),t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n++]=e._numberOfVerticalLines,t[n]=g(e._offsetAttribute,-1),t};var M_={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};g1.unpack=function(e,t,n){t=g(t,0);let i=e[t++],o=e[t++],r=e[t++],s=e[t++],a=e[t++],c=e[t];return l(n)?(n._length=i,n._topRadius=o,n._bottomRadius=r,n._slices=s,n._numberOfVerticalLines=a,n._offsetAttribute=c===-1?void 0:c,n):(M_.length=i,M_.topRadius=o,M_.bottomRadius=r,M_.slices=s,M_.numberOfVerticalLines=a,M_.offsetAttribute=c===-1?void 0:c,new g1(M_))};g1.createGeometry=function(e){let t=e._length,n=e._topRadius,i=e._bottomRadius,o=e._slices,r=e._numberOfVerticalLines;if(t<=0||n<0||i<0||n===0&&i===0)return;let s=o*2,a=A_.computePositions(t,n,i,o,!1),c=o*2,d;if(r>0){let x=Math.min(r,o);d=Math.round(o/x),c+=x}let u=Ae.createTypedArray(s,c*2),m=0,p;for(p=0;p<o-1;p++)u[m++]=p,u[m++]=p+1,u[m++]=p+o,u[m++]=p+1+o;if(u[m++]=o-1,u[m++]=0,u[m++]=o+o-1,u[m++]=o,r>0)for(p=0;p<o;p+=d)u[m++]=p,u[m++]=p+o;let b=new hn;b.position=new Ee({componentDatatype:Q.DOUBLE,componentsPerAttribute:3,values:a}),WK.x=t*.5,WK.y=Math.max(i,n);let f=new ce(h.ZERO,D.magnitude(WK));if(l(e._offsetAttribute)){t=a.length;let x=e._offsetAttribute===cn.NONE?0:1,_=new Uint8Array(t/3).fill(x);b.applyOffset=new Ee({componentDatatype:Q.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}return new ut({attributes:b,indices:u,primitiveType:we.LINES,boundingSphere:f,offsetAttribute:e._offsetAttribute})};var oP=g1;var Qde=h.ZERO,jde=new h,R4e=new h,qde=new O;function G4e(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function Cd(e,t){ii.call(this,{entity:e,scene:t,geometryOptions:new G4e(e),geometryPropertyName:\"cylinder\",observedPropertyNames:[\"availability\",\"position\",\"orientation\",\"cylinder\"]}),this._onEntityPropertyChanged(e,\"cylinder\",e.cylinder,void 0)}l(Object.create)&&(Cd.prototype=Object.create(ii.prototype),Cd.prototype.constructor=Cd);Object.defineProperties(Cd.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Cd.prototype.createFillGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=new xn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),r=kn.fromDistanceDisplayCondition(o),s={show:i,distanceDisplayCondition:r,color:void 0,offset:void 0};if(this._materialProperty instanceof kt){let a;l(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(a=this._materialProperty.color.getValue(e,qde)),l(a)||(a=O.WHITE),s.color=Ot.fromColor(a)}return l(this._options.offsetAttribute)&&(s.offset=Ji.fromCartesian3(K.getValueOrDefault(this._terrainOffsetProperty,e,Qde,jde))),new Vt({id:t,geometry:new iP(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,this._options.length*.5,this._scene.mapProjection.ellipsoid),attributes:s})};Cd.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,n=t.isAvailable(e),i=K.getValueOrDefault(this._outlineColorProperty,e,O.BLACK,qde),o=this._distanceDisplayConditionProperty.getValue(e),r={show:new xn(n&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:Ot.fromColor(i),distanceDisplayCondition:kn.fromDistanceDisplayCondition(o),offset:void 0};return l(this._options.offsetAttribute)&&(r.offset=Ji.fromCartesian3(K.getValueOrDefault(this._terrainOffsetProperty,e,Qde,jde))),new Vt({id:t,geometry:new oP(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,this._options.length*.5,this._scene.mapProjection.ellipsoid),attributes:r})};Cd.prototype._computeCenter=function(e,t){return K.getValueOrUndefined(this._entity.position,e,t)};Cd.prototype._isHidden=function(e,t){return!l(e.position)||!l(t.length)||!l(t.topRadius)||!l(t.bottomRadius)||ii.prototype._isHidden.call(this,e,t)};Cd.prototype._isDynamic=function(e,t){return!e.position.isConstant||!K.isConstant(e.orientation)||!t.length.isConstant||!t.topRadius.isConstant||!t.bottomRadius.isConstant||!K.isConstant(t.slices)||!K.isConstant(t.outlineWidth)||!K.isConstant(t.numberOfVerticalLines)};Cd.prototype._setStaticOptions=function(e,t){let n=K.getValueOrDefault(t.heightReference,Be.MINIMUM_VALUE,Je.NONE),i=this._options;i.vertexFormat=this._materialProperty instanceof kt?ln.VERTEX_FORMAT:so.MaterialSupport.TEXTURED.vertexFormat,i.length=t.length.getValue(Be.MINIMUM_VALUE),i.topRadius=t.topRadius.getValue(Be.MINIMUM_VALUE),i.bottomRadius=t.bottomRadius.getValue(Be.MINIMUM_VALUE),i.slices=K.getValueOrUndefined(t.slices,Be.MINIMUM_VALUE),i.numberOfVerticalLines=K.getValueOrUndefined(t.numberOfVerticalLines,Be.MINIMUM_VALUE),i.offsetAttribute=n!==Je.NONE?cn.ALL:void 0};Cd.prototype._onEntityPropertyChanged=Wp;Cd.DynamicGeometryUpdater=x1;function x1(e,t,n){ni.call(this,e,t,n)}l(Object.create)&&(x1.prototype=Object.create(ni.prototype),x1.prototype.constructor=x1);x1.prototype._isHidden=function(e,t,n){let i=this._options,o=K.getValueOrUndefined(e.position,n,R4e);return!l(o)||!l(i.length)||!l(i.topRadius)||!l(i.bottomRadius)||ni.prototype._isHidden.call(this,e,t,n)};x1.prototype._setOptions=function(e,t,n){let i=K.getValueOrDefault(t.heightReference,n,Je.NONE),o=this._options;o.length=K.getValueOrUndefined(t.length,n),o.topRadius=K.getValueOrUndefined(t.topRadius,n),o.bottomRadius=K.getValueOrUndefined(t.bottomRadius,n),o.slices=K.getValueOrUndefined(t.slices,n),o.numberOfVerticalLines=K.getValueOrUndefined(t.numberOfVerticalLines,n),o.offsetAttribute=i!==Je.NONE?cn.ALL:void 0};var rP=Cd;var FQn=T(S(),1);var UOn=T(S(),1),E4e={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},vr=Object.freeze(E4e);var BOn=T(S(),1),X4e={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},mo=Object.freeze(X4e);var OOn=T(S(),1),I4e={NONE:0,HOLD:1,EXTRAPOLATE:2},Vd=Object.freeze(I4e);var HOn=T(S(),1),$de=T(td(),1);function W4e(e){let t=new $de.default(e);t.normalize();let n=t.path(),i=n.lastIndexOf(\"/\");return i!==-1&&(n=n.substr(i+1)),n}var G0=W4e;var qOn=T(S(),1);var P4e=P.factorial;function PK(e,t,n,i,o,r){let s=0,a,c,d;if(i>0){for(c=0;c<o;c++){for(a=!1,d=0;d<r.length&&!a;d++)c===r[d]&&(a=!0);a||(r.push(c),s+=PK(e,t,n,i-1,o,r),r.splice(r.length-1,1))}return s}for(s=1,c=0;c<o;c++){for(a=!1,d=0;d<r.length&&!a;d++)c===r[d]&&(a=!0);a||(s*=e-n[t[c]])}return s}var ok={type:\"Hermite\"};ok.getRequiredDataPoints=function(e,t){return t=g(t,0),Math.max(Math.floor((e+1)/(t+1)),2)};ok.interpolateOrderZero=function(e,t,n,i,o){l(o)||(o=new Array(i));let r,s,a,c,d,u,m=t.length,p=new Array(i);for(r=0;r<i;r++){o[r]=0;let _=new Array(m);for(p[r]=_,s=0;s<m;s++)_[s]=[]}let b=m,f=new Array(b);for(r=0;r<b;r++)f[r]=r;let x=m-1;for(c=0;c<i;c++){for(s=0;s<b;s++)u=f[s]*i+c,p[c][0].push(n[u]);for(r=1;r<b;r++){let _=!1;for(s=0;s<b-r;s++){let C=t[f[s]],V=t[f[s+r]],L;V-C<=0?(u=f[s]*i+i*r+c,L=n[u],p[c][r].push(L/P4e(r))):(L=p[c][r-1][s+1]-p[c][r-1][s],p[c][r].push(L/(V-C))),_=_||L!==0}_||(x=r-1)}}for(a=0,d=0;a<=d;a++)for(r=a;r<=x;r++){let _=PK(e,f,t,a,r,[]);for(c=0;c<i;c++){let C=p[c][r][0];o[c+a*i]+=C*_}}return"
}
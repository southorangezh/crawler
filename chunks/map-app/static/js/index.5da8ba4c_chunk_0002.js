{
  "metadata": {
    "source_file": "map-app\\static\\js\\index.5da8ba4c.js",
    "chunk_index": 2,
    "total_chunks": 918,
    "chunk_size": 32540,
    "word_count": 800,
    "model_kwargs": {
      "model": "text-embedding-3-large",
      "dimensions": 3072,
      "encoding_format": "float"
    },
    "text_splitter": {
      "split_by": "word",
      "chunk_size": 800,
      "chunk_overlap": 200
    },
    "created_at": "2025-12-17T23:57:50.139Z"
  },
  "content": "id(){return this.properties.id||(0,uW.k)()}get cssColor(){return this.properties.cssColor||pL.Color}get coordFormat(){return this.properties.coordFormat||\"DEGREE\"}get positionsArray(){return this.properties.positionsArray||[]}get positionsArrayWC(){return this.properties.positionsArrayWC||[]}get boundingSphere(){return\"ECEF\"===this.coordFormat?uf.BoundingSphere.fromPoints(this.positionsArrayWC.reduce((e,a)=>e.concat(a.positions.map(e=>uf.Cartesian3.fromArray(e))),[])):uf.BoundingSphere.fromPoints(this.positionsArray.reduce((e,a)=>e.concat(a.positions.map(e=>(0,pg.jL)(e))),[]))}get isLineSegments(){return this.properties.isLineSegments||!1}get useAsyncGeometry(){return!this.readyForGroundGeometry}get ground(){return!!this.properties.ground}get occludedAlpha(){return this.properties.occludedAlpha||1}get enableOccludedStyle(){return!0===this.properties.enableOccludedStyle}toggleDimension(){this.properties.ground=!this.ground,this.updatePrimitiveAllManagers()}getPositionsByPartId(e){let a=e.split(\"-\"),r=this.isLineSegments;if(r&&3!==a.length||!r&&2!==a.length||a[0]!==this.id)return;let t=Number.parseInt(a[1]);if(!r&&this.positionsArray.length>t)return this.positionsArray[t].positions;if(r){let e=this.positionsArray[t].positions,r=Number.parseInt(a[2]);return[e[2*r],e[2*r+1]]}}partActiveState;hoverPartId;selectedPartId;hover(e,a){let{selected:r,hover:t}=this.partActiveState;if(r&&this.selectedPartId===e||t&&this.hoverPartId===e&&a)return;this.partActiveState.hover=a;let n=e.split(\"-\");if(this.isLineSegments&&3!==n.length||!this.isLineSegments&&2!==n.length)return;let i=+n[n.length-1];if((!!this.isLineSegments||!(i>this.positionsArray.length))&&(!this.isLineSegments||0!==this.positionsArray.length))a?this.hoverPartId=e:this.hoverPartId=\"\",this.updateHighlightPart(\"hover\",a,e)}unHover(){this.members._keys().forEach(e=>{let a=this.managers._get(e),r=this.members._get(e);if(!!a&&!!r)a.viewer.scene.primitives.remove(r.hovered),r.hovered=void 0}),this.hoverPartId=\"\"}updateHighlightPart(e,a,r){this.managers._keys().forEach(t=>{let n=this.managers._get(t).viewer,i=this.members._get(t);if(!i||!n)return;let o=\"hover\"===e?i.hovered:i.selected;if(n.scene.primitives.remove(o),\"hover\"===e?i.hovered=void 0:\"selected\"===e&&(i.selected=void 0),!a)return;let s=function(e,a){let r,t;let n=a.split(\"-\"),i=+n[n.length-1],o=e.isLineSegments?e.positionsArray[0]:e.positionsArray[i],s=e.ground;if(e.isLineSegments){let a;r=[];let t=+n[1],o=e.positionsArray[t].positions,l=(0,pg.jL)(o[2*i]),d=(0,pg.jL)(o[2*i+1]);a=s?new uf.GroundPolylineGeometry({positions:[l,d],width:3}):new uf.PolylineGeometry({positions:[l,d],width:3}),r.push(new uf.GeometryInstance({geometry:a}))}else r=pW([o],s,e.isLineSegments,e.id,3);let l=function(e){let a=uf.Color.fromCssColorString(e.cssColor),r=uf.Material.fromType(uf.Material.PolylineOutlineType,{color:a,outlineColor:uf.Color.WHITE,outlineWidth:2});return new uf.PolylineMaterialAppearance({material:r})}(e);return t=s?new uf.GroundPolylinePrimitive({geometryInstances:r,appearance:l,asynchronous:e.useAsyncGeometry,allowPicking:!1}):new uf.Primitive({geometryInstances:r,appearance:l,depthFailAppearance:l,asynchronous:e.useAsyncGeometry,allowPicking:!1})}(this,r);n.scene.primitives.add(s),\"hover\"===e?i.hovered=s:\"selected\"===e&&(i.selected=s)})}select(e,a){let{selected:r}=this.partActiveState;if(r&&this.selectedPartId===e&&a)return;this.partActiveState.selected=a;let t=e.split(\"-\");if(this.isLineSegments&&3!==t.length||!this.isLineSegments&&2!==t.length)return;let n=+t[t.length-1];if((!!this.isLineSegments||!(n>this.positionsArray.length))&&(!this.isLineSegments||0!==this.positionsArray.length))a?this.selectedPartId=e:this.selectedPartId=\"\",this.updateHighlightPart(\"selected\",a,e),a&&this.unHover()}unSelect(){this.members._keys().forEach(e=>{let a=this.managers._get(e),r=this.members._get(e);if(!!a&&!!r)a.viewer.scene.primitives.remove(r.selected),r.selected=void 0}),this.selectedPartId=\"\"}getPartActive(e=\"\"){if(e)return this.partActiveState[e];{let{selected:e,recenter:a,hover:r}=this.partActiveState;return e||a||r}}updateShow(){let e=!1!==this.properties.show,a=this.members;a.lines&&a.lines.showSetter(e)}update(e){let a=this.properties,r=!1,t=!1;(0,pg.ri)(e.show)&&a.show!==e.show&&(a.show=e.show,this.updateShow()),(0,pg.ri)(e.positionsArray)&&(a.positionsArray=e.positionsArray,r=!0),(0,pg.ri)(e.cssColor)&&(a.cssColor=e.cssColor,t=!0),(0,pg.ri)(e.ground)&&(r=e.ground!==a.ground,a.ground=e.ground),(0,pg.ri)(e.occludedAlpha)&&(a.occludedAlpha=e.occludedAlpha,t=!0),(0,pg.ri)(e.enableOccludedStyle)&&(t=e.enableOccludedStyle!==a.enableOccludedStyle,a.enableOccludedStyle=e.enableOccludedStyle),(0,pg.ri)(e.isLineSegments)&&(a.isLineSegments=e.isLineSegments,r=!0),r&&(this.updatePrimitiveAllManagers(),t=!1),t&&this.updateStyleAllManagers()}updatePolylinePrimitive(e){let a=this.managers._get(e);if(!a)return;let r=a.viewer.scene.primitives,t=this.members._get(e);!t&&(this.members._add(e,{}),t=this.members._get(e));let n=t.lines;n&&r.contains(n)&&r.remove(n),t.lines=void 0;let i=function(e){let a=e.ground,r=e.positionsArray,t=e.positionsArrayWC,n=e.enableOccludedStyle,i=e.isLineSegments,o=\"DEGREE\"===e.coordFormat?pW(r,a,i,e.id):function(e,a,r,t,n=1){let i=[];return r?e.forEach((e,r)=>{let{positions:o}=e;if(o.length%2!=0)throw Error(\"[URANUS MAP] The number of points must be a multiple of 2 when rendering in LineSegment mode.\");for(let e=0,s=0;e<o.length;e+=2,s++){let l;let d=uf.Cartesian3.fromArray(o[e]),c=uf.Cartesian3.fromArray(o[e+1]);l=a?new uf.GroundPolylineGeometry({positions:[d,c],width:n}):new uf.PolylineGeometry({positions:[d,c],width:n});let u=new uf.GeometryInstance({id:`${t}-${r}-${s}`,geometry:l});i.push(u)}}):e.forEach((e,r)=>{let o;let s=e.positions.map(e=>uf.Cartesian3.fromArray(e));o=a?new uf.GroundPolylineGeometry({positions:s,width:n}):new uf.PolylineGeometry({positions:s,width:n}),i.push(new uf.GeometryInstance({id:`${t}-${r}`,geometry:o}))}),i}(t,a,i,e.id);o.forEach((a,r)=>{a.id=`${e.id}-${r}`});let s=pU(e),l=pK(e),d={geometryInstances:o,appearance:s,asynchronous:e.useAsyncGeometry};return a?new uf.GroundPolylinePrimitive(d):new uf.Primitive({...d,depthFailAppearance:n?l:void 0})}(this);i.show=!1!==this.properties.show,t.lines=i,r.add(i)}updatePolylineStyle(e){let a=this.members._get(e).lines;if(!a)return;let r=pU(this);a.appearance=r;let t=pK(this);a instanceof uf.Primitive&&this.enableOccludedStyle&&(a.depthFailAppearance=t)}appendPolyline(e){this.positionsArray.push(e),this.updatePrimitiveAllManagers()}appendPolylineECEFCoords(e){this.positionsArrayWC.push(e),this.updatePrimitiveAllManagers()}addPrimitives(e){this.updatePolylinePrimitive(e),this.managers._get(e).render()}removePrimitives(e){let a=this.members._get(e),r=this.managers._get(e);if(!r||!a)return;let t=r.viewer.scene.primitives;a.lines&&t.remove(a.lines)}updateStyleAllManagers(){this.managers._keys().forEach(e=>{this.updatePolylineStyle(e)})}updatePrimitiveAllManagers(){this.managers._keys().forEach(e=>{this.updatePolylinePrimitive(e)})}onManagerAdd(e){this.addPrimitives(e)}onManagerRemove(e){this.removePrimitives(e)}onManagerUpdate(e){let a=this.members._get(e),r=this.isShowIn(e);a&&!r&&this.onManagerRemove(e),!a&&r&&this.onManagerAdd(e)}setCollectionMap(){this.managers._options.elements.add(\"polyline-group\",this,[this.id])}hasPrimitive(e){return this.members._keys().some(a=>this.members._get(a).lines===e)}destroy(){this.removeCollectionMap(),this.members._keys().forEach(e=>{this.removePrimitives(e)})}}var pY=r(\"54670\"),pQ=r.n(pY),p$=r(\"9950\"),pX=r(\"2423\");let p0=document.createElement(\"canvas\").getContext(\"2d\"),p1=(e,a)=>{if(!globalThis.document||!p0)return null;p0.font=a;let r=p0.measureText(e);return{width:r.width,height:r.actualBoundingBoxDescent+r.actualBoundingBoxAscent,ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,minx:r.actualBoundingBoxLeft}};class p2{xMin;xMax;yMin;yMax;constructor(e=0,a=0,r=1,t=1){this.xMin=e,this.yMin=a,this.xMax=r,this.yMax=t}get width(){return this.xMax-this.xMin}get height(){return this.yMax-this.yMin}static from4End(e=0,a=0,r=1,t=1){return new p2(e,a,r,t)}static fromDiag(e,a){return new p2(...e,...a)}static intersect(e,a,r=0){return!(e.xMax-r<a.xMin)&&!(e.xMin+r>a.xMax)&&!(e.yMin+r>a.yMax)&&!(e.yMax-r<a.yMin)&&!0}inside(e,a){return e>this.xMin&&e<this.xMax&&a>this.yMin&&a<this.yMax}static fromCesiumBoundingRect(e){return new p2(e.x,e.y,e.x+e.width,e.y+e.height)}toCesiumBoundingRect(){return new uf.BoundingRectangle(this.xMin,this.yMin,this.width,this.height)}static union(e,a,r){return!r&&(r=new p2),r.xMin=Math.min(e.xMin,a.xMin),r.yMin=Math.min(e.yMin,a.yMin),r.xMax=Math.max(e.xMax,a.xMax),r.yMax=Math.max(e.yMax,a.yMax),r}copyFrom(e){this.xMin=e.xMin,this.xMax=e.xMax,this.yMin=e.yMin,this.yMax=e.yMax}}let p3=uf.Matrix4.fromRowMajorArray([-1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1]),p4={frameNumber:0,results:new Map};function p5(e,a){let r=a.toString(),t=e.scene.frameState.frameNumber;if(t===p4.frameNumber){let e=p4.results.get(r);if(e)return e}else p4.frameNumber=t,p4.results.clear();let n=e.scene.drillPick(a,3);return p4.results.set(r,n),n}function p6(e,a){return e.camera.pickEllipsoid(a,e.scene.globe.ellipsoid)}async function p9(e,a){let r;try{let t=await e.computedPositionTerrainHeight(a);r=a.map((e,a)=>(e.height=t[a]||0,e))}catch(e){r=a.map(e=>new uf.Cartographic(e.longitude,e.latitude,0))}return r}function p8(e){let a=uf.Cartesian3.clone(uf.Ellipsoid.WGS84.radii);return a.x=a.x+e,a.y=a.y+e,a.z=a.z+e,uf.Ellipsoid.fromCartesian3(a)}function p7(e,a){function r(r,t){return e[r]*a[t]-e[t]*a[r]}return new uf.Cartesian3(r(\"y\",\"z\"),r(\"z\",\"x\"),r(\"x\",\"y\"))}function me(e,a){let r=p7(e,uf.Cartesian3.clone(a.camera.position)),t=p7(e,r);return uf.Plane.fromPointNormal(uf.Cartesian3.ZERO,uf.Cartesian3.normalize(t,new uf.Cartesian3))}function ma(e){if(e.length>=3){let a=uf.Cartesian3.normalize(uf.Cartesian3.subtract(e[1],e[0],new uf.Cartesian3),new uf.Cartesian3);for(let r=1;r<e.length;r++){let t=e[r],n=e[r+1];r===e.length-1&&(n=e[0]);let i=uf.Cartesian3.normalize(uf.Cartesian3.subtract(n,t,new uf.Cartesian3),new uf.Cartesian3);if(0===mr(a,i)){let e=uf.Cartesian3.cross(a,i,new uf.Cartesian3);return uf.Plane.fromPointNormal(t,uf.Cartesian3.normalize(e,new uf.Cartesian3))}}}return null}function mr(e,a){return uf.Cartesian3.equalsEpsilon(e,a,uf.Math.EPSILON2)?1:uf.Cartesian3.equalsEpsilon(e,uf.Cartesian3.negate(a,new uf.Cartesian3),uf.Math.EPSILON2)?-1:0}function mt(e,a,r){let t=r.viewer.scene.camera.getPickRay(e);if(!!t)return uf.IntersectionTests.rayPlane(t,a)}function mn(e,a=uf.Ellipsoid.WGS84){let r=a.geodeticSurfaceNormalCartographic(e,new uf.Cartesian3),t=uf.Cartesian3.fromRadians(e.longitude,e.latitude),n=new uf.Ray;n.origin=t,n.direction=r;let i=new uf.Ray;return uf.Ray.getPoint(n,9e3,i.origin),uf.Cartesian3.negate(r,i.direction),i}function mi(e){let a=[e.longitude,e.latitude];return void 0!==e.height&&a.push(e.height),a}function mo(e,a,r=!1){let t=[],n=a.length;if(n>0&&e.length>=n){let i=r?e.length:e.length-n+1;for(let r=0;r<i;r++){let i=e.slice(r,r+n);i.length<n&&(i=i.concat(e.slice(0,n-i.length))),t.push(a(...i))}}return t}function ms(e){let a=new uf.Cartesian3,r=e.length;return e.forEach(e=>{a.x+=e.x,a.y+=e.y,a.z+=e.z}),a.x/=r,a.y/=r,a.z/=r,a}let ml=uf.Cartesian3.fromElements(-1,0,0),md=uf.Cartesian3.fromElements(0,0,1);function mc(e,a){e.x=a.x,e.y=a.y,e.z=a.z}function mu(e){return uf.Math.toDegrees(e.camera.pitch)}function mp(e,a){let r=a.nearValue,t=a.farValue,n=a.near,i=(e**2-n**2)/(a.far**2-n**2);return r*(1-(i=function(e,a=0,r=1){return e>a?e>r?r:e:a}(i)**.2))+t*i}function mm(e,a){return e.x<=0||e.y<=0||e.x>=a.canvas.clientWidth||e.y>=a.canvas.clientHeight}let mh=uf.Cartesian2.ZERO.clone(),mg=uf.Cartesian2.fromElements(0,0);function mf({width:e,height:a},r,t,n,i){let o=n.x,s=n.y;switch(r){case uf.HorizontalOrigin.LEFT:o+=e/2;break;case uf.HorizontalOrigin.RIGHT:o-=e/2}switch(t){case uf.VerticalOrigin.TOP:s+=a/2;break;case uf.VerticalOrigin.BOTTOM:s-=a/2}return o*=i,{x:o,y:s*=i}}function m_(e){let{scene:a,anchor:r,pixelOffset:t,scaleByDistance:n,pixelOffsetScaleByDistance:i,totalScale:o,hOrigin:s,vOrigin:l}=e;!t&&(t=mg),!o&&(o=1);let d=uf.SceneTransforms.wgs84ToWindowCoordinates(a,r,mh);if(!d||d&&mm(d,a))return null;let c=a.camera,u=uf.Cartesian3.distance(c.positionWC,r),p=n?mp(u,n):1,m=0,h=0,g=0;if(\"Label\"===e.type){let a=p1(e.text,e.font);a&&(m=a.width,h=a.height,g=a.descent)}else m=e.width,h=e.height;m*=p*o,h*=p*o;let f=i?mp(u,i):1,_=t.x*f,b=t.y*f;g*=f;let k=d.x+_,v=d.y+b;switch(s){case uf.HorizontalOrigin.CENTER:case void 0:k-=m/2;break;case uf.HorizontalOrigin.RIGHT:k-=m}switch(l){case uf.VerticalOrigin.CENTER:case void 0:v-=h/2;break;case uf.VerticalOrigin.BASELINE:v-=h-g;break;case uf.VerticalOrigin.BOTTOM:v-=h}let z=new p2;return z.xMin=k,z.yMin=v,z.xMax=k+m,z.yMax=v+h,z}function mb(e,a,r=!1,t=0,n=0){let i=0,o=n;return a?o=Number.POSITIVE_INFINITY:\"3D\"===e?i=t||0:r?i=t||0:o=Number.POSITIVE_INFINITY,{occludedAlpha:i,disableDepthTestDistance:o}}class mk{clampWatcher=null;get clampToGround(){return this.properties.clampToGround}get position(){return this.properties.position}toggleClamp(){this.clampToGround?this.addOrUpdateClampWatcher():this.removeClampWatcher()}addOrUpdateClampWatcher(){let e=this.position;if(e){let a=uf.Cartographic.fromDegrees(e.longitude,e.latitude);this.clampWatcher?this.clampWatcher.update(a):this.clampWatcher=this.managers._get(f3)?.picker.clampWithWatcher(a,e=>this.onPositionClamp(e))}}removeClampWatcher(){this.clampWatcher&&(this.clampWatcher?.unclamp(),this.clampWatcher=null)}}class mv extends(0,uX.AF)(pv,pf,p_,ph,mk){managers;constructor(e,a){super(),this.managers=a,this.entities=py({}),this.interactLevel=sc.Thing,this.clampedPositionCartesian3=null,this.cacheViewModes={},this.cachePositions={},this.properties=Object.assign({id:(0,uW.k)()},e),this.init(),this.setCollectionMap(\"billboard\"),this.managers.render?.()}properties;entities;interactLevel;get id(){return this.properties.id}get boundingSphere(){let e=this.getPositionCartesian3();if(e)return new uf.BoundingSphere(e,100)}update(e){let a=!1;if(e.position&&(!this.properties.position||!function(e,a,r=!1){let t=e.longitude===a.longitude&&e.latitude===a.latitude;return!r&&(t=t&&e.height===a.height),t}(this.properties.position,e.position))&&(this.properties.position=e.position,this.clampedPositionCartesian3=null,this.entities.positionSetter(new uf.ConstantPositionProperty(this.getPositionCartesian3())),a=!0,this.cachePositions={}),e.image&&(this.properties.image=e.image,this.entities.billboard?.imageSetter(new uf.ConstantProperty(e.image))),uK(e,\"cssColor\")&&(this.properties.cssColor=e.cssColor,this.entities.billboard?.colorSetter(new uf.ConstantProperty(this.getColor()))),uK(e,\"width\")&&(this.properties.width=e.width,this.entities.billboard?.widthSetter(new uf.ConstantProperty(e.width))),uK(e,\"height\")&&(this.properties.height=e.height,this.entities.billboard?.heightSetter(new uf.ConstantProperty(e.height))),e.pixelOffset&&(this.properties.pixelOffset=e.pixelOffset,this.entities.billboard?.pixelOffsetSetter(new uf.ConstantProperty(new uf.Cartesian2(...e.pixelOffset)))),(0,pg.ri)(e.show)&&(this.properties.show=e.show,this.entities.showSetter(e.show)),e.draggable&&(this.properties.draggable=e.draggable),(0,pg.ri)(e.hoverCursor)&&(this.properties.hoverCursor=e.hoverCursor),(0,pg.ri)(e.removable)&&(this.properties.removable=e.removable),(0,pg.ri)(e.clampToGround)&&this.properties.clampToGround!==e.clampToGround&&(this.properties.clampToGround=e.clampToGround,a=!0),(0,pg.ri)(e.contextmenu)&&(this.properties.contextmenu=e.contextmenu),(0,pg.ri)(e.actived)&&(this.properties.actived=e.actived),(0,pg.ri)(e.disableInteractive)&&(this.properties.disableInteractive=e.disableInteractive),e.distanceDisplayCondition&&(this.properties.distanceDisplayCondition=e.distanceDisplayCondition,this.entities.billboard?.distanceDisplayConditionSetter(0===e.distanceDisplayCondition.length?void 0:new uf.ConstantProperty(new uf.DistanceDisplayCondition(...e.distanceDisplayCondition)))),e.scaleByDistance){this.properties.scaleByDistance=e.scaleByDistance;let a=0===e.scaleByDistance.length?void 0:new uf.ConstantProperty(new uf.NearFarScalar(...e.scaleByDistance));this.entities.billboard?.scaleByDistanceSetter(a),this.entities.billboard?.pixelOffsetScaleByDistanceSetter(a)}let r=e.occludedAlpha;(0,pg.ri)(r)&&(this.properties.occludedAlpha=0===r?void 0:r);let t=e.disableDepthTestDistance;(0,pg.ri)(t)&&(this.properties.disableDepthTestDistance=t),(0,pg.ri)(e.enableOccludeIn2dView)&&(this.properties.enableOccludeIn2dView=e.enableOccludeIn2dView),this.updateRuntimeOccludedStyle(),a&&this.toggleClamp()}getEntityOptions(){let e=this.properties.distanceDisplayCondition&&this.properties.distanceDisplayCondition.length?new uf.DistanceDisplayCondition(...this.properties.distanceDisplayCondition):void 0,a=this.properties.scaleByDistance&&this.properties.scaleByDistance.length?new uf.NearFarScalar(...this.properties.scaleByDistance):void 0;return{id:this.properties.id,show:this.properties.show,position:this.getPositionCartesian3(),billboard:{disableDepthTestDistance:this.properties.disableDepthTestDistance,color:this.getColor(),scale:this.properties.scale,image:this.properties.image,rotation:this.properties.rotation,width:this.properties.width,height:this.properties.height,horizontalOrigin:this.properties.horizontalOrigin?uf.HorizontalOrigin[this.properties.horizontalOrigin]:void 0,verticalOrigin:this.properties.verticalOrigin?uf.VerticalOrigin[this.properties.verticalOrigin]:void 0,pixelOffset:this.properties.pixelOffset?new uf.Cartesian2(...this.properties.pixelOffset):void 0,eyeOffset:this.properties.eyeOffset?new uf.Cartesian3(...this.properties.eyeOffset):void 0,depthFailTranslucency:this.properties.occludedAlpha,distanceDisplayCondition:e,scaleByDistance:a,pixelOffsetScaleByDistance:a}}}init(){super.init(),this.toggleClamp()}clampedPositionCartesian3;onPositionClamp(e){e&&(this.clampedPositionCartesian3=e,!this.dynamicPosition&&(this.entities.positionSetter(new uf.ConstantPositionProperty(this.getPositionCartesian3())),this.managers.render?.()))}getPositionCartesian3(){if(this.properties.position)return this.clampedPositionCartesian3||(0,pg.jL)(this.properties.position)}getColor(){if(this.properties.cssColor)return uf.Color.fromCssColorString(this.properties.cssColor)}setCollectionMap(e){this.managers._options.elements.add(e,this,[this.id])}startDrag(e,a){let r=super.startDrag(e,a),t=this.getPositionCartesian3();return r&&t?{position:t,clampToGround:this.properties.clampToGround}:r}dynamicDrag(e){this.entities.positionSetter(new uf.CallbackProperty(e,!1))}endDrag(){super.endDrag();let e=this.entities._values()[0];this.entities.positionSetter(new uf.ConstantPositionProperty(e?.position?.getValue(new uf.JulianDate)))}cacheViewModes;cachePositions;onSceneChange(e){let{is3D:a,id:r}=e;if(a&&\"3D\"===this.cacheViewModes[r]||!a&&\"2D\"===this.cacheViewModes[r])return;if(this.cacheViewModes[r]=a?\"3D\":\"2D\",this.updateRealtimeClamping(e),!this.properties.actived)this.updateRuntimeOccludedStyle([e.id])}updateRealtimeClamping(e){if(this.clampToGround)return;let{is3D:a,id:r}=e,t=this.cachePositions[r];if(!t&&(t=this.cachePositions[r]=uf.Cartesian3.ONE.clone()),a){if(!uf.Cartesian3.equalsEpsilon(t,uf.Cartesian3.ONE)){let e=new uf.ConstantPositionProperty(t);this.entities.positionSetter(e)}}else if(this.position){this.cachePositions[r]=(0,pg.jL)(this.position);let e=new uf.ConstantPositionProperty(uf.Cartesian3.fromDegrees(this.position.longitude,this.position.latitude,0));this.entities.positionSetter(e)}}updateRuntimeOccludedStyle(e){let a=!!this.properties.actived,r=!!this.properties.enableOccludeIn2dView;(!Array.isArray(e)||0===e.length)&&(e=Object.keys(this.cacheViewModes)),e.forEach(e=>{let t=this.cacheViewModes[e];if(void 0===t)return;let{occludedAlpha:n,disableDepthTestDistance:i}=mb(t,a,r,this.properties.occludedAlpha,this.properties.disableDepthTestDistance),o=this.entities._get(e)?.billboard;if(!!o)o.depthFailTranslucency=new uf.ConstantProperty(n),o.disableDepthTestDistance=new uf.ConstantProperty(i)})}onManagerAdd(e){let a=this.managers._get(e);a&&(this.entities._add(e,a.viewer.entities.add(this.getEntityOptions())),this.afterManagerAdd(e))}onManagerRemove(e){let a=this.entities._get(e);a?.entityCollection.remove(a),this.entities._remove(e)}onManagerUpdate(e){let a=this.entities._get(e),r=this.isShowIn(e);a&&!r&&this.onManagerRemove(e),!a&&r&&this.onManagerAdd(e)}destroy(){super.destroy(),this.removeClampWatcher(),this.entities._keys().forEach(e=>{let a=this.entities._get(e);a&&a.entityCollection.remove(a),this.entities._remove(e)}),this.cachePositions={}}}let mz=function(e,a){function r(e){let a=0;for(;e%1;)e*=10,a++;return a}let t=r(e),n=r(a);return+(e+a).toFixed(t>n?t:n)};function mw(e){return e*Math.PI/180}function my(e){return 180*e/Math.PI}function mS(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}let mj=6378137,mD=6378137,mI=6356752.314245179,mA={x:mj*mj,y:mD*mD,z:mI*mI};function mC(e){var a,r,t,n,i,o,s,l,d,c;let u=mw(e.latitude),p=mw(e.longitude),m=e.height||0,h=Math.cos(u),g={x:h*Math.cos(p),y:h*Math.sin(p),z:Math.sin(u)};g=function(e){let a=mS(e);return{x:e.x/a,y:e.y/a,z:e.z/a}}(g);let f=(a=mA,r=g,{x:a.x*r.x,y:a.y*r.y,z:a.z*r.z});let _=Math.sqrt((t=g,n=f,t.x*n.x+t.y*n.y+t.z*n.z));return i=f,o=_,f={x:i.x/o,y:i.y/o,z:i.z/o},s=g,l=m,g={x:s.x*l,y:s.y*l,z:s.z*l},d=f,c=g,{x:d.x+c.x,y:d.y+c.y,z:d.z+c.z}}mA.x,mA.y,mA.z;var mx=r(\"64854\");function mM(e,a){let r,t,n,i,o;let s=mw(e.longitude),l=mw(a.longitude),d=mw(e.latitude),c=mw(a.latitude),u=mj,p=mI,m=(u-p)/u,h=l-s,g=Math.atan((1-m)*Math.tan(d)),f=Math.atan((1-m)*Math.tan(c)),_=Math.cos(g),b=Math.sin(g),k=Math.cos(f),v=Math.sin(f),z=_*k,w=_*v,y=b*v,S=b*k,j=h,D=2*Math.PI,I=Math.cos(j),A=Math.sin(j);do{let e;let a=w-S*(I=Math.cos(j));n=Math.sqrt(k*k*(A=Math.sin(j))*A+a*a),r=Math.atan2(n,t=y+z*I),0===n?(e=0,i=1):i=1-(e=z*A/n)*e,D=j,!isFinite(o=t-2*y/i)&&(o=0),j=h+function(e,a,r,t,n,i,o){var s,l;let d=(s=e)*(l=r)*(4+s*(4-3*l))/16;return(1-d)*e*a*(t+d*n*(o+d*i*(2*o*o-1)))}(m,e,i,r,n,t,o)}while(Math.abs(j-D)>1e-12);let C=i*(u*u-p*p)/(p*p),x=C*(256+C*(C*(74-47*C)-128))/1024,M=o*o;return p*(1+C*(4096+C*(C*(320-175*C)-768))/16384)*(r-x*n*(o+x*(t*(2*M-1)-x*o*(4*n*n-3)*(4*M-3)/6)/4))}function mE(e,a=!1){let r=0,t=0;for(let a=0;a<e.length-1;a++){let n=e[a],i=e[a+1];r+=mM(n,i),t+=Math.abs(n.height-i.height)}if(a&&e.length>1){let a=e[e.length-1],n=e[0];r+=mM(a,n),t+=Math.abs(a.height-n.height)}return{horizontalCumulativeDistance:r,verticalCumulativeDistance:t}}function mP(e){return mT(e.map(e=>({x:e.longitude,y:e.latitude})))}function mT(e){let a=!1;if(e.length<=3)return a;let r=e.concat([e[0]]);for(let e=0;e<r.length;e++){let t=r.slice(e,e+2);for(let e=0;e<r.length;e++)(function(e,a){if(e.length<2||a.length<2)return!1;let r={x:e[0].x,y:e[0].y},t={x:e[1].x,y:e[1].y},n={x:a[0].x,y:a[0].y},i={x:a[1].x,y:a[1].y},o=mR(r,t,n),s=mR(r,t,i),l=mR(n,i,r),d=mR(n,i,t);return!!(o*s<0)&&!!(l*d<0)||!1})(t,r.slice(e,e+2))&&(a=!0)}return a}function mR(e,a,r){return(r.y-e.y)*(a.x-e.x)-(a.y-e.y)*(r.x-e.x)}function mF(e,a,r=90,t){let n=[];if(!e||!a)return[];let i=mw(e.longitude),o=mw(e.latitude);for(let e=0;e<r;e++){let s=mw(360/r*e),l=Math.asin(Math.sin(o)*Math.cos(a/6378137)+Math.cos(o)*Math.sin(a/6378137)*Math.cos(s)),d=i+Math.atan2(Math.sin(s)*Math.sin(a/6378137)*Math.cos(o),Math.cos(a/6378137)-Math.sin(o)*Math.sin(l));n.push(t?{longitude:my(d),latitude:my(l),height:t}:{longitude:my(d),latitude:my(l)})}return n}function mL(e,a){let r=[e.longitude||0,e.latitude||0],t=[a.longitude||0,a.latitude||0];return mx.TE$(r,t,{units:\"meters\"})}let mN=\"#00FF00\",mJ=\"#FF0000\",mO={ctrl:\"control\",command:\"command\",shift:\"shift\",alt:\"alt\"};(rL=su||(su={})).backspace=\"backspace\",rL.backQuote=\"backquote\",rL.tab=\"tab\",rL.clear=\"clear\",rL.enter=\"enter\",rL.esc=\"escape\",rL.space=\"space\",rL.left=\"left\",rL.up=\"up\",rL.right=\"right\",rL.down=\"down\",rL.delete=\"delete\",rL.insert=\"insert\",rL.home=\"home\",rL.end=\"end\",rL.pageUp=\"pageup\",rL.pageDown=\"pagedown\",rL.capsLock=\"capslock\",rL.numZero=\"num_0\",rL.numOne=\"num_1\",rL.numTwo=\"num_2\",rL.numThree=\"num_3\",rL.numFour=\"num_4\",rL.numFive=\"num_5\",rL.numSix=\"num_6\",rL.numSeven=\"num_7\",rL.numEight=\"num_8\",rL.numNine=\"num_9\",rL.numMultiply=\"num_multiply\",rL.numAdd=\"num_add\",rL.numEnter=\"num_enter\",rL.numSubtract=\"num_subtract\",rL.numDecimal=\"num_decimal\",rL.numDivide=\"num_divide\",rL.a=\"a\",rL.b=\"b\",rL.c=\"c\",rL.d=\"d\",rL.e=\"e\",rL.f=\"f\",rL.g=\"g\",rL.h=\"h\",rL.i=\"i\",rL.j=\"j\",rL.k=\"k\",rL.l=\"l\",rL.m=\"m\",rL.n=\"n\",rL.o=\"o\",rL.p=\"p\",rL.q=\"q\",rL.r=\"r\",rL.s=\"s\",rL.t=\"t\",rL.u=\"u\",rL.v=\"v\",rL.w=\"w\",rL.x=\"x\",rL.y=\"y\",rL.z=\"z\",rL.zero=\"0\",rL.one=\"1\",rL.two=\"2\",rL.three=\"3\",rL.four=\"4\",rL.five=\"5\",rL.six=\"6\",rL.seven=\"7\",rL.eight=\"8\",rL.nine=\"9\",rL.ctrl=\"control\",rL.command=\"meta\",rL.alt=\"alt\",rL.shift=\"shift\",rL.f1=\"f1\",rL.f2=\"f2\",rL.f3=\"f3\",rL.f4=\"f4\",rL.f5=\"f5\",rL.f6=\"f6\",rL.f7=\"f7\",rL.f8=\"f8\",rL.f9=\"f9\",rL.f10=\"f10\",rL.f11=\"f11\",rL.f12=\"f12\",rL.comma=\",\",rL.slash=\"/\",rL.minus=\"-\",rL.equal=\"=\",rL.cmd=\"cmd\";let mq={backspace:\"backspace\",backquote:\"backquote\",tab:\"tab\",clear:\"clear\",enter:\"enter\",escape:\"escape\",space:\"space\",left:\"arrowleft\",up:\"arrowup\",right:\"arrowright\",down:\"arrowdown\",delete:\"delete\",insert:\"insert\",home:\"home\",end:\"end\",pageup:\"pageup\",pagedown:\"pagedown\",capslock:\"capslock\",0:\"digit0\",1:\"digit1\",2:\"digit2\",3:\"digit3\",4:\"digit4\",5:\"digit5\",6:\"digit6\",7:\"digit7\",8:\"digit8\",9:\"digit9\",num_0:\"numpad0\",num_1:\"numpad1\",num_2:\"numpad2\",num_3:\"numpad3\",num_4:\"numpad4\",num_5:\"numpad5\",num_6:\"numpad6\",num_7:\"numpad7\",num_8:\"numpad8\",num_9:\"numpad9\",num_multiply:\"numpadmultiply\",num_add:\"numpadadd\",num_enter:\"numpadenter\",num_subtract:\"numpadsubtract\",num_decimal:\"numpaddecimal\",num_divide:\"numpaddivide\",a:\"keya\",b:\"keyb\",c:\"keyc\",d:\"keyd\",e:\"keye\",f:\"keyf\",g:\"keyg\",h:\"keyh\",i:\"keyi\",j:\"keyj\",k:\"keyk\",l:\"keyl\",m:\"keym\",n:\"keyn\",o:\"keyo\",p:\"keyp\",q:\"keyq\",r:\"keyr\",s:\"keys\",t:\"keyt\",u:\"keyu\",v:\"keyv\",w:\"keyw\",x:\"keyx\",y:\"keyy\",z:\"keyz\",control:\"control\",meta:\"meta\",shift:\"shift\",alt:\"alt\",f1:\"f1\",f2:\"f2\",f3:\"f3\",f4:\"f4\",f5:\"f5\",f6:\"f6\",f7:\"f7\",f8:\"f8\",f9:\"f9\",f10:\"f10\",f11:\"f11\",f12:\"f12\",\",\":\"comma\",\"/\":\"slash\",\"-\":\"minus\",\"=\":\"equal\",cmd:\"cmd\"};(sp||(sp={})).left=\"mouse_left\";let mG={t:{desp:\"T\",icon:void 0},escape:{desp:\"Esc\",icon:void 0},right:{desp:void 0,icon:\"right-arrow\"},left:{desp:void 0,icon:\"left-arrow\"},control:{desp:\"Ctrl\"},alt:{desp:\"Alt\"},shift:{desp:\"Shift\"},a:{desp:\"A\"},d:{desp:\"D\"},f:{desp:\"F\"},\"-\":{icon:\"less\"},\"=\":{icon:\"plus\"},mouse_left:{icon:\"mouse_left\"}};(rN=sm||(sm={}))[rN.media=0]=\"media\",rN[rN.wayline=1]=\"wayline\",rN[rN.cockpit=2]=\"cockpit\";var mH=r(\"97370\");(rJ=sh||(sh={})).KeyDown=\"keydown\",rJ.KeyUp=\"keyup\",!window.$HotkeyScopeState&&(window.$HotkeyScopeState={});function mB(e,a){if(void 0!==a){let r=window.$HotkeyScopeState[e];if(r&&Object.values(r).some(e=>e<a))return!1}return!0}function mV(e,a,r){e.forEach((e,t)=>{let n=!1;e.keyName.forEach(r=>{r===a.toLowerCase()&&e.keyUp&&e.keyDown&&(e.keyUp(),n=!0)}),n&&(r[t].isDown=!1,n=!1)})}function mU(e){let a=e.target||e.srcElement,{tagName:r}=a,t=!0;return(a.isContentEditable||(\"INPUT\"===r||\"TEXTAREA\"===r||\"SELECT\"===r)&&!a.readOnly)&&(t=!1),t}(rO=sg||(sg={}))[rO.MAX_RECTANGLE=1]=\"MAX_RECTANGLE\",(rq=sf||(sf={})).Fence=\"fence\",rq.MultiArrow=\"multiArrow\",rq.Normal=\"normal\",rq.Dash=\"dash\";let mK=`pointer:${su.alt}|${sp.left}|${uP(\"web.map.move_point_height\")}`;(rG=s_||(s_={})).line=\"line\",rG.polygon=\"polygon\",rG.pin=\"pin\",rG.circle=\"circle\",rG.line3d=\"line3d\",rG.polygon3d=\"polygon3d\",rG.fov=\"fov\";let mW=\"PolylineFence\";uf.Material._materialCache.addMaterial(mW,{fabric:{type:mW,uniforms:{color:new uf.Color(1,1,1,1),outlineColor:new uf.Color(1,1,1,1),dashLength:10,dashPattern:15,outlineWidth:16,maskLength:20},source:\"#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\n\\nuniform vec4 color;\\nuniform float dashLength;\\nuniform float dashPattern;\\n\\nuniform float maskLength;\\nuniform float outlineWidth;\\nuniform vec4 outlineColor;\\n\\nin float v_polylineAngle;\\nin float v_width; // 线段宽度\\nmat2 rotate(float rad) {\\n float c = cos(rad);\\n float s = sin(rad);\\n return mat2(\\n c, s,\\n -s, c\\n );\\n}\\n// 计算给定输入的材质\\n// 栅栏形状的polyline是以虚线材质未基础，往虚线空隙里面填充外轮廓是透明的外轮廓线所绘制的\\nczm_material czm_getMaterial(czm_materialInput materialInput)\\n{\\n // 获取默认的材质\\n czm_material material = czm_getDefaultMaterial(materialInput);\\n\\n // 外轮廓纹理部分\\n // 获取标准化的纹理坐标\\n vec2 st = materialInput.st;\\n //v_width是整个线宽，outlineWidth是轮廓线宽，两者差值的一半就是外轮廓线内部线条的宽度\\n float halfInteriorWidth = 0.5 * (v_width - outlineWidth) / v_width;\\n // 判断当前的纹理坐标是否在内部线条范围内，如果在范围内，b值将为1，否则为0。step(edge, x)函数会返回一个值，如果x < edge，返回0.0，否则返回1.0\\n float b = step(0.5 - halfInteriorWidth, st.t);\\n b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\\n //计算当前片元距离最近的颜色分隔线的距离，这个距离将被用于后面的抗锯齿处理。\\n float d1 = abs(st.t - (0.5 - halfInteriorWidth));\\n float d2 = abs(st.t - (0.5 + halfInteriorWidth));\\n float dist = min(d1, d2);\\n // 根据b的值选择颜色，如果b是1，则选择color，否则选择outlineColor。这就确定了当前片元的基础颜色\\n vec4 currentColor = mix(outlineColor, color, b);\\n // 使用czm_antialias()函数进行抗锯齿处理，输入参数包括轮廓色，内部色，当前色和距离\\n vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\\n // 对经过抗锯齿处理后的颜色进行伽马校正\\n vec4 gapColor = czm_gammaCorrect(outColor);\\n\\n\\n // 虚线纹理部分\\n // 计算旋转后的片元位置。\\n vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\\n // 计算当前片元在虚线模式中的位置。\\n float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\\n // 计算对应虚线模式的索引位置。\\n float maskIndex = floor(dashPosition * maskLength);\\n // 通过使用虚线模式和索引位置，计算当前位置是否应有线条。\\n float maskTest = floor(dashPattern / pow(2.0, maskIndex));\\n // 如果当前位置应为虚线的间隔部分，则颜色设为gapColor，否则设为color。\\n vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\\n if (fragColor.a < 0.005) {\\n discard;\\n }\\n // 设置材质的颜色和透明度，后返回处理过后的材质\\n fragColor = czm_gammaCorrect(fragColor);\\n material.emission = fragColor.rgb;\\n material.alpha = fragColor.a;\\n return material;\\n}\\n\"},translucent:!0});class mZ{constructor(e=uf.Color.WHITE,a=new uf.Color(1,1,1,0),r=10,t=20){this.color=e,this.outlineWidth=r,this.maskLength=t,this.outlineColor=a}color;outlineColor;outlineWidth;maskLength;definitionChanged=new uf.Event;isConstant=!0;equals(e){return this===e||e instanceof mZ&&uf.Color.equals(this.color,e.color)&&uf.Color.equals(this.outlineColor,e.outlineColor)&&this.outlineWidth===e.outlineWidth&&this.maskLength===e.maskLength}getType(e){return mW}getValue(e,a){return!(0,uf.defined)(a)&&(a={}),a.color=this.color,a.outlineColor=this.outlineColor,a.outlineWidth=this.outlineWidth,a.maskLength=this.maskLength,a}}let mY=\"PolylineMultiArrow\";uf.Material._materialCache.addMaterial(mY,{strict:!0,fabric:{type:mY,uniforms:{color:uf.Color.WHITE,repeatFactor:1,antiClockWise:!0},source:\"#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\nuniform vec4 color;\\nuniform float repeatFactor;// 重复箭头的次数\\nuniform bool antiClockWise; // 确定箭头的方向\\n\\n// 一个辅助函数，给定两点(p0, p1)和一个x坐标，返回直线上对应的y坐标\\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\\n{\\n float slope = (p0.y - p1.y) / (p0.x - p1.x);// 计算斜率\\n return slope * (x - p0.x) + p0.y;// 使用斜率公式返回y坐标\\n}\\n\\n// 主材质函数，将被Cesium调用以获得每个片元的材质属性\\nczm_material czm_getMaterial(czm_materialInput materialInput)\\n{\\n czm_material material = czm_getDefaultMaterial(materialInput);// 获取默认材质\\n\\n vec2 st = materialInput.st;// 获取当前片元的纹理坐标\\n\\n if (antiClockWise) { // 根据antiClockWise的值选择性地翻转s坐标\\n st.s = 1.0 - st.s;\\n }\\n\\n float arrowWidth = 1.0 / repeatFactor;// 每个箭头的宽度\\n\\n // 使用mod函数将片元的s坐标映射到[0, arrowWidth]的范围内，从而实现箭头的重复\\n st.s = mod(st.s, arrowWidth) / arrowWidth;\\n\\n // 如果可用，使用fwidth函数来获得箭头的宽度，否则使用固定值\\n #if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\\n float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\\n #else\\n float base = 0.995;\\n #endif\\n\\n vec2 center = vec2(1.0, 0.5);// 箭头的顶点坐标\\n\\n // 增大箭头的尺寸来覆盖空隙\\n center.s += 0.01;\\n\\n // 计算箭头上部和下部直线上的点\\n float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\\n float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\\n\\n float halfWidth = 0.15;// 箭头的半宽\\n // 计算箭头主体部分的纹理坐标\\n float s = step(0.5 - halfWidth, st.t);\\n s *= 1.0 - step(0.5 + halfWidth, st.t);\\n s *= 1.0 - step(base, st.s);\\n\\n // 计算箭头顶部部分的纹理坐标\\n float t = step(base, st.s);\\n t *= 1.0 - step(ptOnUpperLine, st.t);\\n t *= step(ptOnLowerLine, st.t);\\n\\n // 计算片元与箭头边界的距离，以便进行抗锯齿处理\\n float dist;\\n if (st.s < base)\\n {\\n float d1 = abs(st.t - (0.5 - halfWidth));\\n float d2 = abs(st.t - (0.5 + halfWidth));\\n dist = min(d1,"
}